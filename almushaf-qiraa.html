<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ - Ù‚Ø±Ø§Ø¡Ø©ØŒ Ø§Ø³ØªÙ…Ø§Ø¹ØŒ ØªÙØ³ÙŠØ±">
    <title>Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ - Ø±Ø§Ø¯ÙŠÙˆ Ù‚Ø±Ø¢Ù†</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4CAF50;
            --primary-dark: #2E7D32;
            --secondary: #FF9800;
            --bg-gradient: linear-gradient(135deg, #111 0%, #222 100%);
            --card-bg: #222;
            --text: #fff;
            --gold: #FFD700;
            --border-color: #444;
            --ayah-font-size: 1.6em;
            --transition: all 0.3s ease;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­ */
        body.light-mode {
            --bg-gradient: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            --card-bg: #fff;
            --text: #333;
            --border-color: #ddd;
            --primary: #2E7D32;
        }
        body.light-mode .controls, body.light-mode .modal-content { background: rgba(255,255,255,0.98); border: 1px solid #ddd; }
        body.light-mode .top-bar { background: rgba(255,255,255,0.95); }
        body.light-mode select, body.light-mode .go-input { background: #fff; color: #333; border-color: #ccc; }
        body.light-mode .ayah-text { color: #000; }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--bg-gradient);
            color: var(--text);
            margin: 0;
            padding: 220px 10px 90px 10px;
            min-height: 100vh;
            transition: var(--transition);
        }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .top-bar {
            position: fixed; top: 0; left: 0; width: 100%;
            background: rgba(17, 17, 17, 0.95);
            backdrop-filter: blur(10px);
            padding: 10px;
            z-index: 1000;
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
            border-bottom: 1px solid #333;
            min-height: 50px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .btn-fab {
            background: #333; color: white; border: none;
            padding: 6px 12px; border-radius: 20px;
            cursor: pointer; font-family: 'Cairo'; font-size: 0.85em;
            display: flex; align-items: center; gap: 5px; 
            transition: var(--transition);
            border: 1px solid #555;
        }
        body.light-mode .btn-fab { background: #eee; color: #333; border: 1px solid #ccc; }
        .btn-fab:hover { transform: scale(1.05); background: #444; }
        .back-btn { 
            background: var(--primary); color: white; border-radius: 5px; 
            text-decoration: none; padding: 6px 15px; font-weight: bold; 
            display: flex; align-items: center; gap: 5px;
            border: none;
            transition: var(--transition);
        }
        .back-btn:hover { background: var(--primary-dark); }

        /* Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø«Ø§Ø¨Øª */
        .controls {
            position: fixed; top: 55px; left: 0; width: 100%;
            background: rgba(17, 17, 17, 0.98);
            padding: 10px;
            z-index: 950;
            border-bottom: 1px solid #444;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }
        
        select {
            padding: 8px;
            border-radius: 6px;
            background: #333;
            color: white;
            border: 1px solid #555;
            font-family: 'Cairo';
            font-size: 0.9em;
            cursor: pointer;
            max-width: 200px;
            flex: 1 1 150px;
            transition: var(--transition);
        }
        select:hover { border-color: var(--primary); }
        select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.3); }

        /* Ø­Ù‚Ù„ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¢ÙŠØ© */
        .go-group {
            display: flex;
            gap: 5px;
            flex: 1 1 200px;
            align-items: center;
        }
        .go-input {
            padding: 8px;
            border-radius: 6px;
            background: #333;
            color: white;
            border: 1px solid #555;
            font-family: 'Cairo';
            font-size: 0.9em;
            width: 100%;
            transition: var(--transition);
        }
        .go-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.3);
        }
        .go-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 0 15px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: bold;
        }
        .go-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¢ÙŠØ© */
        .ayah-container {
            background: var(--card-bg);
            margin-bottom: 15px;
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.05);
            animation: fadeIn 0.5s;
            transition: var(--transition);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        .ayah-number {
            display: inline-block;
            background: var(--primary);
            color: white;
            width: 35px; height: 35px;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
            margin-left: 10px;
            vertical-align: middle;
            font-family: 'Amiri', serif;
            flex-shrink: 0;
        }
        .ayah-text {
            font-family: 'Amiri', serif;
            font-size: var(--ayah-font-size);
            line-height: 1.8;
            margin: 15px 0;
            text-align: justify;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            padding: 10px 0;
        }
        .ayah-text:hover {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        /* ØªÙ„ÙˆÙŠÙ† Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø³Ø¬ÙˆØ¯ ÙˆØ§Ù„ÙˆÙ‚Ù */
        .sujud-mark {
            color: #ff4d4d; /* Ø£Ø­Ù…Ø± */
            font-size: 1.3em;
            font-weight: bold;
            display: inline-block;
            margin: 0 2px;
            animation: pulse 2s infinite;
            position: relative;
            top: -2px;
        }
        .waqf-mark {
            color: #FF9800; /* Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ */
            font-size: 1.1em;
            font-weight: bold;
        }
        @keyframes pulse { 
            0% { opacity: 1; transform: scale(1); } 
            50% { opacity: 0.6; transform: scale(1.1); } 
            100% { opacity: 1; transform: scale(1); } 
        }

        .ayah-actions {
            display: flex; justify-content: flex-end; gap: 10px;
            border-top: 1px solid var(--border-color); padding-top: 10px;
            margin-top: 10px;
        }
        .btn-action {
            background: transparent; border: 2px solid #555; color: #ccc;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer;
            transition: var(--transition); display: flex; align-items: center; justify-content: center;
            font-size: 16px;
        }
        .btn-action:hover { background: #444; color: white; transform: scale(1.1); }
        .btn-play { border-color: var(--primary); color: var(--primary); }
        .btn-play:hover { background: var(--primary); color: white; }
        .btn-tafsir { border-color: #2196F3; color: #2196F3; }
        .btn-tafsir:hover { background: #2196F3; color: white; }
        .btn-save { border-color: var(--secondary); color: var(--secondary); }
        .btn-save:hover { background: var(--secondary); color: white; }
        .btn-saved { 
            background: var(--secondary); color: white; border-color: var(--secondary); 
            animation: savedPulse 0.5s ease;
        }
        @keyframes savedPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 2000;
            align-items: center; justify-content: center; padding: 20px;
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: var(--card-bg); padding: 25px; border-radius: 15px;
            max-width: 700px; width: 100%; max-height: 80vh; overflow-y: auto;
            border: 2px solid #2196F3; text-align: right;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            animation: modalSlideIn 0.3s ease;
        }
        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .tafsir-text {
            font-family: 'Amiri', serif; font-size: 1.3em; line-height: 1.8; white-space: pre-wrap;
            color: var(--text);
        }
        .close-modal {
            background: #f44336; color: white; border: none;
            padding: 10px 20px; border-radius: 8px; width: 100%; margin-top: 15px; cursor: pointer;
            font-family: 'Cairo';
            font-weight: bold;
            transition: var(--transition);
        }
        .close-modal:hover {
            background: #d32f2f;
            transform: translateY(-2px);
        }
        
        /* Ù…Ø´ØºÙ„ Ø§Ù„ØµÙˆØª */
        .audio-player-fixed {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: #222; padding: 10px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.5);
            z-index: 1000; display: flex; gap: 10px; align-items: center;
            border-top: 1px solid #444;
        }
        .audio-player-fixed audio { 
            flex: 1; 
            max-width: 100%;
        }
        
        .basmalah { 
            text-align: center; 
            font-family: 'Amiri', serif; 
            font-size: 2em; 
            color: var(--gold); 
            margin: 20px 0; 
            padding: 15px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        .loading { 
            text-align: center; 
            padding: 50px; 
            font-size: 1.2em; 
            color: #888; 
        }
        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(76, 175, 80, 0.2);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast */
        .toast {
            position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); color: white; padding: 12px 24px;
            border-radius: 20px; z-index: 3000; opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            pointer-events: none;
            font-family: 'Cairo';
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            min-width: 250px;
            text-align: center;
        }
        .toast.show { 
            opacity: 1; 
            transform: translateX(-50%) translateY(-10px);
        }

        /* Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        .scroll-indicator {
            position: fixed;
            top: 50%;
            right: 20px;
            background: rgba(76, 175, 80, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-family: 'Cairo';
            font-size: 0.9em;
            z-index: 100;
            display: none;
            animation: slideInRight 0.3s ease;
        }
        @keyframes slideInRight {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 600px) {
            .top-bar { 
                justify-content: space-between; 
                padding: 8px 5px; 
                flex-wrap: wrap;
            }
            .controls { 
                padding: 8px; 
                top: 50px;
                flex-direction: column;
                align-items: stretch;
            }
            .go-group { 
                flex: 1 1 100%; 
                flex-direction: column;
            }
            select, .go-input { 
                width: 100%; 
                padding: 8px; 
                font-size: 0.9em; 
                margin-bottom: 5px;
            }
            body { 
                padding-top: 260px; 
            }
            .btn-fab span { 
                display: none; 
            }
            .ayah-text {
                font-size: calc(var(--ayah-font-size) * 0.9);
            }
            .audio-player-fixed {
                flex-direction: column;
                padding: 15px;
            }
            .scroll-indicator {
                top: auto;
                bottom: 120px;
                right: 10px;
                font-size: 0.8em;
                padding: 6px 10px;
            }
        }

        @media (max-width: 480px) {
            .ayah-actions {
                flex-wrap: wrap;
                justify-content: center;
            }
            .btn-action {
                width: 35px;
                height: 35px;
                font-size: 14px;
            }
            .ayah-number {
                width: 30px;
                height: 30px;
                line-height: 30px;
                font-size: 0.9em;
            }
        }

        /* Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ù‚Ø§Ø±Ø¦Ø§Øª */
        .ayah-highlight {
            background: rgba(255, 215, 0, 0.15);
            border-left: 3px solid var(--gold);
            animation: highlightPulse 1s ease;
        }
        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 215, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }

        /* Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø¬Ø¯ÙŠØ¯ Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡ - ØªÙ‚Ø³ÙŠÙ… Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ */
        .reciter-group {
            display: none;
        }
        .reciter-divider {
            background: rgba(255, 255, 255, 0.1);
            height: 1px;
            margin: 5px 0;
            width: 90%;
            align-self: center;
        }
        .reciter-label {
            color: var(--gold);
            font-weight: bold;
            font-size: 0.85em;
            text-align: center;
            padding: 3px 0;
            background: rgba(0,0,0,0.2);
            border-radius: 4px;
            margin: 5px 0;
        }
    </style>
</head>
<body>

<!-- Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ…Ø±ÙŠØ± -->
<div class="scroll-indicator" id="scrollIndicator"></div>

<!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
<div class="top-bar">
    <a href="https://waleedd189.github.io/radio-quran/" class="back-btn" aria-label="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
        <i class="fas fa-home"></i> <span data-ar="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" data-en="Home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
    </a>
    
    <button class="btn-fab" onclick="changeLang()" aria-label="ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©">
        <i class="fas fa-language"></i> <span id="langText">English</span>
    </button>
    <button class="btn-fab" onclick="toggleTheme()" aria-label="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹">
        <i class="fas fa-moon" id="themeIcon"></i>
    </button>
    <button class="btn-fab" onclick="changeFontSize(1)" aria-label="ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø·">
        <i class="fas fa-plus"></i>
    </button>
    <button class="btn-fab" onclick="changeFontSize(-1)" aria-label="ØªØµØºÙŠØ± Ø§Ù„Ø®Ø·">
        <i class="fas fa-minus"></i>
    </button>
    <button class="btn-fab" onclick="goToBookmark()" style="background: var(--secondary); color: white;" aria-label="Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ù…ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸">
        <i class="fas fa-bookmark"></i>
    </button>
</div>

<!-- Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø«Ø§Ø¨Øª -->
<div class="controls">
    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙˆØ± -->
    <select id="surahSelect" onchange="loadSurah()" aria-label="Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ±Ø©">
        <option value="" disabled selected data-ar="-- Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ±Ø© --" data-en="-- Select Surah --">-- Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ±Ø© --</option>
    </select>
    
    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø²Ø¡ -->
    <select id="juzSelect" onchange="loadJuz()" aria-label="Ø§Ø®ØªØ± Ø§Ù„Ø¬Ø²Ø¡">
        <option value="" disabled selected data-ar="-- Ø§Ø®ØªØ± Ø§Ù„Ø¬Ø²Ø¡ --" data-en="-- Select Juz --">-- Ø§Ø®ØªØ± Ø§Ù„Ø¬Ø²Ø¡ --</option>
    </select>
    
    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡ -->
    <select id="reciterSelect" onchange="loadSurah()" aria-label="Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ø±Ø¦">
        <!-- Ù…Ø±ØªØ¨Ø© Ø­Ø³Ø¨ Ø§Ù„Ø´Ø¹Ø¨ÙŠØ© ÙˆØ§Ù„Ø¬ÙˆØ¯Ø© -->
        
        <!-- Ø§Ù„Ù‚Ø±Ø§Ø¡ Ø§Ù„Ù…Ø±ØªÙ„ÙŠÙ† (Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ù‡Ø±Ø©) -->
        <optgroup label="Ø§Ù„Ù…Ø±ØªÙ„ÙˆÙ† - Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ù‡Ø±Ø©">
            <option value="ar.alafasy" data-ar="Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ" data-en="Mishary Rashid Al-Afasy">Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ</option>
            <option value="ar.abdulbasitmurattal" data-ar="Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ø³Ø· Ø¹Ø¨Ø¯ Ø§Ù„ØµÙ…Ø¯ (Ù…Ø±ØªÙ„)" data-en="Abdul Basit (Murattal)">Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ø³Ø· (Ù…Ø±ØªÙ„)</option>
            <option value="ar.husary" data-ar="Ù…Ø­Ù…ÙˆØ¯ Ø®Ù„ÙŠÙ„ Ø§Ù„Ø­ØµØ±ÙŠ" data-en="Mahmoud Khalil Al-Husary">Ù…Ø­Ù…ÙˆØ¯ Ø®Ù„ÙŠÙ„ Ø§Ù„Ø­ØµØ±ÙŠ</option>
            <option value="ar.minshawi" data-ar="Ù…Ø­Ù…Ø¯ ØµØ¯ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ" data-en="Mohammad Siddiq Al-Minshawi">Ù…Ø­Ù…Ø¯ ØµØ¯ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ</option>
            <option value="ar.muhammadayyoub" data-ar="Ù…Ø­Ù…Ø¯ Ø£ÙŠÙˆØ¨" data-en="Muhammad Ayyoub">Ù…Ø­Ù…Ø¯ Ø£ÙŠÙˆØ¨</option>
            <option value="ar.muhammadjibreel" data-ar="Ù…Ø­Ù…Ø¯ Ø¬Ø¨Ø±ÙŠÙ„" data-en="Muhammad Jibreel">Ù…Ø­Ù…Ø¯ Ø¬Ø¨Ø±ÙŠÙ„</option>
        </optgroup>

        <option class="reciter-divider" disabled>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</option>

        <!-- Ø§Ù„Ù‚Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¬ÙˆØ¯ÙˆÙ† -->
        <optgroup label="Ø§Ù„Ù…Ø¬ÙˆØ¯ÙˆÙ†">
            <option value="ar.abdulbasitmujawwad" data-ar="Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ø³Ø· Ø¹Ø¨Ø¯ Ø§Ù„ØµÙ…Ø¯ (Ù…Ø¬ÙˆØ¯)" data-en="Abdul Basit (Mujawwad)">Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ø³Ø· (Ù…Ø¬ÙˆØ¯)</option>
            <option value="ar.husarymujawwad" data-ar="Ù…Ø­Ù…ÙˆØ¯ Ø®Ù„ÙŠÙ„ Ø§Ù„Ø­ØµØ±ÙŠ (Ù…Ø¬ÙˆØ¯)" data-en="Al-Husary (Mujawwad)">Ø§Ù„Ø­ØµØ±ÙŠ (Ù…Ø¬ÙˆØ¯)</option>
            <option value="ar.sa3dghamdi" data-ar="Ø³Ø¹Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ" data-en="Saad Al-Ghamdi">Ø³Ø¹Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ</option>
            <option value="ar.ahmedajamy" data-ar="Ø£Ø­Ù…Ø¯ Ø¨Ù† Ø¹Ù„ÙŠ Ø§Ù„Ø¹Ø¬Ù…ÙŠ" data-en="Ahmed Al-Ajamy">Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¹Ø¬Ù…ÙŠ</option>
            <option value="ar.abdullahbasfar" data-ar="Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø¨ØµÙØ±" data-en="Abdullah Basfar">Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø¨ØµÙØ±</option>
            <option value="ar.abdurrahmaansudais" data-ar="Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø³Ø¯ÙŠØ³" data-en="Abdurrahmaan As-Sudais">Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø³Ø¯ÙŠØ³</option>
            <option value="ar.ahmedalnefa3" data-ar="Ø£Ø­Ù…Ø¯ Ø§Ù„Ù†ÙÙŠØ³" data-en="Ahmed Al-Nufais">Ø£Ø­Ù…Ø¯ Ø§Ù„Ù†ÙÙŠØ³</option>
        </optgroup>

        <option class="reciter-divider" disabled>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</option>

        <!-- Ù‚Ø±Ø§Ø¡ Ù…Ù† Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© -->
        <optgroup label="Ù‚Ø±Ø§Ø¡ Ù…Ù† Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">
            <option value="ar.saudshuraym" data-ar="Ø³Ø¹ÙˆØ¯ Ø§Ù„Ø´Ø±ÙŠÙ…" data-en="Saud Al-Shuraym">Ø³Ø¹ÙˆØ¯ Ø§Ù„Ø´Ø±ÙŠÙ…</option>
            <option value="ar.yasserqadhi" data-ar="ÙŠØ§Ø³Ø± Ø§Ù„Ù‚Ø±Ø´ÙŠ" data-en="Yasser Al-Qurashi">ÙŠØ§Ø³Ø± Ø§Ù„Ù‚Ø±Ø´ÙŠ</option>
            <option value="ar.mahermuaiqly" data-ar="Ù…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹ÙŠÙ‚Ù„ÙŠ" data-en="Maher Al-Muaiqly">Ù…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹ÙŠÙ‚Ù„ÙŠ</option>
            <option value="ar.faresabbad" data-ar="ÙØ§Ø±Ø³ Ø¹Ø¨Ø§Ø¯" data-en="Fares Abbad">ÙØ§Ø±Ø³ Ø¹Ø¨Ø§Ø¯</option>
            <option value="ar.hanirifai" data-ar="Ù‡Ø§Ù†ÙŠ Ø§Ù„Ø±ÙØ§Ø¹ÙŠ" data-en="Hani Ar-Rifai">Ù‡Ø§Ù†ÙŠ Ø§Ù„Ø±ÙØ§Ø¹ÙŠ</option>
        </optgroup>

        <option class="reciter-divider" disabled>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</option>

        <!-- Ù‚Ø±Ø§Ø¡ Ø¢Ø®Ø±ÙˆÙ† -->
        <optgroup label="Ù‚Ø±Ø§Ø¡ Ø¢Ø®Ø±ÙˆÙ†">
            <option value="ar.shaatree" data-ar="Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„Ø´Ø§Ø·Ø±ÙŠ" data-en="Abu Bakr Ash-Shaatree">Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„Ø´Ø§Ø·Ø±ÙŠ</option>
            <option value="ar.3asim" data-ar="Ø¹Ø§ØµÙ… (Ø±ÙˆØ§ÙŠØ© Ø­ÙØµ)" data-en="Aasim (Hafs)">Ø¹Ø§ØµÙ… (Ø­ÙØµ)</option>
            <option value="ar.ibrahimakhbar" data-ar="Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø®Ø¶Ø±" data-en="Ibrahim Al-Akhdar">Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø®Ø¶Ø±</option>
            <option value="ar.parhizgar" data-ar="Ø£Ø¨ÙˆØ¨ÙƒØ± Ø§Ù„Ø´Ø§Ø·Ø±ÙŠ (ÙØ§Ø±Ø³ÙŠ)" data-en="Parhizgar">Ø£Ø¨ÙˆØ¨ÙƒØ± Ø§Ù„Ø´Ø§Ø·Ø±ÙŠ (ÙØ§Ø±Ø³ÙŠ)</option>
            <option value="ar.alshareef" data-ar="Ø®Ù„ÙŠÙØ© Ø§Ù„Ø·Ù†ÙŠØ¬ÙŠ" data-en="Khalifa Al-Tunaiji">Ø®Ù„ÙŠÙØ© Ø§Ù„Ø·Ù†ÙŠØ¬ÙŠ</option>
        </optgroup>
    </select>

    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙØ³ÙŠØ± -->
    <select id="tafsirSelect" onchange="saveSettings()" aria-label="Ø§Ø®ØªØ± Ø§Ù„ØªÙØ³ÙŠØ±">
        <option value="ar.muyassar" data-ar="ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙŠØ³Ø±" data-en="Tafsir Al-Muyassar">ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙŠØ³Ø±</option>
        <option value="ar.jalalayn" data-ar="ØªÙØ³ÙŠØ± Ø§Ù„Ø¬Ù„Ø§Ù„ÙŠÙ†" data-en="Tafsir Al-Jalalayn">ØªÙØ³ÙŠØ± Ø§Ù„Ø¬Ù„Ø§Ù„ÙŠÙ†</option>
        <option value="ar.baghawy" data-ar="ØªÙØ³ÙŠØ± Ø§Ù„Ø¨ØºÙˆÙŠ" data-en="Tafsir Al-Baghawi">ØªÙØ³ÙŠØ± Ø§Ù„Ø¨ØºÙˆÙŠ</option>
    </select>

    <!-- Ø²Ø± Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¢ÙŠØ© -->
    <div class="go-group">
        <input type="number" id="goInput" class="go-input" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ©" min="1" aria-label="Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ©">
        <button class="go-btn" onclick="goToAyah()" aria-label="Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ø¢ÙŠØ©"><i class="fas fa-arrow-down"></i></button>
    </div>
</div>

<h1 style="text-align:center; font-family:'Amiri'; margin: 10px 0;" data-ar="Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙ" data-en="Holy Quran">Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙ</h1>

<div id="content">
    <div class="loading-container">
        <div class="loading-spinner"></div>
        <div data-ar="Ø§Ø®ØªØ± Ø³ÙˆØ±Ø© Ù„Ù„Ø¨Ø¯Ø¡..." data-en="Select a Surah to start...">Ø§Ø®ØªØ± Ø³ÙˆØ±Ø© Ù„Ù„Ø¨Ø¯Ø¡...</div>
    </div>
</div>

<!-- Ù…Ø´ØºÙ„ Ø§Ù„ØµÙˆØª -->
<div class="audio-player-fixed" id="playerContainer" style="display:none;">
    <div style="color: var(--primary); font-weight: bold; white-space: nowrap;" id="currentAyahLabel">
        <i class="fas fa-play-circle"></i>
    </div>
    <audio id="mainAudio" controls></audio>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ³ÙŠØ± -->
<div class="modal" id="tafsirModal" onclick="event.target.id === 'tafsirModal' && closeTafsir()">
    <div class="modal-content">
        <h3 style="color: #2196F3; font-family: 'Cairo'; margin-top: 0;" data-ar="ØªÙØ³ÙŠØ± Ø§Ù„Ø¢ÙŠØ©" data-en="Tafsir of Ayah">ØªÙØ³ÙŠØ± Ø§Ù„Ø¢ÙŠØ©</h3>
        <div id="tafsirTextDisplay" class="tafsir-text">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        <button class="close-modal" onclick="closeTafsir()" data-ar="Ø¥ØºÙ„Ø§Ù‚" data-en="Close">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<!-- Toast -->
<div id="toast" class="toast"></div>

<script>
    // === Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª ===
    const translations = {
        ar: {
            home: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", title: "Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙ", selectSurah: "-- Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ±Ø© --",
            selectJuz: "-- Ø§Ø®ØªØ± Ø§Ù„Ø¬Ø²Ø¡ --", play: "ØªØ´ØºÙŠÙ„", tafsir: "ØªÙØ³ÙŠØ±", 
            save: "Ø­ÙØ¸ Ù…ÙˆØ¶Ø¹", saved: "ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¶Ø¹", unsaved: "ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­ÙØ¸",
            loadingTafsir: "Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„ØªÙØ³ÙŠØ±...", close: "Ø¥ØºÙ„Ø§Ù‚",
            loading: "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...", error: "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„",
            goToAyah: "Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ø¢ÙŠØ©", noBookmark: "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¶Ø¹ Ù…Ø­ÙÙˆØ¸",
            lastPosition: "Ø¢Ø®Ø± Ù…ÙˆØ¶Ø¹", continueReading: "Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ù…Ù† Ù‡Ù†Ø§ØŸ",
            yes: "Ù†Ø¹Ù…", no: "Ù„Ø§", bookmarkSaved: "ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¶Ø¹",
            bookmarkRemoved: "ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­ÙØ¸", invalidNumber: "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø¢ÙŠØ© ØµØ­ÙŠØ­",
            selectSurahFirst: "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø³ÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹", ayahNotFound: "Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",
            goToAyahSuccess: "Ø§Ù†ØªÙ‚Ù„Øª Ù„Ù„Ø¢ÙŠØ©", juz: "Ø§Ù„Ø¬Ø²Ø¡", surah: "Ø§Ù„Ø³ÙˆØ±Ø©",
            selectReciter: "-- Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ø±Ø¦ --"
        },
        en: {
            home: "Home", title: "Holy Quran", selectSurah: "-- Select Surah --",
            selectJuz: "-- Select Juz --", play: "Play", tafsir: "Tafsir", 
            save: "Save Position", saved: "Position Saved", unsaved: "Position Unsaved",
            loadingTafsir: "Loading Tafsir...", close: "Close",
            loading: "Loading...", error: "Connection Error",
            goToAyah: "Go to Ayah", noBookmark: "No bookmark saved",
            lastPosition: "Last Position", continueReading: "Continue reading from here?",
            yes: "Yes", no: "No", bookmarkSaved: "Bookmark Saved",
            bookmarkRemoved: "Bookmark Removed", invalidNumber: "Please enter a valid ayah number",
            selectSurahFirst: "Please select a surah first", ayahNotFound: "Ayah number not found",
            goToAyahSuccess: "Jumped to Ayah", juz: "Juz", surah: "Surah",
            selectReciter: "-- Select Reciter --"
        }
    };
    let currentLang = 'ar';
    let currentFontSize = 1.6;
    let currentSurah = null;
    let currentAyah = null;
    let isAutoScrolling = false;
    let lastReadPosition = null;

    const surahNames = [
        "Ø§Ù„ÙØ§ØªØ­Ø©", "Ø§Ù„Ø¨Ù‚Ø±Ø©", "Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†", "Ø§Ù„Ù†Ø³Ø§Ø¡", "Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©", "Ø§Ù„Ø£Ù†Ø¹Ø§Ù…", "Ø§Ù„Ø£Ø¹Ø±Ø§Ù", "Ø§Ù„Ø£Ù†ÙØ§Ù„", "Ø§Ù„ØªÙˆØ¨Ø©", "ÙŠÙˆÙ†Ø³",
        "Ù‡ÙˆØ¯", "ÙŠÙˆØ³Ù", "Ø§Ù„Ø±Ø¹Ø¯", "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…", "Ø§Ù„Ø­Ø¬Ø±", "Ø§Ù„Ù†Ø­Ù„", "Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡", "Ø§Ù„ÙƒÙ‡Ù", "Ù…Ø±ÙŠÙ…", "Ø·Ù‡",
        "Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡", "Ø§Ù„Ø­Ø¬", "Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†", "Ø§Ù„Ù†ÙˆØ±", "Ø§Ù„ÙØ±Ù‚Ø§Ù†", "Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡", "Ø§Ù„Ù†Ù…Ù„", "Ø§Ù„Ù‚ØµØµ", "Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª", "Ø§Ù„Ø±ÙˆÙ…",
        "Ù„Ù‚Ù…Ø§Ù†", "Ø§Ù„Ø³Ø¬Ø¯Ø©", "Ø§Ù„Ø£Ø­Ø²Ø§Ø¨", "Ø³Ø¨Ø£", "ÙØ§Ø·Ø±", "ÙŠØ³", "Ø§Ù„ØµØ§ÙØ§Øª", "Øµ", "Ø§Ù„Ø²Ù…Ø±", "ØºØ§ÙØ±",
        "ÙØµÙ„Øª", "Ø§Ù„Ø´ÙˆØ±Ù‰", "Ø§Ù„Ø²Ø®Ø±Ù", "Ø§Ù„Ø¯Ø®Ø§Ù†", "Ø§Ù„Ø¬Ø§Ø«ÙŠØ©", "Ø§Ù„Ø£Ø­Ù‚Ø§Ù", "Ù…Ø­Ù…Ø¯", "Ø§Ù„ÙØªØ­", "Ø§Ù„Ø­Ø¬Ø±Ø§Øª", "Ù‚",
        "Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª", "Ø§Ù„Ø·ÙˆØ±", "Ø§Ù„Ù†Ø¬Ù…", "Ø§Ù„Ù‚Ù…Ø±", "Ø§Ù„Ø±Ø­Ù…Ù†", "Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©", "Ø§Ù„Ø­Ø¯ÙŠØ¯", "Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©", "Ø§Ù„Ø­Ø´Ø±", "Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©",
        "Ø§Ù„ØµÙ", "Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†", "Ø§Ù„ØªØºØ§Ø¨Ù†", "Ø§Ù„Ø·Ù„Ø§Ù‚", "Ø§Ù„ØªØ­Ø±ÙŠÙ…", "Ø§Ù„Ù…Ù„Ùƒ", "Ø§Ù„Ù‚Ù„Ù…", "Ø§Ù„Ø­Ø§Ù‚Ø©", "Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬",
        "Ù†ÙˆØ­", "Ø§Ù„Ø¬Ù†", "Ø§Ù„Ù…Ø²Ù…Ù„", "Ø§Ù„Ù…Ø¯Ø«Ø±", "Ø§Ù„Ù‚ÙŠØ§Ù…Ø©", "Ø§Ù„Ø¥Ù†Ø³Ø§Ù†", "Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª", "Ø§Ù„Ù†Ø¨Ø£", "Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª", "Ø¹Ø¨Ø³",
        "Ø§Ù„ØªÙƒÙˆÙŠØ±", "Ø§Ù„Ø§Ù†ÙØ·Ø§Ø±", "Ø§Ù„Ù…Ø·ÙÙÙŠÙ†", "Ø§Ù„Ø§Ù†Ø´Ù‚Ø§Ù‚", "Ø§Ù„Ø¨Ø±ÙˆØ¬", "Ø§Ù„Ø·Ø§Ø±Ù‚", "Ø§Ù„Ø£Ø¹Ù„Ù‰", "Ø§Ù„ØºØ§Ø´ÙŠØ©", "Ø§Ù„ÙØ¬Ø±", "Ø§Ù„Ø¨Ù„Ø¯",
        "Ø§Ù„Ø´Ù…Ø³", "Ø§Ù„Ù„ÙŠÙ„", "Ø§Ù„Ø¶Ø­Ù‰", "Ø§Ù„Ø´Ø±Ø­", "Ø§Ù„ØªÙŠÙ†", "Ø§Ù„Ø¹Ù„Ù‚", "Ø§Ù„Ù‚Ø¯Ø±", "Ø§Ù„Ø¨ÙŠÙ†Ø©", "Ø§Ù„Ø²Ù„Ø²Ù„Ø©", "Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª",
        "Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©", "Ø§Ù„ØªÙƒØ§Ø«Ø±", "Ø§Ù„Ø¹ØµØ±", "Ø§Ù„Ù‡Ù…Ø²Ø©", "Ø§Ù„ÙÙŠÙ„", "Ù‚Ø±ÙŠØ´", "Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†", "Ø§Ù„ÙƒÙˆØ«Ø±", "Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†", "Ø§Ù„Ù†ØµØ±",
        "Ø§Ù„Ù…Ø³Ø¯", "Ø§Ù„Ø¥Ø®Ù„Ø§Øµ", "Ø§Ù„ÙÙ„Ù‚", "Ø§Ù„Ù†Ø§Ø³"
    ];

    // Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ - Ø£ÙŠ Ø³ÙˆØ±Ø© ØªØ¨Ø¯Ø£ ÙÙŠ Ø£ÙŠ Ø¬Ø²Ø¡
    const juzMap = [
        {startSurah: 1, startAyah: 1},      // Ø§Ù„Ø¬Ø²Ø¡ 1
        {startSurah: 2, startAyah: 142},    // Ø§Ù„Ø¬Ø²Ø¡ 2
        {startSurah: 2, startAyah: 253},    // Ø§Ù„Ø¬Ø²Ø¡ 3
        {startSurah: 3, startAyah: 93},     // Ø§Ù„Ø¬Ø²Ø¡ 4
        {startSurah: 4, startAyah: 24},     // Ø§Ù„Ø¬Ø²Ø¡ 5
        {startSurah: 4, startAyah: 148},    // Ø§Ù„Ø¬Ø²Ø¡ 6
        {startSurah: 5, startAyah: 82},     // Ø§Ù„Ø¬Ø²Ø¡ 7
        {startSurah: 6, startAyah: 111},    // Ø§Ù„Ø¬Ø²Ø¡ 8
        {startSurah: 7, startAyah: 88},     // Ø§Ù„Ø¬Ø²Ø¡ 9
        {startSurah: 8, startAyah: 41},     // Ø§Ù„Ø¬Ø²Ø¡ 10
        {startSurah: 9, startAyah: 93},     // Ø§Ù„Ø¬Ø²Ø¡ 11
        {startSurah: 11, startAyah: 6},     // Ø§Ù„Ø¬Ø²Ø¡ 12
        {startSurah: 12, startAyah: 53},    // Ø§Ù„Ø¬Ø²Ø¡ 13
        {startSurah: 14, startAyah: 53},    // Ø§Ù„Ø¬Ø²Ø¡ 14
        {startSurah: 16, startAyah: 129},   // Ø§Ù„Ø¬Ø²Ø¡ 15
        {startSurah: 18, startAyah: 75},    // Ø§Ù„Ø¬Ø²Ø¡ 16
        {startSurah: 20, startAyah: 136},   // Ø§Ù„Ø¬Ø²Ø¡ 17
        {startSurah: 23, startAyah: 1},     // Ø§Ù„Ø¬Ø²Ø¡ 18
        {startSurah: 25, startAyah: 21},    // Ø§Ù„Ø¬Ø²Ø¡ 19
        {startSurah: 27, startAyah: 56},    // Ø§Ù„Ø¬Ø²Ø¡ 20
        {startSurah: 29, startAyah: 46},    // Ø§Ù„Ø¬Ø²Ø¡ 21
        {startSurah: 33, startAyah: 31},    // Ø§Ù„Ø¬Ø²Ø¡ 22
        {startSurah: 36, startAyah: 28},    // Ø§Ù„Ø¬Ø²Ø¡ 23
        {startSurah: 39, startAyah: 32},    // Ø§Ù„Ø¬Ø²Ø¡ 24
        {startSurah: 41, startAyah: 47},    // Ø§Ù„Ø¬Ø²Ø¡ 25
        {startSurah: 46, startAyah: 1},     // Ø§Ù„Ø¬Ø²Ø¡ 26
        {startSurah: 51, startAyah: 31},    // Ø§Ù„Ø¬Ø²Ø¡ 27
        {startSurah: 58, startAyah: 1},     // Ø§Ù„Ø¬Ø²Ø¡ 28
        {startSurah: 67, startAyah: 1},     // Ø§Ù„Ø¬Ø²Ø¡ 29
        {startSurah: 78, startAyah: 1}      // Ø§Ù„Ø¬Ø²Ø¡ 30
    ];

    // === Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ===
    window.onload = () => {
        loadSettings();
        
        const surahSelect = document.getElementById('surahSelect');
        surahNames.forEach((name, i) => {
            const opt = document.createElement('option');
            opt.value = i + 1;
            opt.innerText = `${i + 1}. ${name}`;
            opt.setAttribute('data-surah-num', i + 1);
            surahSelect.appendChild(opt);
        });

        // Ù…Ù„Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡
        const juzSelect = document.getElementById('juzSelect');
        for (let i = 1; i <= 30; i++) {
            const opt = document.createElement('option');
            opt.value = i;
            opt.innerText = `${i}. ${translations[currentLang].juz} ${i}`;
            juzSelect.appendChild(opt);
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¢Ø®Ø± Ù…ÙˆØ¶Ø¹ Ù…Ù‚Ø±ÙˆØ¡
        checkLastPosition();

        // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
        const savedSurah = localStorage.getItem('lastQuranSurah');
        if(savedSurah) {
            surahSelect.value = savedSurah;
            setTimeout(() => {
                loadSurah();
            }, 300);
        }
    };

    // === Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¢Ø®Ø± Ù…ÙˆØ¶Ø¹ Ù…Ù‚Ø±ÙˆØ¡ ===
    function checkLastPosition() {
        const lastPos = JSON.parse(localStorage.getItem('lastReadPosition'));
        if (lastPos && lastPos.surah && lastPos.ayah) {
            lastReadPosition = lastPos;
            
            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
            setTimeout(() => {
                if (confirm(`${translations[currentLang].lastPosition}: Ø³ÙˆØ±Ø© ${surahNames[lastPos.surah - 1]}ØŒ Ø¢ÙŠØ© ${lastPos.ayah}\n${translations[currentLang].continueReading}`)) {
                    document.getElementById('surahSelect').value = lastPos.surah;
                    loadSurah().then(() => {
                        setTimeout(() => {
                            goToAyahNumber(lastPos.ayah, true);
                        }, 500);
                    });
                }
            }, 1000);
        }
    }

    // === ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø© ===
    let isLoading = false;
    const cache = new Map();

    async function loadSurah() {
        if (isLoading) return;
        
        const surahNum = document.getElementById('surahSelect').value;
        if (!surahNum) return;
        
        currentSurah = parseInt(surahNum);
        localStorage.setItem('lastQuranSurah', surahNum);

        const reciter = document.getElementById('reciterSelect').value;
        const contentDiv = document.getElementById('content');
        contentDiv.innerHTML = `
            <div class="loading-container">
                <div class="loading-spinner"></div>
                <div>${translations[currentLang].loading}</div>
            </div>
        `;

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©
        const cacheKey = `surah_${surahNum}_${reciter}`;
        if (cache.has(cacheKey)) {
            const cachedData = cache.get(cacheKey);
            renderSurah(cachedData.textAyahs, cachedData.audioAyahs, surahNum);
            return;
        }

        isLoading = true;
        try {
            const response = await fetch(`https://api.alquran.cloud/v1/surah/${surahNum}/editions/quran-uthmani,${reciter}`);
            const data = await response.json();
            if (data.code !== 200) throw new Error("API Error");
            
            const textAyahs = data.data[0].ayahs;
            const audioAyahs = data.data[1].ayahs;
            
            // ØªØ®Ø²ÙŠÙ† ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©
            cache.set(cacheKey, { textAyahs, audioAyahs });
            
            renderSurah(textAyahs, audioAyahs, surahNum);
        } catch (error) {
            console.error(error);
            contentDiv.innerHTML = `<div class="loading" style="color:red">${translations[currentLang].error}</div>`;
        } finally {
            isLoading = false;
        }
    }

    // === ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø²Ø¡ ===
    async function loadJuz() {
        const juzNum = document.getElementById('juzSelect').value;
        if (!juzNum) return;

        const juzIndex = parseInt(juzNum) - 1;
        const juzInfo = juzMap[juzIndex];
        
        if (juzInfo) {
            document.getElementById('surahSelect').value = juzInfo.startSurah;
            loadSurah().then(() => {
                setTimeout(() => {
                    goToAyahNumber(juzInfo.startAyah, true);
                }, 500);
            });
        }
    }

    // === Ø¹Ø±Ø¶ Ø§Ù„Ø¢ÙŠØ§Øª (Ù…Ø¹ ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø³Ø¬ÙˆØ¯ ÙˆØ§Ù„ÙˆÙ‚Ù) ===
    function renderSurah(textAyahs, audioAyahs, surahNum) {
        const contentDiv = document.getElementById('content');
        let html = '';

        if (surahNum != 1 && surahNum != 9) {
            html += '<div class="basmalah">Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</div>';
        }

        textAyahs.forEach((ayah, index) => {
            const audioUrl = audioAyahs[index].audio;
            const globalNum = ayah.number;
            
            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Øµ Ù„Ø¥Ø¨Ø±Ø§Ø² Ø§Ù„Ø³Ø¬ÙˆØ¯ ÙˆØ§Ù„ÙˆÙ‚Ù
            let text = ayah.text;
            
            // ØªÙ„ÙˆÙŠÙ† Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø³Ø¬ÙˆØ¯ (Û)
            text = text.replace(/Û/g, '<span class="sujud-mark" aria-label="Ø¹Ù„Ø§Ù…Ø© Ø³Ø¬ÙˆØ¯">Û</span>');
            
            // ØªÙ„ÙˆÙŠÙ† Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ÙˆÙ‚Ù (ÛšØŒ Û–ØŒ Û—ØŒ Û™ØŒ Û›)
            text = text.replace(/[ÛšÛ–Û—Û™Û›]/g, '<span class="waqf-mark" aria-label="Ø¹Ù„Ø§Ù…Ø© ÙˆÙ‚Ù">$&</span>');

            const isBookmarked = (localStorage.getItem('quranBookmark') === `${surahNum}-${ayah.numberInSurah}`);
            const isLastRead = (lastReadPosition && 
                               lastReadPosition.surah == surahNum && 
                               lastReadPosition.ayah == ayah.numberInSurah);

            html += `
            <div class="ayah-container ${isLastRead ? 'ayah-highlight' : ''}" 
                 id="ayah-box-${ayah.numberInSurah}" 
                 data-ayah-num="${ayah.numberInSurah}"
                 tabindex="0"
                 aria-label="Ø§Ù„Ø¢ÙŠØ© ${ayah.numberInSurah}">
                <div class="ayah-number" aria-hidden="true">${ayah.numberInSurah}</div>
                <div class="ayah-text" 
                     onclick="playAudio('${audioUrl}', ${ayah.numberInSurah})" 
                     aria-label="Ø§Ø¶ØºØ· Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¢ÙŠØ©">
                    ${text}
                </div>
                <div class="ayah-actions">
                    <button class="btn-action btn-play" 
                            onclick="playAudio('${audioUrl}', ${ayah.numberInSurah})" 
                            title="${translations[currentLang].play}"
                            aria-label="ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¢ÙŠØ© ${ayah.numberInSurah}">
                        <i class="fas fa-play" aria-hidden="true"></i>
                    </button>
                    <button class="btn-action btn-tafsir" 
                            onclick="openTafsir(${globalNum})" 
                            title="${translations[currentLang].tafsir}"
                            aria-label="ØªÙØ³ÙŠØ± Ø§Ù„Ø¢ÙŠØ© ${ayah.numberInSurah}">
                        <i class="fas fa-book-open" aria-hidden="true"></i>
                    </button>
                    <button class="btn-action ${isBookmarked ? 'btn-saved' : 'btn-save'}" 
                            onclick="saveBookmark(${surahNum}, ${ayah.numberInSurah}, event)" 
                            title="${isBookmarked ? translations[currentLang].unsaved : translations[currentLang].save}"
                            aria-label="${isBookmarked ? 'Ø¥Ù„ØºØ§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¶Ø¹' : 'Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¶Ø¹'}">
                        <i class="${isBookmarked ? 'fas' : 'far'} fa-bookmark" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
            `;
        });
        contentDiv.innerHTML = html;
        
        // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ø£Ø¹Ù„Ù‰ ÙÙ‚Ø· Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ ØªÙ…Ø±ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ
        if (!isAutoScrolling) {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        isAutoScrolling = false;
    }

    // === Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¢ÙŠØ© ===
    function goToAyah() {
        const num = document.getElementById('goInput').value;
        if (!num || num < 1) {
            showToast(`âš ï¸ ${translations[currentLang].invalidNumber}`);
            return;
        }

        const surahNum = document.getElementById('surahSelect').value;
        if (!surahNum) {
            showToast(`âš ï¸ ${translations[currentLang].selectSurahFirst}`);
            return;
        }

        goToAyahNumber(parseInt(num), false);
    }

    function goToAyahNumber(ayahNum, isAuto) {
        const el = document.getElementById(`ayah-box-${ayahNum}`);
        if (el) {
            isAutoScrolling = true;
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // ØªØ£Ø«ÙŠØ± ÙˆÙ…ÙŠØ¶
            el.classList.add('ayah-highlight');
            setTimeout(() => {
                el.classList.remove('ayah-highlight');
            }, 2000);
            
            if (!isAuto) {
                showToast(`ğŸ“ ${translations[currentLang].goToAyahSuccess} ${ayahNum}`);
            }
        } else {
            showToast(`âš ï¸ ${translations[currentLang].ayahNotFound}`);
        }
    }

    // === Ø§Ù„ØªØ´ØºÙŠÙ„ ===
    function playAudio(url, ayahNum) {
        const audioPlayer = document.getElementById('mainAudio');
        audioPlayer.src = url;
        audioPlayer.play();
        document.getElementById('playerContainer').style.display = 'flex';
        
        document.getElementById('currentAyahLabel').innerHTML = `<i class="fas fa-music"></i> ${ayahNum}`;
        
        // Ø­ÙØ¸ Ø¢Ø®Ø± Ù…ÙˆØ¶Ø¹ Ù…Ù‚Ø±ÙˆØ¡
        saveLastPosition(currentSurah, ayahNum);
        
        // ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¢ÙŠØ© Ø§Ù„Ù†Ø´Ø·Ø©
        document.querySelectorAll('.ayah-container').forEach(el => {
            el.style.borderColor = 'rgba(255,255,255,0.05)';
            el.classList.remove('ayah-highlight');
        });
        
        const activeBox = document.getElementById(`ayah-box-${ayahNum}`);
        if(activeBox) {
            activeBox.classList.add('ayah-highlight');
        }
    }

    // === Ø­ÙØ¸ Ø¢Ø®Ø± Ù…ÙˆØ¶Ø¹ Ù…Ù‚Ø±ÙˆØ¡ ===
    function saveLastPosition(surah, ayah) {
        if (surah && ayah) {
            localStorage.setItem('lastReadPosition', JSON.stringify({
                surah: surah,
                ayah: ayah,
                timestamp: new Date().getTime()
            }));
        }
    }

    // === Ø§Ù„ØªÙØ³ÙŠØ± ===
    let isTafsirLoading = false;

    async function openTafsir(ayahGlobalNum) {
        if (isTafsirLoading) return;
        
        const tafsirType = document.getElementById('tafsirSelect').value;
        const modal = document.getElementById('tafsirModal');
        const textDiv = document.getElementById('tafsirTextDisplay');
        modal.style.display = 'flex';
        textDiv.innerText = translations[currentLang].loadingTafsir;
        
        isTafsirLoading = true;
        try {
            const res = await fetch(`https://api.alquran.cloud/v1/ayah/${ayahGlobalNum}/editions/${tafsirType}`);
            const data = await res.json();
            textDiv.innerText = (data.code === 200) ? data.data[0].text : "No Tafsir available.";
        } catch (e) {
            textDiv.innerText = "Error loading Tafsir.";
            console.error(e);
        } finally {
            isTafsirLoading = false;
        }
    }

    function closeTafsir() {
        document.getElementById('tafsirModal').style.display = 'none';
    }

    // === Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¶Ø¹ ===
    function saveBookmark(surah, ayah, event) {
        if (event) {
            event.stopPropagation();
        }
        
        const current = localStorage.getItem('quranBookmark');
        const key = `${surah}-${ayah}`;
        
        if(current === key) {
            localStorage.removeItem('quranBookmark');
            showToast(`âœ… ${translations[currentLang].bookmarkRemoved}`);
        } else {
            localStorage.setItem('quranBookmark', key);
            showToast(`âœ… ${translations[currentLang].bookmarkSaved}`);
        }
        
        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„
        if(document.getElementById('surahSelect').value == surah) {
            const btn = event.currentTarget;
            const isBookmarked = current !== key;
            
            if (isBookmarked) {
                btn.className = 'btn-action btn-saved';
                btn.innerHTML = '<i class="fas fa-bookmark" aria-hidden="true"></i>';
                btn.title = translations[currentLang].unsaved;
            } else {
                btn.className = 'btn-action btn-save';
                btn.innerHTML = '<i class="far fa-bookmark" aria-hidden="true"></i>';
                btn.title = translations[currentLang].save;
            }
        }
    }

    function goToBookmark() {
        const bookmark = localStorage.getItem('quranBookmark');
        if(!bookmark) {
            showToast(`âš ï¸ ${translations[currentLang].noBookmark}`);
            return;
        }
        const [surah, ayah] = bookmark.split('-');
        document.getElementById('surahSelect').value = surah;
        loadSurah().then(() => {
            setTimeout(() => {
                goToAyahNumber(parseInt(ayah), true);
            }, 500);
        });
    }

    // === Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ===
    function changeFontSize(delta) {
        currentFontSize += (delta * 0.1);
        if(currentFontSize < 1.0) currentFontSize = 1.0;
        if(currentFontSize > 2.5) currentFontSize = 2.5;
        document.documentElement.style.setProperty('--ayah-font-size', currentFontSize + 'em');
        saveSettings();
    }

    function toggleTheme() {
        document.body.classList.toggle('light-mode');
        const isLight = document.body.classList.contains('light-mode');
        document.getElementById('themeIcon').className = isLight ? 'fas fa-sun' : 'fas fa-moon';
        saveSettings();
    }

    function changeLang() {
        currentLang = currentLang === 'ar' ? 'en' : 'ar';
        document.documentElement.setAttribute('lang', currentLang);
        document.documentElement.setAttribute('dir', currentLang === 'ar' ? 'rtl' : 'ltr');
        document.getElementById('langText').textContent = currentLang === 'ar' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
        
        document.querySelectorAll('[data-ar]').forEach(el => {
            el.textContent = el.getAttribute(`data-${currentLang}`);
        });
        
        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡
        const juzSelect = document.getElementById('juzSelect');
        const selected = juzSelect.value;
        juzSelect.innerHTML = '';
        juzSelect.innerHTML = `<option value="" disabled>${translations[currentLang].selectJuz}</option>`;
        for (let i = 1; i <= 30; i++) {
            const opt = document.createElement('option');
            opt.value = i;
            opt.innerText = `${i}. ${translations[currentLang].juz} ${i}`;
            juzSelect.appendChild(opt);
        }
        juzSelect.value = selected;
        
        saveSettings();
    }

    function saveSettings() {
        const settings = {
            fontSize: currentFontSize,
            theme: document.body.classList.contains('light-mode') ? 'light' : 'dark',
            lang: currentLang,
            tafsir: document.getElementById('tafsirSelect').value,
            lastSurah: document.getElementById('surahSelect').value,
            lastReciter: document.getElementById('reciterSelect').value
        };
        localStorage.setItem('quranSettings', JSON.stringify(settings));
    }

    function loadSettings() {
        const settings = JSON.parse(localStorage.getItem('quranSettings'));
        if(settings) {
            currentFontSize = settings.fontSize || 1.6;
            document.documentElement.style.setProperty('--ayah-font-size', currentFontSize + 'em');
            
            if(settings.theme === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('themeIcon').className = 'fas fa-sun';
            }
            
            if(settings.lang) {
                currentLang = settings.lang;
                if(currentLang === 'en') {
                    document.documentElement.setAttribute('lang', 'en');
                    document.documentElement.setAttribute('dir', 'ltr');
                    document.getElementById('langText').textContent = 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
                }
            }

            if(settings.tafsir) {
                document.getElementById('tafsirSelect').value = settings.tafsir;
            }

            if(settings.lastReciter) {
                document.getElementById('reciterSelect').value = settings.lastReciter;
            }
        }
    }

    function showToast(msg) {
        const t = document.getElementById('toast');
        t.textContent = msg;
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 3000);
    }

    // === Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ESC ===
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            closeTafsir();
        }
    });

    // === Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ===
    const modal = document.getElementById('tafsirModal');
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            closeTafsir();
        }
    });
</script>

</body>
</html>
