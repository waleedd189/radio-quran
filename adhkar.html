<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ø§Ù„Ø£Ø°ÙƒØ§Ø± - Ø±Ø§Ø¯ÙŠÙˆ Ù‚Ø±Ø¢Ù†</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #FF9800;
            --primary-dark: #F57C00;
            --secondary: #4CAF50;
            --bg-gradient: linear-gradient(135deg, #111 0%, #222 100%);
            --card-bg: #222;
            --text: #fff;
            --gold: #FFD700;
            --border-color: #444;
            --text-font-size: 1.4em;
        }

        body.light-mode {
            --bg-gradient: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            --card-bg: #fff;
            --text: #333;
            --border-color: #ddd;
            --primary: #EF6C00;
        }
        body.light-mode .controls, body.light-mode .search-container { background: rgba(255,255,255,0.98); border-color: #ddd; }
        body.light-mode .top-bar { background: rgba(255,255,255,0.95); }
        body.light-mode select, body.light-mode input, body.light-mode .go-input { background: #fff; color: #333; border-color: #ccc; }
        body.light-mode .dhikr-text, body.light-mode .tasbih-count { color: #000; }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--bg-gradient);
            color: var(--text);
            margin: 0;
            padding: 160px 10px 90px 10px;
            min-height: 100vh;
            transition: background 0.3s, color 0.3s;
        }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .top-bar {
            position: fixed; top: 0; left: 0; width: 100%;
            background: rgba(17, 17, 17, 0.95);
            backdrop-filter: blur(10px);
            padding: 10px;
            z-index: 1000;
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
            border-bottom: 1px solid #333;
            min-height: 50px;
        }

        .btn-fab {
            background: #333; color: white; border: none;
            padding: 6px 12px; border-radius: 20px;
            cursor: pointer; font-family: 'Cairo'; font-size: 0.85em;
            display: flex; align-items: center; gap: 5px; transition: 0.2s;
        }
        body.light-mode .btn-fab { background: #eee; color: #333; border: 1px solid #ccc; }
        .btn-fab:hover { transform: scale(1.05); }
        .btn-active { background: var(--primary); color: white; border-color: var(--primary); }

        .back-btn { background: var(--secondary); color: white; border-radius: 5px; text-decoration: none; padding: 6px 15px; font-weight: bold; display: flex; align-items: center; gap: 5px;}

        /* Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªØ­ÙƒÙ… */
        .controls {
            position: fixed; top: 55px; left: 0; width: 100%;
            background: rgba(17, 17, 17, 0.98);
            padding: 10px;
            z-index: 950;
            border-bottom: 1px solid #444;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }
        
        select {
            padding: 8px;
            border-radius: 6px;
            background: #333;
            color: white;
            border: 1px solid #555;
            font-family: 'Cairo';
            font-size: 0.9em;
            cursor: pointer;
            max-width: 200px;
            flex: 1 1 150px;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« */
        .search-container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto 15px auto;
            position: relative;
        }
        .search-input {
            width: 100%;
            padding: 10px 40px 10px 15px;
            border-radius: 25px;
            background: #333;
            color: white;
            border: 1px solid #555;
            font-family: 'Cairo';
            font-size: 1em;
        }
        .search-icon {
            position: absolute; right: 15px; top: 50%;
            transform: translateY(-50%); color: #888;
        }

        .extra-actions { display: flex; gap: 10px; margin-bottom: 15px; justify-content: center; flex-wrap: wrap; }

        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø°ÙƒØ± */
        .dhikr-card {
            background: var(--card-bg);
            margin-bottom: 20px;
            padding: 25px;
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.05);
            animation: fadeIn 0.5s;
            position: relative;
            transition: transform 0.1s;
        }
        .dhikr-card.completed {
            background: rgba(76, 175, 80, 0.15);
            border: 2px solid rgba(76, 175, 80, 0.4);
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .dhikr-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .dhikr-title { color: var(--gold); font-weight: bold; font-family: 'Cairo'; font-size: 1.1em; }

        .dhikr-text {
            font-family: 'Amiri', serif;
            font-size: var(--text-font-size);
            line-height: 1.8;
            margin: 15px 0;
            text-align: justify;
            cursor: pointer;
            user-select: none;
            transition: transform 0.1s;
        }
        .dhikr-text:active { transform: scale(0.98); }

        .progress-container {
            width: 100%; background: rgba(255,255,255,0.1);
            height: 8px; border-radius: 4px; margin-top: 10px; overflow: hidden;
        }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s ease; }

        .dhikr-counter-area {
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(0,0,0,0.3); padding: 12px 20px;
            border-radius: 25px; border: 1px solid var(--border-color); margin-top: 5px;
        }
        .counter-value { font-family: 'Cairo'; font-size: 1.1em; font-weight: bold; color: var(--primary); }

        .reset-btn {
            background: var(--danger-color); color: white; border: none;
            width: 35px; height: 35px; border-radius: 50%;
            display: none; align-items: center; justify-content: center; cursor: pointer;
        }
        .dhikr-card.completed .reset-btn { display: flex; }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ© (Ø¬Ø¯ÙŠØ¯Ø©) */
        .tasbih-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
        }
        .tasbih-circle {
            width: 250px; height: 250px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(255, 152, 0, 0.4);
            cursor: pointer;
            transition: transform 0.1s;
            position: relative;
        }
        .tasbih-circle:active { transform: scale(0.95); }
        .tasbih-count { font-size: 5em; font-weight: bold; color: white; font-family: 'Amiri'; }
        
        .tasbih-controls {
            margin-top: 30px;
            display: flex; gap: 15px;
            align-items: center;
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 20px;
        }
        .tasbih-input {
            width: 60px;
            padding: 10px;
            border-radius: 10px;
            border: none;
            text-align: center;
            font-family: 'Cairo';
            font-size: 1.2em;
            font-weight: bold;
        }

        .toast {
            position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); color: white; padding: 10px 20px;
            border-radius: 20px; z-index: 3000; opacity: 0;
            transition: opacity 0.3s; pointer-events: none;
        }
        .toast.show { opacity: 1; }

        @media (max-width: 600px) {
            .tasbih-circle { width: 200px; height: 200px; }
            .tasbih-count { font-size: 4em; }
            .top-bar { justify-content: space-between; padding: 8px 5px; }
            .controls { padding: 5px; top: 50px; }
            body { padding-top: 200px; }
            .btn-fab span { display: none; } 
        }
    </style>
</head>
<body>

<!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
<div class="top-bar">
    <a href="https://waleedd189.github.io/radio-quran/" class="back-btn">
        <i class="fas fa-home"></i> <span data-ar="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" data-en="Home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
    </a>
    
    <button class="btn-fab" onclick="changeLang()">
        <i class="fas fa-language"></i> <span id="langText">English</span>
    </button>
    <button class="btn-fab" onclick="toggleTheme()">
        <i class="fas fa-moon" id="themeIcon"></i>
    </button>
    <button class="btn-fab" id="soundBtn" onclick="toggleSound()">
        <i class="fas fa-volume-mute"></i> <span data-ar="ØµÙˆØª" data-en="Sound">ØµÙˆØª</span>
    </button>
    <button class="btn-fab" onclick="changeFontSize(1)">
        <i class="fas fa-plus"></i>
    </button>
    <button class="btn-fab" onclick="changeFontSize(-1)">
        <i class="fas fa-minus"></i>
    </button>
</div>

<!-- Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªØ­ÙƒÙ… -->
<div class="controls">
    <!-- Ø²Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø°ÙƒØ§Ø± ÙˆØ§Ù„Ø³Ø¨Ø­Ø© (Ø¬Ø¯ÙŠØ¯) -->
    <button class="btn-fab" id="modeToggle" onclick="toggleMode()" style="background: var(--secondary); color: white;">
        <i class="fas fa-th-large"></i> <span data-ar="Ø§Ù„Ø£Ø°ÙƒØ§Ø±" data-en="Azkar">Ø§Ù„Ø£Ø°ÙƒØ§Ø±</span>
    </button>

    <select id="categorySelect" onchange="loadAdhkar()">
        <option value="sabah" data-ar="Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­" data-en="Morning Azkar">Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</option>
        <option value="masaa" data-ar="Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡" data-en="Evening Azkar">Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</option>
        <option value="nom" data-ar="Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…" data-en="Sleeping Azkar">Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…</option>
        <option value="post" data-ar="Ø£Ø¯Ø¹ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„ØµÙ„Ø§Ø©" data-en="Post-Prayer">Ø£Ø¯Ø¹ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„ØµÙ„Ø§Ø©</option>
        <option value="istighfar" data-ar="Ø§Ø³ØªØºÙØ§Ø±" data-en="Istighfar">Ø§Ø³ØªØºÙØ§Ø±</option>
        <option value="salawat" data-ar="Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ" data-en="Salawat">Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ</option>
    </select>
    
    <button class="btn-fab" onclick="resetAllCounters()" style="background: #f44336; color: white;">
        <i class="fas fa-trash"></i> <span data-ar="ØªØµÙÙŠØ± Ø§Ù„ÙƒÙ„" data-en="Reset All">ØªØµÙÙŠØ± Ø§Ù„ÙƒÙ„</span>
    </button>
</div>

<h1 style="text-align:center; font-family:'Amiri'; margin: 10px 0; color: var(--primary);" data-ar="Ø§Ù„Ø°ÙƒØ± ÙˆØ§Ù„Ø¹Ø¨Ø§Ø¯Ø©" data-en="Remembrance & Worship">Ø§Ù„Ø°ÙƒØ± ÙˆØ§Ù„Ø¹Ø¨Ø§Ø¯Ø©</h1>

<!-- Ù‚Ø³Ù… Ø§Ù„Ø£Ø°ÙƒØ§Ø± -->
<div id="azkarSection">
    <div class="search-container">
        <input type="text" id="searchInput" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø°ÙƒØ±..." onkeyup="searchAdhkar()">
        <i class="fas fa-search search-icon"></i>
    </div>
    <div class="extra-actions">
        <button class="btn-fab" onclick="randomDhikr()" style="background: var(--secondary); color: white; width: auto; padding: 10px 20px;">
            <i class="fas fa-random"></i> <span data-ar="Ø°ÙƒØ± Ø¹Ø´ÙˆØ§Ø¦ÙŠ" data-en="Random Dhikr">Ø°ÙƒØ± Ø¹Ø´ÙˆØ§Ø¦ÙŠ</span>
        </button>
    </div>
    <div id="content">
        <div class="loading" data-ar="Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø°ÙƒØ§Ø±..." data-en="Loading Azkar...">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø°ÙƒØ§Ø±...</div>
    </div>
</div>

<!-- Ù‚Ø³Ù… Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ© (Ø¬Ø¯ÙŠØ¯) -->
<div id="tasbihSection" class="tasbih-container">
    <div class="tasbih-circle" onclick="clickTasbih()">
        <span class="tasbih-count" id="tasbihCountDisplay">0</span>
    </div>
    
    <div class="tasbih-controls">
        <label style="color:#ccc;" data-ar="Ø§Ù„Ù‡Ø¯Ù:" data-en="Goal:">Ø§Ù„Ù‡Ø¯Ù:</label>
        <input type="number" id="tasbihTarget" class="tasbih-input" value="33" onchange="saveTasbihSettings()">
        <button class="btn-fab" onclick="resetTasbih()" style="background: #f44336; color: white;">
            <i class="fas fa-redo"></i>
        </button>
    </div>
    <p style="margin-top: 20px; color: #888; font-family: 'Cairo';" data-ar="Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ù„Ù„Ø¹Ø¯" data-en="Tap circle to count">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ù„Ù„Ø¹Ø¯</p>
</div>

<!-- Toast -->
<div id="toast" class="toast"></div>

<script>
    // === Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØª ===
    let audioContext = null;
    let soundEnabled = false;

    function initAudio() {
        if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }
    }

    function playClickSound() {
        if (!soundEnabled || !audioContext) return;
        if (audioContext.state === 'suspended') audioContext.resume();

        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.type = 'sine';
        oscillator.frequency.value = 800;
        
        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.05);

        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.05);
    }

    function toggleSound() {
        initAudio();
        soundEnabled = !soundEnabled;
        const btn = document.getElementById('soundBtn');
        if (soundEnabled) {
            btn.classList.add('btn-active');
            btn.innerHTML = '<i class="fas fa-volume-up"></i> <span data-ar="ØµÙˆØª Ù…ÙØ¹Ù„" data-en="Sound On">ØµÙˆØª Ù…ÙØ¹Ù„</span>';
            showToast('ğŸ”Š ØªÙ… ØªÙØ¹ÙŠÙ„ ØµÙˆØª Ø§Ù„Ø³Ø¨Ø­Ø©');
        } else {
            btn.classList.remove('btn-active');
            btn.innerHTML = '<i class="fas fa-volume-mute"></i> <span data-ar="ØµÙˆØª" data-en="Sound">ØµÙˆØª</span>';
            showToast('ğŸ”‡ ØªÙ… ÙƒØªÙ… Ø§Ù„ØµÙˆØª');
        }
    }

    // === Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø© ===
    const translations = {
        ar: {
            home: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", title: "Ø§Ù„Ø°ÙƒØ± ÙˆØ§Ù„Ø¹Ø¨Ø§Ø¯Ø©",
            completed: "ØªÙ…Øª Ø§Ù„Ù…Ù‡Ù…Ø©! Ø§Ù„Ù„Ù‡ ÙŠØ¨Ø§Ø±Ùƒ ÙÙŠÙƒ", reset: "Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†",
            random: "Ø°ÙƒØ± Ø¹Ø´ÙˆØ§Ø¦ÙŠ", sound: "ØµÙˆØª", modeAzkar: "Ø§Ù„Ø£Ø°ÙƒØ§Ø±", modeTasbih: "Ø§Ù„Ø³Ø¨Ø­Ø©"
        },
        en: {
            home: "Home", title: "Remembrance & Worship",
            completed: "Task Completed! God bless you", reset: "Reset",
            random: "Random Dhikr", sound: "Sound", modeAzkar: "Azkar", modeTasbih: "Tasbih"
        }
    };
    let currentLang = 'ar';
    let currentFontSize = 1.4;
    let isTasbihMode = false;

    const adhkarData = {
        sabah: [
            { title: "Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", text: "Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ù‡ÙÙˆÙ Ø§Ù„Ù’Ø­ÙÙŠÙ‘Ù Ø§Ù„Ù’Ù‚ÙÙŠÙ‘ÙÙˆÙ…Ù...", count: 1 },
            { title: "Ø§Ù„Ù…Ø¹ÙˆØ°Ø§Øª", text: "Ù‚ÙÙ„Ù’ Ù‡ÙÙˆÙ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø£ÙØ­ÙØ¯ÙŒ...", count: 3 },
            { title: "Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­ Ø§Ù„ÙƒØ¨Ø±Ù‰", text: "Ø£ÙØµÙ’Ø¨ÙØ­Ù’Ù†ÙØ§ ÙˆÙØ£ÙØµÙ’Ø¨ÙØ­Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ Ù„ÙÙ„ÙÙ‘Ù‡Ù...", count: 1 },
            { title: "Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ ÙˆØ­Ø¯Ù‡", text: "Ø§Ù„Ù„Ù‘Ù‡ÙÙ€Ù…Ù‘Ù Ø£ÙÙ†Ù’ØªÙ Ø±ÙØ¨ÙÙ‘Ù€ÙŠ Ù„Ø§ Ø¥Ù„Ù‡Ù Ø¥Ù„Ø§Ù‘ Ø£ÙÙ†Ù’ØªÙ...", count: 1 },
            { title: "ÙŠØ§ Ø­ÙŠ ÙŠØ§ Ù‚ÙŠÙˆÙ…", text: "ÙŠÙØ§ Ø­ÙÙŠÙ‘Ù ÙŠÙØ§ Ù‚ÙÙŠÙ‘ÙÙˆÙ…Ù Ø¨ÙØ±ÙØ­Ù’Ù…ÙØªÙÙƒÙ Ø£ÙØ³Ù’ØªÙØºÙÙŠØ«Ù...", count: 3 },
            { title: "Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡", text: "Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙˆÙØ¨ÙØ­ÙÙ…Ù’Ø¯ÙÙ‡Ù", count: 100 }
        ],
        masaa: [
            { title: "Ø£ÙˆØ§Ø®Ø± Ø³ÙˆØ±Ø© Ø§Ù„Ø¨Ù‚Ø±Ø©", text: "Ø¢Ù…ÙÙ†Ù Ø§Ù„Ø±Ù‘ÙØ³ÙÙˆÙ„Ù Ø¨ÙÙ…ÙØ§ Ø£ÙÙ†Ù’Ø²ÙÙ„Ù Ø¥ÙÙ„ÙÙŠÙ’Ù‡Ù...", count: 1 },
            { title: "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡ Ø§Ù„ÙƒØ¨Ø±Ù‰", text: "Ø£ÙÙ…Ù’Ø³ÙÙŠÙ’Ù†ÙØ§ ÙˆÙØ£ÙÙ…Ù’Ø³ÙÙ‰ Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ Ù„ÙÙ„Ù‘ÙÙ‡Ù...", count: 1 },
            { title: "Ø£Ø¹ÙˆØ° Ø¨ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù„Ù‡", text: "Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙÙ„ÙÙ…ÙØ§ØªÙ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„ØªÙ‘ÙØ§Ù…Ù‘ÙØ§ØªÙ Ù…ÙÙ†Ù’ Ø´ÙØ±Ù‘Ù Ù…ÙØ§ Ø®ÙÙ„ÙÙ‚Ù", count: 3 },
            { title: "Ø­Ø³Ø¨ÙŠ Ø§Ù„Ù„Ù‡", text: "Ø­ÙØ³Ù’Ø¨ÙÙ€ÙŠÙ Ø§Ù„Ù„Ù‘Ù‡Ù Ù„Ø§ Ø¥Ù„Ù‡Ù Ø¥Ù„Ø§Ù‘ Ù‡ÙÙˆÙ...", count: 7 }
        ],
        nom: [
            { title: "Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", text: "Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ù‡ÙÙˆÙ...", count: 1 },
            { title: "ØªØ®ÙÙŠÙ Ø§Ù„Ø¸Ù„Ø§Ù…", text: "Ø¨ÙØ§Ø³Ù’Ù…ÙÙƒÙ Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø£ÙØ­Ù’ÙŠÙØ§ ÙˆÙØ£ÙÙ…ÙÙˆØªÙ", count: 1 },
            { title: "Ø¥ÙŠØ§Ùƒ Ù†Ø¹Ø¨Ø¯", text: "Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¥ÙÙ†Ù‘ÙÙŠ Ø£ÙØ³Ù’Ù„ÙÙ…Ù’ØªÙ ÙˆÙØ¬Ù’Ù‡ÙÙŠ Ø¥ÙÙ„ÙÙŠÙ’ÙƒÙ...", count: 1 }
        ],
        post: [
            { title: "Ø§Ù„Ø§Ø³ØªØºÙØ§Ø±", text: "Ø£ÙØ³Ù’ØªÙØºÙ’ÙÙØ±Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù", count: 3 },
            { title: "Ø§Ù„Ù„Ù‡Ù… Ø£Ù†Øª Ø§Ù„Ø³Ù„Ø§Ù…", text: "Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø£ÙÙ†Ù’ØªÙ Ø§Ù„Ø³Ù‘ÙÙ„Ø§ÙÙ…Ù...", count: 1 },
            { title: "Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ ÙˆØ­Ø¯Ù‡", text: "Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙˆÙØ­Ù’Ø¯ÙÙ‡Ù...", count: 1 }
        ],
        istighfar: [
            { title: "Ø§Ù„Ø§Ø³ØªØºÙØ§Ø± Ø§Ù„Ø¹Ø§Ù…", text: "Ø£ÙØ³Ù’ØªÙØºÙ’ÙÙØ±Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„Ù’Ø¹ÙØ¸ÙÙŠÙ…Ù...", count: 100 }
        ],
        salawat: [
            { title: "Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…ÙŠØ©", text: "Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù ØµÙÙ„Ù‘Ù Ø¹ÙÙ„ÙÙ‰ Ù…ÙØ­ÙÙ…Ù‘ÙØ¯Ù...", count: 10 }
        ]
    };

    window.onload = () => {
        loadSettings();
        loadTasbihSettings();
        loadAdhkar();
    };

    // === Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø°ÙƒØ§Ø± ÙˆØ§Ù„Ø³Ø¨Ø­Ø© ===
    function toggleMode() {
        isTasbihMode = !isTasbihMode;
        const azkarDiv = document.getElementById('azkarSection');
        const tasbihDiv = document.getElementById('tasbihSection');
        const toggleBtn = document.getElementById('modeToggle');
        
        if(isTasbihMode) {
            azkarDiv.style.display = 'none';
            tasbihDiv.style.display = 'flex';
            toggleBtn.innerHTML = '<i class="fas fa-list"></i> <span data-ar="Ø§Ù„Ø£Ø°ÙƒØ§Ø±" data-en="Azkar">Ø§Ù„Ø£Ø°ÙƒØ§Ø±</span>';
            toggleBtn.classList.add('btn-active');
            showToast('ğŸ“¿ ØªÙ… ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ø³Ø¨Ø­Ø©');
        } else {
            azkarDiv.style.display = 'block';
            tasbihDiv.style.display = 'none';
            toggleBtn.innerHTML = '<i class="fas fa-th-large"></i> <span data-ar="Ø§Ù„Ø³Ø¨Ø­Ø©" data-en="Tasbih">Ø§Ù„Ø³Ø¨Ø­Ø©</span>';
            toggleBtn.classList.remove('btn-active');
        }
    }

    // === Ù…Ù†Ø·Ù‚ Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ===
    let tasbihCount = 0;
    let tasbihTarget = 33;

    function loadTasbihSettings() {
        const saved = JSON.parse(localStorage.getItem('simpleTasbihSettings'));
        if(saved) {
            tasbihCount = saved.count || 0;
            tasbihTarget = saved.target || 33;
            document.getElementById('tasbihTarget').value = tasbihTarget;
        }
        updateTasbihUI();
    }

    function saveTasbihSettings() {
        tasbihTarget = parseInt(document.getElementById('tasbihTarget').value) || 33;
        localStorage.setItem('simpleTasbihSettings', JSON.stringify({ count: tasbihCount, target: tasbihTarget }));
    }

    function clickTasbih() {
        initAudio();
        playClickSound();
        if(navigator.vibrate) navigator.vibrate(30);

        tasbihCount++;
        
        if(tasbihCount > tasbihTarget) {
            tasbihCount = 1; // Ø¥Ø¹Ø§Ø¯Ø© Ù„Ù„Ø¨Ø¯Ø§ÙŠØ© Ø¹Ù†Ø¯ ØªØ¬Ø§ÙˆØ² Ø§Ù„Ù‡Ø¯Ù
        }

        saveTasbihSettings();
        updateTasbihUI();
    }

    function resetTasbih() {
        tasbihCount = 0;
        saveTasbihSettings();
        updateTasbihUI();
        showToast('ğŸ”„ ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ø³Ø¨Ø­Ø©');
    }

    function updateTasbihUI() {
        document.getElementById('tasbihCountDisplay').textContent = tasbihCount;
        if(tasbihCount === tasbihTarget) {
            document.querySelector('.tasbih-circle').style.background = 'var(--secondary)';
            showToast('âœ… Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ø¹Ø¯Ø¯!');
        } else {
            document.querySelector('.tasbih-circle').style.background = 'linear-gradient(135deg, var(--primary), var(--primary-dark))';
        }
    }

    // === Ù…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø°ÙƒØ§Ø± ===
    function loadAdhkar() {
        const category = document.getElementById('categorySelect').value;
        const contentDiv = document.getElementById('content');
        const list = adhkarData[category];
        
        localStorage.setItem('lastAdhkarCat', category);
        if(!list) return;

        let html = '';
        const storedCounts = JSON.parse(localStorage.getItem('adhkarCounts')) || {};

        list.forEach((item, index) => {
            const id = `${category}-${index}`;
            const currentCount = storedCounts[id] || 0;
            const isCompleted = currentCount >= item.count;
            const progress = (currentCount / item.count) * 100;

            html += `
            <div class="dhikr-card ${isCompleted ? 'completed' : ''}" id="dhikr-box-${index+1}">
                <div class="dhikr-header">
                    <div class="dhikr-title">${item.title}</div>
                    <button class="btn-action ${isCompleted ? 'btn-saved' : 'btn-save'}" onclick="saveBookmark(${index+1})" title="${translations[currentLang].save}">
                        <i class="${isCompleted ? 'fas' : 'far'} fa-bookmark"></i>
                    </button>
                </div>
                <div class="dhikr-text" style="font-size: ${currentFontSize}em" onclick="incrementCounter('${id}', ${item.count}, this)">
                    ${item.text}
                </div>
                <div class="progress-container">
                    <div class="progress-bar" style="width: ${progress}%"></div>
                </div>
                <div class="dhikr-counter-area">
                    <span class="counter-value">${currentCount} / ${item.count}</span>
                    <button class="reset-btn" onclick="resetCounter('${id}', ${item.count})">
                        <i class="fas fa-redo"></i>
                    </button>
                </div>
            </div>
            `;
        });

        contentDiv.innerHTML = html;
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function incrementCounter(id, target, textElement) {
        initAudio();
        playClickSound();
        if(navigator.vibrate) navigator.vibrate(30);

        let counts = JSON.parse(localStorage.getItem('adhkarCounts')) || {};
        if (!counts[id]) counts[id] = 0;

        if (counts[id] < target) {
            counts[id]++;
            localStorage.setItem('adhkarCounts', JSON.stringify(counts));
            updateCounterUI(id, counts[id], target);
            
            if (counts[id] >= target) {
                document.querySelector(`[onclick*="${id}"]`).closest('.dhikr-card').classList.add('completed');
                showToast('âœ… ' + translations[currentLang].completed);
            }
        }
    }

    // Ø¥ØµÙ„Ø§Ø­ Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ù„ØªØ¹Ù…Ù„ Ø¨Ø§Ù„ØªØ£ÙƒÙŠØ¯
    function resetCounter(id, target) {
        let counts = JSON.parse(localStorage.getItem('adhkarCounts')) || {};
        counts[id] = 0;
        localStorage.setItem('adhkarCounts', JSON.stringify(counts));
        
        // Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ø¶Ù…Ø§Ù† ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        loadAdhkar();
        showToast('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯');
    }

    function resetAllCounters() {
        if(confirm(currentLang === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§ØªØŸ' : 'Are you sure you want to reset all counters?')) {
            localStorage.removeItem('adhkarCounts');
            loadAdhkar();
            resetTasbih();
            showToast('ğŸ—‘ï¸ ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª');
        }
    }

    function updateCounterUI(id, current, target) {
        const card = document.querySelector(`[onclick*="${id}"]`).closest('.dhikr-card');
        if(card) {
            card.querySelector('.counter-value').textContent = `${current} / ${target}`;
            const progress = (current / target) * 100;
            card.querySelector('.progress-bar').style.width = `${progress}%`;
        }
    }

    // === Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ===
    function searchAdhkar() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        const cards = document.querySelectorAll('.dhikr-card');
        cards.forEach(card => {
            const text = card.querySelector('.dhikr-text').textContent.toLowerCase();
            const title = card.querySelector('.dhikr-title').textContent.toLowerCase();
            if(text.includes(query) || title.includes(query)) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
    }

    function randomDhikr() {
        const category = document.getElementById('categorySelect').value;
        const list = adhkarData[category];
        if(!list) return;

        const randomIndex = Math.floor(Math.random() * list.length) + 1;
        const el = document.getElementById(`dhikr-box-${randomIndex}`);
        if (el) {
            if(el.style.display === 'none') {
                document.getElementById('searchInput').value = '';
                document.querySelectorAll('.dhikr-card').forEach(c => c.style.display = 'block');
            }
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            el.style.transform = 'scale(1.02)';
            setTimeout(() => el.style.transform = 'scale(1)', 300);
            showToast(`ğŸ² ${translations[currentLang].random}: ${list[randomIndex-1].title}`);
        }
    }

    // === Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ===
    function changeFontSize(delta) {
        currentFontSize += (delta * 0.1);
        if(currentFontSize < 1.0) currentFontSize = 1.0;
        if(currentFontSize > 2.5) currentFontSize = 2.5;
        document.documentElement.style.setProperty('--text-font-size', currentFontSize + 'em');
        document.querySelectorAll('.dhikr-text').forEach(el => el.style.fontSize = currentFontSize + 'em');
        saveSettings();
    }

    function toggleTheme() {
        document.body.classList.toggle('light-mode');
        const isLight = document.body.classList.contains('light-mode');
        document.getElementById('themeIcon').className = isLight ? 'fas fa-sun' : 'fas fa-moon';
        saveSettings();
    }

    function changeLang() {
        currentLang = currentLang === 'ar' ? 'en' : 'ar';
        document.documentElement.setAttribute('lang', currentLang);
        document.documentElement.setAttribute('dir', currentLang === 'ar' ? 'rtl' : 'ltr');
        document.getElementById('langText').textContent = currentLang === 'ar' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
        
        document.querySelectorAll('[data-ar]').forEach(el => {
            el.textContent = el.getAttribute(`data-${currentLang}`);
        });
        loadAdhkar();
        saveSettings();
    }

    function saveBookmark(num) {
        const cat = document.getElementById('categorySelect').value;
        const current = localStorage.getItem('adhkarBookmark');
        const key = `${cat}-${num}`;
        
        if(current === key) {
            localStorage.removeItem('adhkarBookmark');
            showToast('âŒ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­ÙØ¸');
        } else {
            localStorage.setItem('adhkarBookmark', key);
            showToast('âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸');
        }
        loadAdhkar();
    }

    function saveSettings() {
        const settings = {
            fontSize: currentFontSize,
            theme: document.body.classList.contains('light-mode') ? 'light' : 'dark',
            lang: currentLang
        };
        localStorage.setItem('adhkarSettings', JSON.stringify(settings));
    }

    function loadSettings() {
        const settings = JSON.parse(localStorage.getItem('adhkarSettings'));
        if(settings) {
            currentFontSize = settings.fontSize || 1.4;
            document.documentElement.style.setProperty('--text-font-size', currentFontSize + 'em');
            
            if(settings.theme === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('themeIcon').className = 'fas fa-sun';
            }
            
            if(settings.lang) {
                currentLang = settings.lang;
                if(currentLang === 'en') changeLang(); 
            }
        }
        
        const lastCat = localStorage.getItem('lastAdhkarCat');
        if(lastCat) {
            document.getElementById('categorySelect').value = lastCat;
        }
    }

    function showToast(msg) {
        const t = document.getElementById('toast');
        t.textContent = msg;
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 3000);
    }
</script>

</body>
</html>