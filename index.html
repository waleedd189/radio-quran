<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>Ø±Ø§Ø¯ÙŠÙˆ Ù‚Ø±Ø¢Ù† v4.7 </title>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiUmFkaW8gUXVyYW4iLCJzaG9ydF9uYW1lIjoiUXVyYW4gUmFkaW8iLCJzdGFydF91cmwiOiIuIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJ0aGVtZV9jb2xvciI6IiM0Q0FGNTAiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiIzExMSIsImljb25zIjpbXSwibm90aWZpY2F0aW9ucyI6eyJpY29uIjoiaWNvbi5wbmciLCJ2aWJyYXRlIjoxLCJzb3VuZCI6MX19">
<style>
/* Ù†ÙØ³ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£ØµÙ„ÙŠØ© ÙƒØ§Ù…Ù„Ø© Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± */
body {
margin: 0;
font-family: 'Cairo', 'Arial', sans-serif;
background: linear-gradient(to bottom right, #111, #333 );
color: #fff;
text-align: center;
padding: 30px 10px;
-webkit-touch-callout: none;
-webkit-user-select: none;
user-select: none;
overflow-x: hidden;
}

html[lang="en"] body {
font-family: 'Roboto', 'Arial', sans-serif;
}

h1 {
font-family: 'Amiri', serif;
font-size: 3em;
font-weight: 700;
margin-bottom: 5px;
text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
background: linear-gradient(45deg, #4CAF50, #81C784);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
display: flex;
justify-content: center;
align-items: center;
flex-wrap: wrap;
}

html[lang="en"] h1 {
font-family: 'Roboto', sans-serif;
}

h1::before {
content: "ï´¿";
color: #4CAF50;
margin-left: 10px;
}

h1::after {
content: "ï´¾";
color: #4CAF50;
margin-right: 10px;
}

h1 a {
color: inherit;
text-decoration: none;
margin: 0 5px;
background: linear-gradient(45deg, #4CAF50, #81C784);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
transition: transform 0.3s ease;
}

h1 a:hover {
transform: scale(1.05);
filter: brightness(1.2);
}

.subtitle {
font-size: 1.1em;
margin-bottom: 10px;
color: #ccc;
}

.animated-charity-text {
font-size: 1em;
margin-top: 15px;
margin-bottom: 30px;
color: #aaffaa;
text-shadow: 0 0 5px rgba(170, 255, 170, 0.7);
animation: pulseGlow 2s infinite alternate;
padding: 5px 10px;
border-radius: 8px;
background: rgba(76, 175, 80, 0.05);
border: 1px solid rgba(76, 175, 80, 0.2);
display: inline-block;
}

@keyframes pulseGlow {
0% {
opacity: 0.8;
transform: scale(1);
text-shadow: 0 0 5px rgba(170, 255, 170, 0.7);
box-shadow: 0 0 10px rgba(170, 255, 170, 0.3);
}
100% {
opacity: 1;
transform: scale(1.02);
text-shadow: 0 0 10px rgba(170, 255, 170, 1);
box-shadow: 0 0 20px rgba(170, 255, 170, 0.6);
}
}

.prayer-times-panel {
background: rgba(34, 34, 34, 0.9);
border-radius: 10px;
padding: 12px;
margin: 15px auto;
max-width: 600px;
backdrop-filter: blur(10px);
border: 1px solid rgba(76, 175, 80, 0.3);
box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
}

.prayer-times-title {
font-family: 'Amiri', serif;
font-size: 1.3em;
color: #4CAF50;
margin-bottom: 12px;
text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

html[lang="en"] .prayer-times-title {
font-family: 'Roboto', sans-serif;
}

.prayer-times-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
gap: 8px;
margin-bottom: 10px;
}

.prayer-time-item {
background: rgba(76, 175, 80, 0.1);
border-radius: 8px;
padding: 8px 6px;
border: 1px solid rgba(76, 175, 80, 0.2);
transition: all 0.3s ease;
}

.prayer-time-item:hover {
background: rgba(76, 175, 80, 0.2);
transform: translateY(-2px);
}

.prayer-time-item.next-prayer {
background: rgba(76, 175, 80, 0.3);
border-color: #4CAF50;
box-shadow: 0 0 15px rgba(76, 175, 80, 0.4);
}

.prayer-name {
font-size: 0.75em;
color: #ccc;
margin-bottom: 3px;
}

.prayer-time {
font-size: 0.9em;
font-weight: 600;
color: #4CAF50;
}

.next-prayer-info {
background: rgba(76, 175, 80, 0.1);
border-radius: 8px;
padding: 10px;
margin-top: 10px;
border: 1px solid rgba(76, 175, 80, 0.3);
}

.next-prayer-text {
font-size: 0.85em;
color: #ccc;
margin-bottom: 3px;
}

.next-prayer-countdown {
font-size: 1em;
font-weight: 600;
color: #4CAF50;
}

.location-info {
font-size: 0.75em;
color: #aaa;
margin-top: 8px;
}

.controls-panel {
background: rgba(34, 34, 34, 0.8);
border-radius: 10px;
padding: 12px;
margin: 15px auto;
max-width: 500px;
backdrop-filter: blur(10px);
border: 1px solid rgba(76, 175, 80, 0.3);
}

.now-playing {
font-size: 1em;
color: #4CAF50;
margin-bottom: 10px;
min-height: 25px;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
}

.playing-indicator {
display: none;
width: 16px;
height: 16px;
background: #4CAF50;
border-radius: 50%;
animation: pulse 1.5s infinite;
}

@keyframes pulse {
0% { opacity: 1; transform: scale(1); }
50% { opacity: 0.5; transform: scale(1.1); }
100% { opacity: 1; transform: scale(1); }
}

.loader {
width: 16px;
height: 16px;
border: 2px solid #fff;
border-bottom-color: transparent;
border-radius: 50%;
display: inline-block;
box-sizing: border-box;
animation: rotation 1s linear infinite;
display: none;
}

@keyframes rotation {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}

.sleep-timer-container {
margin: 10px 0;
display: flex;
align-items: center;
justify-content: center;
gap: 10px;
}

.sleep-timer-select {
background: rgba(255, 255, 255, 0.1);
border: 2px solid rgba(76, 175, 80, 0.3);
border-radius: 8px;
padding: 6px 10px;
color: white;
font-size: 0.9em;
cursor: pointer;
}

.sleep-timer-btn {
background: #FF9800;
color: white;
border: none;
padding: 6px 12px;
border-radius: 8px;
font-size: 0.9em;
cursor: pointer;
transition: all 0.3s ease;
}

.sleep-timer-btn:hover {
background: #F57C00;
transform: translateY(-2px);
}

.sleep-timer-btn.active {
background: #f44336;
}

.sleep-timer-btn.active:hover {
background: #d32f2f;
}

.playlist-controls {
display: flex;
justify-content: center;
gap: 8px;
margin: 10px 0;
}

.playlist-btn {
background: #4CAF50;
color: white;
border: none;
padding: 6px 12px;
border-radius: 15px;
font-size: 0.85em;
cursor: pointer;
transition: all 0.3s ease;
}

.playlist-btn:hover {
background: #45a049;
transform: translateY(-2px);
}

.playlist-btn:disabled {
background: #666;
cursor: not-allowed;
transform: none;
}

.grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 20px;
max-width: 1200px;
margin: auto;
}

.card {
background: #222;
border-radius: 15px;
padding: 15px;
box-shadow: 0 0 10px #000;
transition: all 0.3s ease;
border: 2px solid transparent;
position: relative;
}

.card:hover {
transform: translateY(-5px);
box-shadow: 0 10px 20px rgba(76, 175, 80, 0.3);
border-color: rgba(76, 175, 80, 0.5);
}

.card.active {
border-color: #4CAF50;
background: rgba(76, 175, 80, 0.1);
box-shadow: 0 0 20px rgba(76, 175, 80, 0.4);
}

.card.hidden {
display: none;
}

.card img {
width: 100%;
max-height: 160px;
object-fit: cover;
border-radius: 10px;
transition: transform 0.3s ease;
loading: lazy;
}

.card:hover img {
transform: scale(1.05);
}

.card h2 {
font-size: 1em;
margin: 10px 0;
}

button {
background-color: #4CAF50;
color: white;
border: none;
padding: 8px 14px;
border-radius: 10px;
font-size: 0.9em;
cursor: pointer;
margin: 5px;
transition: all 0.3s ease;
-webkit-tap-highlight-color: transparent;
}

button:hover {
background-color: #45a049;
transform: translateY(-2px);
}

.stop-btn {
background-color: #f44336 !important;
}

.stop-btn:hover {
background-color: #da190b !important;
}

.progress-bar {
margin-top: 10px;
height: 4px;
width: 100%;
background: #555;
position: relative;
overflow: hidden;
border-radius: 2px;
}

.progress-bar::before {
content: "";
position: absolute;
height: 100%;
width: 30%;
background: #4caf50;
animation: move 2s linear infinite;
}

.card.active .progress-bar::before {
animation: move 1s linear infinite;
background: linear-gradient(90deg, #4caf50, #81c784, #4caf50);
}

@keyframes move {
from { left: -30%; }
to { left: 100%; }
}

footer {
margin-top: 40px;
font-size: 0.9em;
color: #aaa;
}

.footer-text {
font-family: 'Cairo', sans-serif;
font-size: 0.9em;
color: #888;
margin-top: 20px;
}

html[lang="en"] .footer-text {
font-family: 'Roboto', sans-serif;
}

.time-display {
font-size: 0.8em;
color: #ccc;
margin-top: 8px;
}

.whatsapp-float {
position: fixed;
bottom: 20px;
right: 20px;
width: 60px;
height: 60px;
background: #25D366;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 4px 20px rgba(37, 211, 102, 0.4);
cursor: pointer;
transition: all 0.3s ease;
z-index: 1000;
border: none;
text-decoration: none;
}

.whatsapp-float:hover {
transform: scale(1.1);
box-shadow: 0 6px 25px rgba(37, 211, 102, 0.6);
}

.whatsapp-float svg {
width: 32px;
height: 32px;
fill: white;
}

.whatsapp-tooltip {
position: absolute;
right: 70px;
top: 50%;
transform: translateY(-50%);
background: rgba(0, 0, 0, 0.8);
color: white;
padding: 8px 12px;
border-radius: 8px;
font-size: 0.85em;
white-space: nowrap;
opacity: 0;
visibility: hidden;
transition: all 0.3s ease;
pointer-events: none;
}

.whatsapp-tooltip::after {
content: '';
position: absolute;
left: 100%;
top: 50%;
transform: translateY(-50%);
border: 6px solid transparent;
border-left-color: rgba(0, 0, 0, 0.8);
}

.whatsapp-float:hover .whatsapp-tooltip {
opacity: 1;
visibility: visible;
}

.azkar-dropdown-container, .quran-dropdown-container, .mushaf-dropdown-container, .ruqyah-dropdown-container {
position: relative;
display: block;
width: calc(100% - 10px);
margin: 10px auto;
}

.azkar-select, .quran-select, .mushaf-select, .ruqyah-select {
width: 100%;
padding: 8px;
border-radius: 8px;
background-color: #333;
color: #fff;
border: 1px solid #4CAF50;
cursor: pointer;
font-size: 0.9em;
-webkit-appearance: none;
-moz-appearance: none;
appearance: none;
background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%234CAF50%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13%205.7L146.2%20202.7%2018.5%2075.1a17.6%2017.6%200%200%200-24.7%2024.7l130.4%20130.4c6.9%206.9%2017.9%206.9%2024.8%200l130.4-130.4c6.9-6.9%206.9-18.1-.1-24.9z%22%2F%3E%3C%2Fsvg%3E' );
background-repeat: no-repeat;
background-size: 12px;
}

html[lang="ar"] .azkar-select, html[lang="ar"] .quran-select, html[lang="ar"] .mushaf-select, html[lang="ar"] .ruqyah-select {
background-position: left 8px center;
text-align: right;
padding-left: 30px;
}

html[lang="en"] .azkar-select, html[lang="en"] .quran-select, html[lang="en"] .mushaf-select, html[lang="en"] .ruqyah-select {
background-position: right 8px center;
text-align: left;
padding-right: 30px;
}

.azkar-select option, .quran-select option, .mushaf-select option, .ruqyah-select option {
background-color: #333;
color: #fff;
}

.play-sura-btn, .play-mushaf-btn, .play-ruqyah-btn {
background-color: #4CAF50;
color: white;
border: none;
padding: 8px 14px;
border-radius: 10px;
font-size: 0.9em;
cursor: pointer;
margin: 5px;
transition: all 0.3s ease;
width: calc(100% - 10px);
display: block;
box-sizing: border-box;
}

.play-sura-btn:hover, .play-mushaf-btn:hover, .play-ruqyah-btn:hover {
background-color: #45a049;
transform: translateY(-2px);
}

.language-toggle {
position: fixed;
top: 20px;
left: 20px;
background: #4CAF50;
color: white;
border: none;
padding: 8px 15px;
border-radius: 20px;
cursor: pointer;
font-size: 0.9em;
z-index: 1000;
transition: background-color 0.3s ease;
}

.language-toggle:hover {
background-color: #45a049;
}

.share-toggle {
position: fixed;
top: 20px;
left: 120px;
background: #2196F3;
color: white;
border: none;
padding: 8px 15px;
border-radius: 20px;
cursor: pointer;
font-size: 0.9em;
z-index: 1000;
transition: background-color 0.3s ease;
display: flex;
align-items: center;
gap: 5px;
}

.share-toggle:hover {
background-color: #0b7dda;
}

/* Section Headers */
.section-header {
font-family: 'Amiri', serif;
font-size: 1.8em;
color: #4CAF50;
margin: 30px 0 20px 0;
text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
position: relative;
display: inline-block;
}

.section-header::after {
content: '';
position: absolute;
bottom: -5px;
left: 50%;
transform: translateX(-50%);
width: 50px;
height: 3px;
background: linear-gradient(90deg, transparent, #4CAF50, transparent);
}

html[lang="en"] .section-header {
font-family: 'Roboto', sans-serif;
}

/* Mobile Optimizations */
@media (max-width: 768px) {
.prayer-times-grid { grid-template-columns: repeat(3, 1fr); }
h1 { font-size: 2.5em; }
.prayer-times-title { font-size: 1.2em; }
.prayer-time-item { padding: 6px 4px; }
.prayer-name { font-size: 0.7em; }
.prayer-time { font-size: 0.8em; }
.whatsapp-float { width: 50px; height: 50px; bottom: 15px; right: 15px; }
.whatsapp-float svg { width: 26px; height: 26px; }
.whatsapp-tooltip { right: 60px; font-size: 0.8em; }
.language-toggle { top: 10px; left: 10px; padding: 6px 10px; font-size: 0.8em; }
.share-toggle { top: 10px; left: 85px; padding: 6px 10px; font-size: 0.8em; }
h1 a { display: block; margin: 5px 0; }
.section-header { font-size: 1.5em; margin: 20px 0 15px 0; }

/* Touch optimization */
button {
min-height: 44px;
min-width: 44px;
}

.card {
transform: scale(0.98);
}

.controls-panel {
padding: 8px;
}
}

/* Notification Permission Banner */
.notification-banner {
position: fixed;
top: 70px;
left: 50%;
transform: translateX(-50%);
background: rgba(76, 175, 80, 0.9);
color: white;
padding: 12px 20px;
border-radius: 25px;
box-shadow: 0 4px 15px rgba(0,0,0,0.3);
z-index: 1001;
display: flex;
align-items: center;
gap: 15px;
max-width: 90%;
}

.notification-banner button {
background: white;
color: #4CAF50;
border: none;
padding: 6px 12px;
border-radius: 15px;
cursor: pointer;
font-size: 0.8em;
}

.notification-banner button:hover {
background: #f0f0f0;
}

/* ===== Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ===== */

/* Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ Ø¨Ø¯ÙˆÙ† Ø¥Ø·Ø§Ø± ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† */
.hijri-date {
position: fixed;
top: 20px;
right: 20px;
font-family: 'Amiri', serif;
font-size: 1.2em;
color: #aaffaa;
text-shadow: 0 0 5px rgba(170, 255, 170, 0.7);
z-index: 1000;
background: rgba(0, 0, 0, 0.3);
padding: 8px 15px;
border-radius: 20px;
backdrop-filter: blur(5px);
}

/* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ù…ØªØ­Ø±Ùƒ Ø¨Ù†ÙØ³ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø«Ø§Ù†ÙŠ */
.news-ticker {
background: rgba(76, 175, 80, 0.1);
border: 1px solid rgba(76, 175, 80, 0.3);
border-radius: 15px;
padding: 10px 0;
margin: 5px auto;
max-width: 800px;
overflow: hidden;
position: relative;
}

.news-ticker-content {
display: inline-block;
white-space: nowrap;
animation: ticker 30s linear infinite;
color: #4CAF50;
font-weight: 600;
padding: 0 100%;
}

@keyframes ticker {
0% { transform: translateX(-100%); }
100% { transform: translateX(100%); }
}

/* ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠØ© */
.language-toggle {
top: 20px;
left: 20px;
}

.share-toggle {
top: 20px;
left: 120px;
}

/* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø¹Ø§Ù… */
#globalAudioPlayerContainer {
display: none;
margin: 20px auto;
max-width: 600px;
background: rgba(34, 34, 34, 0.9);
border-radius: 15px;
padding: 15px;
box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
transition: all 0.3s ease;
}

#globalAudioPlayer {
width: 100%;
height: 40px;
background: rgba(0, 0, 0, 0.3);
border-radius: 10px;
}

/* ØªØ®ØµÙŠØµ Ø£Ù„ÙˆØ§Ù† Ù…Ø´ØºÙ„ Ø§Ù„ØµÙˆØª */
#globalAudioPlayer::-webkit-media-controls-panel {
background-color: rgba(34, 34, 34, 0.9);
}

#globalAudioPlayer::-webkit-media-controls-play-button,
#globalAudioPlayer::-webkit-media-controls-pause-button {
background-color: #4CAF50;
border-radius: 50%;
}

#globalAudioPlayer::-webkit-media-controls-timeline {
background-color: #555;
}

#globalAudioPlayer::-webkit-media-controls-volume-slider {
background-color: #4CAF50;
}

#globalAudioPlayer::-webkit-media-controls-mute-button {
background-color: #4CAF50;
}

#globalAudioPlayer::-webkit-media-controls-timeline {
padding-left: 10px;
padding-right: 10px;
}

#globalAudioPlayer::-webkit-media-controls-current-time-display,
#globalAudioPlayer::-webkit-media-controls-time-remaining-display {
color: #ccc;
}

.global-player-header {
display: flex;
align-items: center;
justify-content: space-between;
margin-bottom: 10px;
}

#globalPlayerStationName {
color: #4CAF50;
font-weight: bold;
}

.close-player-btn {
background: none;
border: none;
color: #aaa;
cursor: pointer;
font-size: 1.2em;
padding: 0;
width: 30px;
height: 30px;
display: flex;
align-items: center;
justify-content: center;
border-radius: 50%;
transition: all 0.3s ease;
}

.close-player-btn:hover {
background: rgba(255, 255, 255, 0.1);
color: #fff;
}

@media (max-width: 768px) {
.hijri-date {
top: 60px;
right: 10px;
font-size: 1em;
padding: 6px 12px;
}

.news-ticker-content {
animation-duration: 25s;
}

#globalAudioPlayerContainer {
margin: 15px 10px;
max-width: calc(100% - 20px);
}
}

/* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© */
.volume-control {
display: flex;
align-items: center;
justify-content: center;
margin: 10px 0;
gap: 10px;
}

.volume-slider {
width: 100px;
height: 5px;
background: #555;
outline: none;
opacity: 0.7;
transition: opacity 0.2s;
border-radius: 5px;
}

.volume-slider:hover {
opacity: 1;
}

.volume-slider::-webkit-slider-thumb {
-webkit-appearance: none;
appearance: none;
width: 15px;
height: 15px;
background: #4CAF50;
cursor: pointer;
border-radius: 50%;
}

.volume-slider::-moz-range-thumb {
width: 15px;
height: 15px;
background: #4CAF50;
cursor: pointer;
border-radius: 50%;
}

.favorite-btn {
background: #9C27B0;
color: white;
border: none;
padding: 6px 12px;
border-radius: 20px;
font-size: 0.8em;
cursor: pointer;
transition: all 0.3s ease;
position: absolute;
top: 10px;
right: 10px;
z-index: 10;
}

.favorite-btn:hover {
background: #7B1FA2;
transform: scale(1.05);
}

.favorite-btn.active {
background: #E91E63;
}

.favorite-btn.active:hover {
background: #C2185B;
}

.search-container {
margin: 15px auto;
max-width: 600px;
position: relative;
}

.search-input {
width: 100%;
padding: 10px 40px 10px 15px;
border-radius: 25px;
border: 1px solid rgba(76, 175, 80, 0.3);
background: rgba(34, 34, 34, 0.8);
color: white;
font-size: 0.9em;
outline: none;
transition: all 0.3s ease;
}

.search-input:focus {
border-color: #4CAF50;
box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);
}

.search-icon {
position: absolute;
right: 15px;
top: 50%;
transform: translateY(-50%);
color: #aaa;
}

.favorites-section {
margin-top: 30px;
display: none;
}

.favorites-section.active {
display: block;
}

.favorites-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 15px;
}

.clear-favorites-btn {
background: #f44336;
color: white;
border: none;
padding: 5px 10px;
border-radius: 15px;
font-size: 0.8em;
cursor: pointer;
transition: all 0.3s ease;
}

.clear-favorites-btn:hover {
background: #d32f2f;
}

.empty-favorites {
text-align: center;
color: #aaa;
padding: 20px;
font-style: italic;
}

/* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ */
.lazy-image {
opacity: 0;
transition: opacity 0.3s;
}

.lazy-image.loaded {
opacity: 1;
}
</style>
</head>
<body>
<!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£ØµÙ„ÙŠØ© -->
<button class="language-toggle" id="languageToggle" onclick="toggleLanguage()">English</button>
<button class="share-toggle" id="shareToggle" onclick="shareApp()">
<span>ğŸ“¤</span>
<span id="shareText">Ù…Ø´Ø§Ø±ÙƒØ©</span>
</button>

<!-- Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ Ø¨Ø¯ÙˆÙ† Ø¥Ø·Ø§Ø± -->
<div class="hijri-date" id="hijriDate">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ...</div>

<h1>
<span id="quranRadioTitle">Ø±Ø§Ø¯ÙŠÙˆ Ù‚Ø±Ø¢Ù†</span>
<span id="subtitleText">ØµÙØ­Ø©</span>
<a href="https://www.facebook.com/lakel7amd" target="_blank" id="facebookPageLink">Ø§Ù„Ù„Ù‡Ù… Ù„Ùƒ Ø§Ù„Ø­Ù…Ø¯</a>
</h1>
<div class="animated-charity-text" id="charityText">ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø£Ù…ÙˆØ§Øª Ø§Ù„Ù…Ø³Ù„Ù…ÙŠÙ†</div>

<!-- Notification Permission Banner -->
<div class="notification-banner" id="notificationBanner" style="display: none;">
<span id="notificationText">ØªÙØ¹ÙŠÙ„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØµÙ„Ø§Ø©ØŸ</span>
<button onclick="enableNotifications()">ØªÙØ¹ÙŠÙ„</button>
<button onclick="dismissNotificationBanner()">Ù„Ø§ Ø§Ù„Ø¢Ù†</button>
</div>

<!-- Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
<div class="search-container">
<input type="text" class="search-input" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø­Ø·Ø©..." onkeyup="filterStations()">
<span class="search-icon">ğŸ”</span>
</div>

<div class="prayer-times-panel">
<div class="prayer-times-title" id="prayerTimesTitle">Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</div>
<div class="prayer-times-grid" id="prayerTimesGrid">
<div class="prayer-time-item">
<div class="prayer-name" data-translation-key="fajr">Ø§Ù„ÙØ¬Ø±</div>
<div class="prayer-time" id="fajrTime">--:--</div>
</div>
<div class="prayer-time-item">
<div class="prayer-name" data-translation-key="sunrise">Ø§Ù„Ø´Ø±ÙˆÙ‚</div>
<div class="prayer-time" id="sunriseTime">--:--</div>
</div>
<div class="prayer-time-item">
<div class="prayer-name" data-translation-key="dhuhr">Ø§Ù„Ø¸Ù‡Ø±</div>
<div class="prayer-time" id="dhuhrTime">--:--</div>
</div>
<div class="prayer-time-item">
<div class="prayer-name" data-translation-key="asr">Ø§Ù„Ø¹ØµØ±</div>
<div class="prayer-time" id="asrTime">--:--</div>
</div>
<div class="prayer-time-item">
<div class="prayer-name" data-translation-key="maghrib">Ø§Ù„Ù…ØºØ±Ø¨</div>
<div class="prayer-time" id="maghribTime">--:--</div>
</div>
<div class="prayer-time-item">
<div class="prayer-name" data-translation-key="isha">Ø§Ù„Ø¹Ø´Ø§Ø¡</div>
<div class="prayer-time" id="ishaTime">--:--</div>
</div>
</div>
<div class="next-prayer-info">
<div class="next-prayer-text" id="nextPrayerText"></div>
<div class="next-prayer-countdown" id="nextPrayerCountdown">--:--:--</div>
</div>
<div class="location-info" id="locationInfo"></div>
</div>

<div class="controls-panel">
<div class="now-playing" id="nowPlaying">
<div class="playing-indicator" id="playingIndicator"></div>
<div class="loader" id="bufferingLoader"></div>
<span id="stationName"></span>
</div>

<div class="playlist-controls">
<button class="playlist-btn" onclick="previousStation()" id="prevBtn" disabled>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
<button class="playlist-btn" onclick="nextStation()" id="nextBtn" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
</div>

<!-- Ø¹Ù†ØµØ± Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙˆØª Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
<div class="volume-control">
<span>ğŸ”ˆ</span>
<input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50">
<span>ğŸ”Š</span>
</div>

<div class="sleep-timer-container">
<select class="sleep-timer-select" id="sleepTimerSelect">
<option value="0">Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª</option>
<option value="15">15 Ø¯Ù‚ÙŠÙ‚Ø©</option>
<option value="30">30 Ø¯Ù‚ÙŠÙ‚Ø©</option>
<option value="45">45 Ø¯Ù‚ÙŠÙ‚Ø©</option>
<option value="60">60 Ø¯Ù‚ÙŠÙ‚Ø©</option>
</select>
<button class="sleep-timer-btn" id="sleepTimerBtn" onclick="toggleSleepTimer()">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª</button>
</div>

<div class="time-display" id="timeDisplay"></div>
</div>

<!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ù…ØªØ­Ø±Ùƒ -->
<div class="news-ticker">
<div class="news-ticker-content">
Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù…ÙˆÙ‚Ø¹ Ø±Ø§Ø¯ÙŠÙˆ Ù‚Ø±Ø¢Ù† ØµÙØ­Ø© Ø§Ù„Ù„Ù‡Ù… Ù„Ùƒ Ø§Ù„Ø­Ù…Ø¯ ğŸ“» | ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØµÙØ­Ø© Ù…Ø³ØªÙ‚Ù„Ø© Ø¨Ø¯Ø±ÙˆØ³ Ø§Ù„Ø´ÙŠØ® ØµØ§Ù„Ø­ Ø¨Ù† Ø¹ÙˆØ§Ø¯ Ø§Ù„Ù…ØºØ§Ù…Ø³ÙŠ * ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØµÙØ­Ø© Ø®Ø§ØµØ© Ø¨Ø¯Ø±ÙˆØ³ Ø§Ù„Ø´ÙŠØ® Ø¹Ù…Ø± Ø¹Ø¨Ø¯Ø§Ù„ÙƒØ§ÙÙ‰ | Ù„Ø§ ØªÙ†Ø³Ù‰ Ø°ÙƒØ± Ø§Ù„Ù„Ù‡
</div>
</div>

<!-- Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø¹Ø§Ù… -->
<div id="globalAudioPlayerContainer">
<div class="global-player-header">
<div id="globalPlayerStationName">Ø§Ø®ØªØ± Ù…Ø­Ø·Ø© Ù„Ù„ØªØ´ØºÙŠÙ„</div>
<button class="close-player-btn" onclick="toggleGlobalPlayer()">Ã—</button>
</div>
<audio id="globalAudioPlayer" controls></audio>
</div>

<!-- Section 1: Ø§Ù„Ø£Ø°ÙƒØ§Ø± - Ø§Ù„Ø±Ù‚ÙŠØ© (Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø´Ø¹Ø±Ø§ÙˆÙŠ) -->
<h2 class="section-header" id="section1Title">Ø§Ù„Ø£Ø°ÙƒØ§Ø± - Ø§Ù„Ø±Ù‚ÙŠØ©</h2>
<div class="grid" id="section1-stations"></div>

<!-- Section 2: Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ù†Ø§Ø¨Ù„Ø³ - Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© -->
<h2 class="section-header" id="section2Title">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ù†Ø§Ø¨Ù„Ø³ - Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</h2>
<div class="grid" id="section2-stations"></div>

<!-- Section 3: Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø§Øª (Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© ÙØ§Ø±Ø³ Ø¹Ø¨Ø§Ø¯ ÙˆØ§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ ÙˆÙ…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹ÙŠÙ‚Ù„ÙŠ) -->
<h2 class="section-header" id="section3Title">Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø§Øª</h2>
<div class="grid" id="section3-stations"></div>

<!-- Section 4: Ø¯Ø±ÙˆØ³ ÙˆØ¹Ø¨Ø± -->
<h2 class="section-header" id="section4Title">Ø¯Ø±ÙˆØ³ ÙˆØ¹Ø¨Ø±</h2>
<div class="grid" id="section4-stations"></div>

<!-- Ù‚Ø³Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
<div class="favorites-section" id="favoritesSection">
<div class="favorites-header">
<h2 class="section-header">Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª</h2>
<button class="clear-favorites-btn" onclick="clearFavorites()">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
</div>
<div class="grid" id="favorites-grid">
<div class="empty-favorites">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø·Ø§Øª Ù…ÙØ¶Ù„Ø©</div>
</div>
</div>

<footer>
<div class="footer-text" id="footerText">Ø±Ø§Ø¯ÙŠÙˆ Ù‚Ø±Ø¢Ù† - ØµÙØ­Ø© Ø§Ù„Ù„Ù‡Ù… Ù„Ùƒ Ø§Ù„Ø­Ù…Ø¯</div>
</footer>
<audio id="radioPlayer" controls style="display:none;" preload="auto"></audio>

<button class="whatsapp-float" onclick="reportBrokenLink(); return false;" id="whatsappBtn">
<div class="whatsapp-tooltip" id="whatsappTooltip">Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø±Ø§Ø¨Ø· Ù…Ø¹Ø·Ù„</div>
<svg viewBox="0 0 24 24">
<path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.520.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.520-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.893 3.488"/>
</svg>
</button>

<script>
// Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙ‚Ø·

// Translations object
const translations = {
ar: {
quranRadio: "Ø±Ø§Ø¯ÙŠÙˆ Ù‚Ø±Ø¢Ù†",
subtitle: "ØµÙØ­Ø©",
facebookLinkText: "Ø§Ù„Ù„Ù‡Ù… Ù„Ùƒ Ø§Ù„Ø­Ù…Ø¯",
charityText: "ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø£Ù…ÙˆØ§Øª Ø§Ù„Ù…Ø³Ù„Ù…ÙŠÙ†",
languageToggle: "English",
prayerTimesTitle: "Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©",
fajr: "Ø§Ù„ÙØ¬Ø±",
sunrise: "Ø§Ù„Ø´Ø±ÙˆÙ‚",
dhuhr: "Ø§Ù„Ø¸Ù‡Ø±",
asr: "Ø§Ù„Ø¹ØµØ±",
maghrib: "Ø§Ù„Ù…ØºØ±Ø¨",
isha: "Ø§Ù„Ø¹Ø´Ø§Ø¡",
nextPrayerText: "Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©:",
locationInfoLoading: "Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹...",
locationInfoError: "Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø£Ùˆ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©.",
locationInfoTimezone: "Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©:",
initialStationText: "Ø§Ø®ØªØ± Ù…Ø­Ø·Ø© Ù„Ù„ØªØ´ØºÙŠÙ„",
prevBtn: "Ø§Ù„Ø³Ø§Ø¨Ù‚",
nextBtn: "Ø§Ù„ØªØ§Ù„ÙŠ",
searchPlaceholder: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø­Ø·Ø©...",
timePlaying: "ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„:",
azkarSelectDefault: "Ø§Ø®ØªØ± Ø£Ø°ÙƒØ§Ø±...",
quranSelectDefault: "Ø§Ø®ØªØ± Ø³ÙˆØ±Ø©...",
mushafSelectDefault: "Ø§Ø®ØªØ± Ø³ÙˆØ±Ø©...",
ruqyahSelectDefault: "Ø§Ø®ØªØ± Ø±Ù‚ÙŠØ©...",
playButton: "ØªØ´ØºÙŠÙ„",
stopButton: "Ø¥ÙŠÙ‚Ø§Ù",
playSuraButton: "ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø©",
playMushafButton: "ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø©",
playRuqyahButton: "ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ù‚ÙŠØ©",
whatsappTooltip: "Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø±Ø§Ø¨Ø· Ù…Ø¹Ø·Ù„",
playbackError: "Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø·Ø©:",
noPrayerData: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©",
whatsappMessage: "ÙŠÙˆØ¬Ø¯ Ø±Ø§Ø¨Ø· Ù…Ø¹Ø·Ù„ ÙÙŠ Ø±Ø§Ø¯ÙŠÙˆ Ø§Ù„Ù‚Ø±Ø¢Ù†ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚",
footerDesignedBy: "Ø±Ø§Ø¯ÙŠÙˆ Ù‚Ø±Ø¢Ù† - ØµÙØ­Ø© Ø§Ù„Ù„Ù‡Ù… Ù„Ùƒ Ø§Ù„Ø­Ù…Ø¯",
sleepTimerText: "ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª",
sleepTimerStopText: "Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª",
shareText: "Ù…Ø´Ø§Ø±ÙƒØ©",
notificationText: "ØªÙØ¹ÙŠÙ„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØµÙ„Ø§Ø©ØŸ",
notificationEnable: "ØªÙØ¹ÙŠÙ„",
notificationDismiss: "Ù„Ø§ Ø§Ù„Ø¢Ù†",
section1Title: "Ø§Ù„Ø£Ø°ÙƒØ§Ø± - Ø§Ù„Ø±Ù‚ÙŠØ©",
section2Title: "Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ù†Ø§Ø¨Ù„Ø³ - Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©",
section3Title: "Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø§Øª",
section4Title: "Ø¯Ø±ÙˆØ³ ÙˆØ¹Ø¨Ø±",
listenToCompleteQuran: "Ø§Ø®ØªØ± Ø³ÙˆØ±Ø©",
listenToTafsir: "Ø§Ø³ØªÙ…Ø§Ø¹ Ø¥Ù„Ù‰ Ø§Ù„ØªÙØ³ÙŠØ±",
listenToLessons: "Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø¯Ø±ÙˆØ³",
mushafAlMinshawi: "Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ù…Ø±ØªÙ„",
ruwayaAlMinshawi: "Ø±ÙˆØ§Ø¦Ø¹ Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ",
favoritesTitle: "Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª",
clearFavorites: "Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„",
emptyFavorites: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø·Ø§Øª Ù…ÙØ¶Ù„Ø©"
},
en: {
quranRadio: "Quran Radio",
subtitle: "Page of",
facebookLinkText: "Allahuma Lak Alhamd (All Praise is Due to Allah)",
charityText: "Continuous charity for all deceased Muslims",
languageToggle: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
prayerTimesTitle: "Prayer Times",
fajr: "Fajr",
sunrise: "Sunrise",
dhuhr: "Dhuhr",
asr: "Asr",
maghrib: "Maghrib",
isha: "Isha",
nextPrayerText: "Next Prayer:",
locationInfoLoading: "Determining location...",
locationInfoError: "Failed to fetch prayer times. Please check internet connection or reload page.",
locationInfoTimezone: "Timezone:",
initialStationText: "Select a station to play",
prevBtn: "Previous",
nextBtn: "Next",
searchPlaceholder: "Search for a station...",
timePlaying: "Playing time:",
azkarSelectDefault: "Select Azkar...",
quranSelectDefault: "Select Sura...",
mushafSelectDefault: "Select Sura from Mushaf Al-Mu'allim...",
ruqyahSelectDefault: "Select Ruqyah...",
playButton: "Play",
stopButton: "Stop",
playSuraButton: "Play Sura",
playMushafButton: "Play Sura",
playRuqyahButton: "Play Ruqyah",
whatsappTooltip: "Report a broken link",
playbackError: "Error playing station:",
noPrayerData: "No prayer data available",
whatsappMessage: "There is a broken link in Quran Radio, please check",
footerDesignedBy: "Radio Quran - Allahumma lakal-hamd page",
sleepTimerText: "Start Timer",
sleepTimerStopText: "Stop Timer",
shareText: "Share",
notificationText: "Enable prayer notifications?",
notificationEnable: "Enable",
notificationDismiss: "Not now",
section1Title: "Azkar - Ruqyah",
section2Title: "Cairo - Nablus - Saudi",
section3Title: "Other Stations",
section4Title: "Lessons & Wisdom",
listenToCompleteQuran: "Listen to Complete Quran",
listenToTafsir: "Listen to Tafsir",
listenToLessons: "Listen to Lessons",
mushafAlMinshawi: "Mushaf Al-Minshawi",
ruwayaAlMinshawi: "Minshawi's Masterpieces",
favoritesTitle: "Favorites",
clearFavorites: "Clear All",
emptyFavorites: "No favorite stations"
}
};

let currentLanguage = 'ar'; // Default language
let notificationPermissionGranted = false;
let favorites = JSON.parse(localStorage.getItem('radioFavorites')) || [];

// Ø®ÙˆØ§Ø·Ø± Ø§Ù„Ø´ÙŠØ® Ø§Ù„Ø´Ø¹Ø±Ø§ÙˆÙŠ ÙÙŠ ØªÙØ³ÙŠØ± Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… (Ù…Ø­Ø¯Ø«Ø©)
const sharawyTafsirRecordings = [
{ name: "Ù…Ù‚Ø¯Ù…Ø© 1", url: "https://archive.org/download/Khwater.El-Sharawy.Fi.Tafsir.EL-Qouran-Introm-Up-By-mUSLEm/000_Intro1.mp3" },
{ name: "Ù…Ù‚Ø¯Ù…Ø© 2", url: "https://archive.org/download/Khwater.El-Sharawy.Fi.Tafsir.EL-Qouran-Introm-Up-By-mUSLEm/000_Intro2.mp3" },
{ name: "Ù…Ù‚Ø¯Ù…Ø© 3", url: "https://archive.org/download/Khwater.El-Sharawy.Fi.Tafsir.EL-Qouran-Introm-Up-By-mUSLEm/000_Intro3.mp3" },
{ name: "Ù…Ù‚Ø¯Ù…Ø© 4", url: "https://archive.org/download/Khwater.El-Sharawy.Fi.Tafsir.EL-Qouran-Introm-Up-By-mUSLEm/000_Intro4.mp3" },
{ name: "Ø³ÙˆØ±Ø© Ø§Ù„ÙØ§ØªØ­Ø© 001", url: "https://archive.org/download/Khwater.El-Sharawy.Fi.Tafsir.EL-Qouran-1a2-Up-By-mUSLEm/001_Al-Fatihah_001.mp3" },
// ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø³ÙˆØ± ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ
];

// Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…ØµÙÙˆÙØ§Øª ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ
const misharyQuranSuras = [
{ num: '001', name: { ar: 'Ø§Ù„ÙØ§ØªØ­Ø©', en: 'Al-Fatiha' }, url: 'https://archive.org/download/Islamic_Tape-192_uP_bY_mUSLEm/001.mp3' },
// ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø³ÙˆØ± ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ
];

const mushafAlmualimSuras = [
{ num: '001', name: { ar: 'Ø³ÙˆØ±Ø© Ø§Ù„ÙØ§ØªØ­Ø©', en: 'Al-Fatiha' }, url: 'https://archive.org/download/Islamic_Tape-227_uP_bY_mUSLEm/001_M.Ettounssi.mp3' },
// ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø³ÙˆØ± ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ
];

const azkarRecordings = [
{ name: {ar: "Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­ Ùˆ Ø§Ù„Ù…Ø³Ø§Ø¡ Ù„Ù„Ù‚Ø§Ø±Ø¦ Ø¥Ø¯Ø±ÙŠØ³ Ø£Ø¨ÙƒØ±", en: "Morning & Evening Azkar - Idrees Abkar"}, url: "https://archive.org/download/AthkarAlsabahAbdulazizBi356856835685683356568/Athkar%20Idrees%20Abkar.mp3" },
// ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ
];

// Ø¥Ø¶Ø§ÙØ© ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø§Ù„Ø±Ù‚ÙŠØ© Ù…Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯
const ruqyahRecordings = [
{ name: {ar: " Ø§Ø°Ø§Ø¹Ø© Ø±Ù‚ÙŠØ© Ø¹Ø§Ù…Ø© 1", en: "General Ruqyah"}, url: "https://qurango.net/radio/roqiah" },
{ name: {ar: " Ø§Ø°Ø§Ø¹Ø© Ø±Ù‚ÙŠØ© Ø¹Ø§Ù…Ø© 2", en: "General Ruqyah"}, url: "https://backup.qurango.net/radio/sakeenah/%c3%cb%ed%d10%d1%c7%cf%ed%e6.mp3" },
{ name: {ar: "Ø±Ù‚ÙŠØ© Ù…Ø­Ù…Ø¯ Ø¬Ø¨Ø±ÙŠÙ„", en: "Ruqyah for Magic"}, url: "https://ia601207.us.archive.org/10/items/Mp3Mp3_201511/%D8%A7%D9%84%D8%B1%D9%82%D9%8A%D8%A9%20%D8%A7%D9%84%D8%B4%D8%B1%D8%B9%D9%8A%D8%A9%20mp3%20%D9%85%D8%AD%D9%85%D8%AF%20%D8%AC%D8%A8%D8%B1%D9%8A%D9%84%20%D9%83%D8%A7%D9%85%D9%84%D8%A9.mp3" },
{ name: {ar: "Ø±Ù‚ÙŠØ© Ù„Ù„Ù…Ø³", en: "Ruqyah for Possession"}, url: "https://ia600308.us.archive.org/6/items/roqya-20--mp3-----from---elahmad.com/assayari-sihr.mp3" },
{ name: {ar: "Ø±Ù‚ÙŠØ© Ù…Ø´Ø§Ø±Ù‰ Ø±Ø§Ø´Ø¯", en: "Islamic Ruqyah"}, url: "https://server03.quran-uni.com:7012/;*.mp3" }
];

// Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„: Ù†Ù‚Ù„ Ø§Ù„Ø´Ø¹Ø±Ø§ÙˆÙŠ Ù„Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙˆÙ„
const section1Stations = [
{ name: {ar: "Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø£Ø°ÙƒØ§Ø±", en: "Azkar Radio"}, img: "https://7nen.do.am/_ph/6/676236720.jpg", type: "azkar", recordings: azkarRecordings },
{ name: {ar: "Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø´Ø¹Ø±Ø§ÙˆÙŠ", en: "Al-Sharawi Radio"}, img: "https://archive.org/download/20250929_20250929_2020/%D8%A7%D9%84%D8%B4%D8%B9%D8%B1%D8%A7%D9%88%D9%89.jpg", url: "https://waleedd189.github.io/radio-quran/sharawy-tafsir.html" },
{ name: {ar: "Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø±Ù‚ÙŠØ©", en: "Ruqyah Radio"}, img: "https://7nen.do.am/_ph/6/1/288946560.jpg", type: "ruqyah", recordings: ruqyahRecordings }
];

const section2Stations = [
{ name: {ar: "Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©", en: "Cairo Radio"}, img: "https://7nen.do.am/_ph/6/1/660752318.jpg", url: "https://stream.radiojar.com/8s5u5tpdtwzuv" },
{ name: {ar: "Ø¥Ø°Ø§Ø¹Ø© Ù†Ø§Ø¨Ù„Ø³", en: "Nablus Radio"}, img: "https://7nen.do.am/_ph/6/842159606.jpg", url: "https://quran-radio.org:8443/;?type=http&nocache=13" },
{ name: {ar: "Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©", en: "Saudi Radio"}, img: "https://7nen.do.am/_ph/6/1/730393383.jpg", url: "https://backup.qurango.net/radio/abdulrahman_alsudaes/Ø£Ø«ÙŠØ±%20Ø±Ø§Ø¯ÙŠÙˆ.mp3" }
];

// Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø« ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ ÙˆÙ…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹ÙŠÙ‚Ù„ÙŠ
const section3Stations = [
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ø§Ù„Ø­ØµØ±ÙŠ", en: "Sheikh Al-Husary"}, img: "https://7nen.do.am/_ph/6/1/650079361.jpg", completeQuranUrl: "https://waleedd189.github.io/radio-quran/mahmoud-khalil.html" },
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ø¹Ø¨Ø¯Ø§Ù„Ø¨Ø§Ø³Ø·", en: "Sheikh Abdul Basit"}, img: "https://7nen.do.am/_ph/6/1/788498118.jpg", url: "https://qurango.net/radio/abdulbasit_abdulsamad.mp3" },
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…ÙˆØ¯ Ø¹Ù„ÙŠ Ø§Ù„Ø¨Ù†Ø§", en: "Sheikh Mahmoud Ali Al-Banna"}, img: "https://7nen.do.am/_ph/6/1/592190149.jpg", url: "https://backup.qurango.net/radio/mahmoud_ali__albanna" },
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ù…ØµØ·ÙÙ‰ Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„", en: "Sheikh Mustafa Ismail"}, img: "https://7nen.do.am/_ph/6/1/49597189.jpg", url: "https://backup.qurango.net/radio/mustafa_ismail" },
// Ø¥Ø¶Ø§ÙØ© Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ Ù…Ø¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
{ 
name: {ar: "Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ ØµØ¯ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ", en: "Sheikh Muhammad Siddiq Al-Minshawi"}, 
img: "https://i.postimg.cc/tJ0v8zZn/image.jpg", 
url: "https://server03.quran-uni.com:7036/;*.mp3",
mushafUrl: "https://waleedd189.github.io/radio-quran/Al-Minshawi.html",
ruwayaUrl: "https://waleedd189.github.io/radio-quran/Al-Minshawi.html"
},
// Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø§Øª
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¹Ø¬Ù…ÙŠ", en: "Sheikh Ahmed Al-Ajmi"}, img: "https://7nen.do.am/_ph/6/1/979378293.jpg", url: "https://qurango.net/radio/ahmad_alajmy.mp3" },
{
name: {ar: "Ø§Ù„Ø´ÙŠØ® Ù…Ø´Ø§Ø±ÙŠ Ø±Ø§Ø´Ø¯", en: "Sheikh Mishary Rashid"},
img: "https://7nen.do.am/_ph/6/1/526518923.jpg",
url: "https://qurango.net/radio/mishary_alafasi.mp3",
completeQuranUrl: "https://waleedd189.github.io/radio-quran/mishari-rashid.html"
},
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¬Ø¨Ø±ÙŠÙ„", en: "Sheikh Muhammad Jibreel"}, img: "https://7nen.do.am/_ph/6/1/844452129.jpg", url: "https://backup.qurango.net/radio/mohammed_jibreel" },
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ø¥Ø¯Ø±ÙŠØ³ Ø£Ø¨ÙƒØ±", en: "Sheikh Idrees Abkar"}, img: "https://7nen.do.am/_ph/6/1/695351424.jpg", url: "https://backup.qurango.net/radio/idrees_abkr" },
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ø³Ø¹Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ", en: "Sheikh Saad Al-Ghamdi"}, img: "https://7nen.do.am/_ph/6/1/613525566.jpg", url: "https://backup.qurango.net/radio/saad_alghamdi" },
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ù…ØµØ·ÙÙ‰ Ø§Ù„Ù„Ø§Ù‡ÙˆÙ†ÙŠ", en: "Sheikh Mustafa Al-Lahouni"}, img: "https://7nen.do.am/_ph/6/1/586864154.jpg", url: "https://backup.qurango.net/radio/mustafa_allahoni" },
{ name: {ar: "Ø§Ù„Ø´ÙŠØ® Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø´Ø­Ø§Øª", en: "Sheikh Abdul Rahman Al-Shahhat"}, img: "https://7nen.do.am/_ph/6/1/397155617.jpg", url: "https://backup.qurango.net/radio/a_alshahhat" },
{
name: {ar: "Ø§Ù„Ø´ÙŠØ® ÙØ§Ø±Ø³ Ø¹Ø¨Ø§Ø¯", en: "Sheikh Fares Abbad"},
img: "https://tvquran.com/uploads/authors/images/%D9%81%D8%A7%D8%B1%D8%B3%20%D8%B9%D8%A8%D8%A7%D8%AF.jpg",
url: "https://qurango.net/radio/fares_abbad.mp3",
completeQuranUrl: "https://waleedd189.github.io/radio-quran/fares-abbad.html"
},
// Ø¥Ø¶Ø§ÙØ© Ø¥Ø°Ø§Ø¹Ø© Ù…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹ÙŠÙ‚Ù„ÙŠ Ø¨Ø¹Ø¯ ÙØ§Ø±Ø³ Ø¹Ø¨Ø§Ø¯
{
name: {ar: "Ø§Ù„Ø´ÙŠØ® Ù…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹ÙŠÙ‚Ù„ÙŠ", en: "Sheikh Maher Al-Muaiqly"},
img: "https://i.postimg.cc/WzgpPS5k/image.png",
url: "https://server03.quran-uni.com:7005/;*.mp3"
}
];

// Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯ "Ø¯Ø±ÙˆØ³ ÙˆØ¹Ø¨Ø±" Ù…Ø¹ Ù…Ø­Ø·ØªÙŠ Ø¹Ù…Ø± Ø¹Ø¨Ø¯Ø§Ù„ÙƒØ§ÙÙŠ ÙˆØµØ§Ù„Ø­ Ø§Ù„Ù…ØºØ§Ù…Ø³ÙŠ ÙˆØ±Ø§ØºØ¨ Ø§Ù„Ø³Ø±Ø¬Ø§Ù†ÙŠ ÙˆØ§Ù„Ù†Ø§Ø¨Ù„Ø³ÙŠ ÙˆØ§Ù„Ø²ØºØ¨ÙŠ
const section4Stations = [
{
name: {ar: "Ø¯Ø±ÙˆØ³ Ø¹Ù…Ø± Ø¹Ø¨Ø¯Ø§Ù„ÙƒØ§ÙÙŠ", en: "Lessons by Omar Abdul Kafi"},
img: "https://i.postimg.cc/k5Sn0qfb/image.jpg",
lessonsUrl: "https://waleedd189.github.io/radio-quran/Omar-Kafee.html"
},
{
name: {ar: "Ø¯Ø±ÙˆØ³ ØµØ§Ù„Ø­ Ø§Ù„Ù…ØºØ§Ù…Ø³ÙŠ", en: "Lessons by Saleh Al-Maghamsi"},
img: "https://i.postimg.cc/3NngSQdg/image.jpg",
lessonsUrl: "https://waleedd189.github.io/radio-quran/Saleh-Al-Maghamsi.html"
},
{
name: {ar: "Ø¯Ø±ÙˆØ³ Ø±Ø§ØºØ¨ Ø§Ù„Ø³Ø±Ø¬Ø§Ù†ÙŠ", en: "Lessons by Dr. Ragheb Al-Sergani"},
img: "https://i.postimg.cc/yNQMqFqW/image.jpg",
lessonsUrl: "https://waleedd189.github.io/radio-quran/Ragheb-Sergany.html"
},
{
name: {ar: "Ø¯Ø±ÙˆØ³ Ù…Ø­Ù…Ø¯ Ø±Ø§ØªØ¨ Ø§Ù„Ù†Ø§Ø¨Ù„Ø³ÙŠ", en: "Lessons by Sheikh Muhammad Ratib Al-Nabulsi"},
img: "https://i.postimg.cc/3wh1Gyb8/image.jpg",
lessonsUrl: "https://waleedd189.github.io/radio-quran/El-Naboulsi.html"
},
// Ø¥Ø¶Ø§ÙØ© Ù‚Ù†Ø§Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ù„Ùƒ Ø§Ù„Ø²ØºØ¨ÙŠ
{
name: {ar: "Ø¯Ø±ÙˆØ³ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ù„Ùƒ Ø§Ù„Ø²ØºØ¨ÙŠ", en: "Lessons by Sheikh Muhammad Abdul Malik Al-Zaghbi"},
img: "https://i.postimg.cc/Yq2JK9ng/image.jpg",
lessonsUrl: "https://waleedd189.github.io/radio-quran/Al-Zaghbi.html"
},
// Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø´ÙŠØ® Ø¹Ø§Ø¦Ø¶ Ø§Ù„Ù‚Ø±Ù†ÙŠ
{
name: {ar: "Ø¯Ø±ÙˆØ³ Ø§Ù„Ø´ÙŠØ® Ø¹Ø§Ø¦Ø¶ Ø§Ù„Ù‚Ø±Ù†ÙŠ", en: "Lessons by Sheikh A'idh al-Qarni"},
img: "https://i.postimg.cc/Tw6MhWQP/alqrny.jpg",
lessonsUrl: "https://waleedd189.github.io/radio-quran/Aidh-al-Qarni.html"
}
];

// Combine all stations for search functionality
const allStations = [...section1Stations, ...section2Stations, ...section3Stations, ...section4Stations];

const section1Container = document.getElementById('section1-stations');
const section2Container = document.getElementById('section2-stations');
const section3Container = document.getElementById('section3-stations');
const section4Container = document.getElementById('section4-stations');
const favoritesContainer = document.getElementById('favorites-grid');
const player = document.getElementById('radioPlayer');
const globalPlayer = document.getElementById('globalAudioPlayer');
const nowPlayingSpan = document.getElementById('stationName');
const playingIndicator = document.getElementById('playingIndicator');
const bufferingLoader = document.getElementById('bufferingLoader');
const timeDisplay = document.getElementById('timeDisplay');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const volumeSlider = document.getElementById('volumeSlider');
const searchInput = document.getElementById('searchInput');
const favoritesSection = document.getElementById('favoritesSection');
const htmlElement = document.documentElement;

let currentStationIndex = -1;
let playStartTime = null;
let timeInterval = null;
let prayerTimes = {};
let nextPrayerInterval = null;
let sleepTimer = null;

// Function to set the language and update content
function setLanguage(lang) {
currentLanguage = lang;
htmlElement.setAttribute('lang', lang);
htmlElement.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');

// Update static texts
document.getElementById('quranRadioTitle').textContent = translations[lang].quranRadio;
document.getElementById('subtitleText').textContent = translations[lang].subtitle;
document.getElementById('facebookPageLink').textContent = translations[lang].facebookLinkText;
document.getElementById('charityText').textContent = translations[lang].charityText;
document.getElementById('languageToggle').textContent = translations[lang].languageToggle;
document.getElementById('shareText').textContent = translations[lang].shareText;
document.getElementById('prayerTimesTitle').textContent = translations[lang].prayerTimesTitle;
document.getElementById('prevBtn').textContent = translations[lang].prevBtn;
document.getElementById('nextBtn').textContent = translations[lang].nextBtn;
document.getElementById('whatsappTooltip').textContent = translations[lang].whatsappTooltip;
document.getElementById('footerText').textContent = translations[lang].footerDesignedBy;
document.getElementById('sleepTimerBtn').textContent = translations[lang].sleepTimerText;
document.getElementById('notificationText').textContent = translations[lang].notificationText;
document.getElementById('section1Title').textContent = translations[lang].section1Title;
document.getElementById('section2Title').textContent = translations[lang].section2Title;
document.getElementById('section3Title').textContent = translations[lang].section3Title;
document.getElementById('section4Title').textContent = translations[lang].section4Title;
document.getElementById('searchInput').placeholder = translations[lang].searchPlaceholder;

// Update prayer names
document.querySelectorAll('.prayer-name').forEach(el => {
const key = el.getAttribute('data-translation-key');
if (key && translations[lang][key]) {
el.textContent = translations[lang][key];
}
});

// Re-initialize station cards to apply language-specific names and dropdowns
initializeStations();

// Update dynamic texts
updateNowPlayingText();
updatePrayerTimesDisplay();
startNextPrayerCountdown();
updateLocationInfo(prayerTimes.meta ? prayerTimes.meta.timezone : '');
updateTimeDisplay();

// ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù‡Ø¬Ø±ÙŠ
updateHijriDate();

// ØªØ­Ø¯ÙŠØ« Ù‚Ø³Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª
updateFavoritesSection();
}

// Toggle language
function toggleLanguage() {
setLanguage(currentLanguage === 'ar' ? 'en' : 'ar');
}

// Share app function
function shareApp() {
const shareData = {
title: translations[currentLanguage].quranRadio,
text: `${translations[currentLanguage].quranRadio} - ${translations[currentLanguage].subtitle} ${translations[currentLanguage].facebookLinkText}`,
url: window.location.href
};

if (navigator.share) {
navigator.share(shareData)
.catch(console.error);
} else {
// Fallback: copy to clipboard
const textToCopy = `${shareData.title}\n${shareData.text}\n${shareData.url}`;
navigator.clipboard.writeText(textToCopy).then(() => {
alert(currentLanguage === 'ar' ? 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!' : 'Link copied to clipboard!');
}).catch(() => {
alert(currentLanguage === 'ar' ? 'ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®ØŒ ÙŠØ±Ø¬Ù‰ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ¯ÙˆÙŠØ§Ù‹' : 'Failed to copy, please copy manually');
});
}
}

// Initialize stations
function initializeStations() {
// Clear existing content
section1Container.innerHTML = '';
section2Container.innerHTML = '';
section3Container.innerHTML = '';
section4Container.innerHTML = '';

// Render Section 1 stations
section1Stations.forEach((station) => {
const card = createStationCard(station);
section1Container.appendChild(card);
});

// Render Section 2 stations
section2Stations.forEach((station) => {
const card = createStationCard(station);
section2Container.appendChild(card);
});

// Render Section 3 stations
section3Stations.forEach((station) => {
const card = createStationCard(station);
section3Container.appendChild(card);
});

// Render Section 4 stations
section4Stations.forEach((station) => {
const card = createStationCard(station);
section4Container.appendChild(card);
});

// ØªØ­Ø¯ÙŠØ« Ù‚Ø³Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª
updateFavoritesSection();
}

// Create station card
function createStationCard(station) {
const card = document.createElement('div');
card.className = 'card';

// Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø©
const isFavorite = favorites.some(fav => fav.name === station.name.ar || fav.name === station.en);
const favoriteBtn = `<button class="favorite-btn ${isFavorite ? 'active' : ''}" onclick="toggleFavorite('${station.name.ar}', '${station.name.en}', '${station.img}', '${station.url || station.lessonsUrl || ''}')">â™¡</button>`;

if (station.type === 'azkar') {
card.innerHTML = `
 ${favoriteBtn}
<img src="${station.img}" alt="${station.name[currentLanguage]}" loading="lazy" class="lazy-image" />
<h2>${station.name[currentLanguage]}</h2>
<div class="azkar-dropdown-container">
<select class="azkar-select" onchange="playAzkar(this)">
<option value="">${translations[currentLanguage].azkarSelectDefault}</option>
 ${station.recordings.map(rec => `<option value="${rec.url}">${rec.name[currentLanguage]}</option>`).join('')}
</select>
</div>
<button class="stop-btn" onclick="stopRadio()">${translations[currentLanguage].stopButton}</button>
<div class="progress-bar"></div>
`;
} else if (station.type === 'ruqyah') {
card.innerHTML = `
 ${favoriteBtn}
<img src="${station.img}" alt="${station.name[currentLanguage]}" loading="lazy" class="lazy-image" />
<h2>${station.name[currentLanguage]}</h2>
<div class="ruqyah-dropdown-container">
<select class="ruqyah-select" onchange="playRuqyah(this)">
<option value="">${translations[currentLanguage].ruqyahSelectDefault}</option>
 ${station.recordings.map(rec => `<option value="${rec.url}">${rec.name[currentLanguage]}</option>`).join('')}
</select>
</div>
<button class="stop-btn" onclick="stopRadio()">${translations[currentLanguage].stopButton}</button>
<div class="progress-bar"></div>
`;
} else if (station.name[currentLanguage] === "Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø´Ø¹Ø±Ø§ÙˆÙŠ") {
// Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø¹Ø±Ø§ÙˆÙŠ Ø¨Ø¯ÙˆÙ† Ø£Ø²Ø±Ø§Ø± ØªØ´ØºÙŠÙ„
card.innerHTML = `
 ${favoriteBtn}
<img src="${station.img}" alt="${station.name[currentLanguage]}" loading="lazy" class="lazy-image" />
<h2>${station.name[currentLanguage]}</h2>
<a href="https://waleedd189.github.io/radio-quran/sharawy-tafsir.html"
style="background-color: #4CAF50; color: white; border: none; padding: 8px 14px;
border-radius: 10px; font-size: 0.9em; cursor: pointer; margin: 5px;
text-decoration: none; display: inline-block; transition: all 0.3s ease;"
onmouseover="this.style.backgroundColor='#45a049'; this.style.transform='translateY(-2px)'"
onmouseout="this.style.backgroundColor='#4CAF50'; this.style.transform='translateY(0)'">
 ${translations[currentLanguage].listenToTafsir}
</a>
<div class="progress-bar"></div>
`;
} else if (station.lessonsUrl) {
// Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¯Ø±ÙˆØ³ Ø¨Ø¯ÙˆÙ† Ø£Ø²Ø±Ø§Ø± ØªØ´ØºÙŠÙ„ ÙˆØ¥ÙŠÙ‚Ø§Ù
card.innerHTML = `
 ${favoriteBtn}
<img src="${station.img}" alt="${station.name[currentLanguage]}" loading="lazy" class="lazy-image" />
<h2>${station.name[currentLanguage]}</h2>
<a href="${station.lessonsUrl}"
style="background-color: #4CAF50; color: white; border: none; padding: 8px 14px;
border-radius: 10px; font-size: 0.9em; cursor: pointer; margin: 5px;
text-decoration: none; display: inline-block; transition: all 0.3s ease;"
onmouseover="this.style.backgroundColor='#45a049'; this.style.transform='translateY(-2px)'"
onmouseout="this.style.backgroundColor='#4CAF50'; this.style.transform='translateY(0)'">
 ${translations[currentLanguage].listenToLessons}
</a>
<div class="progress-bar"></div>
`;
} else if (station.completeQuranUrl) {
// Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…ØµØ­Ù Ø§Ù„ÙƒØ§Ù…Ù„
card.innerHTML = `
 ${favoriteBtn}
<img src="${station.img}" alt="${station.name[currentLanguage]}" loading="lazy" class="lazy-image" />
<h2>${station.name[currentLanguage]}</h2>
<button onclick="playRadio('${station.url}', '${station.name[currentLanguage]}', this)">${translations[currentLanguage].playButton}</button>
<button class="stop-btn" onclick="stopRadio()">${translations[currentLanguage].stopButton}</button>
<a href="${station.completeQuranUrl}"
style="background-color: #4CAF50; color: white; border: none; padding: 8px 14px;
border-radius: 10px; font-size: 0.9em; cursor: pointer; margin: 5px;
text-decoration: none; display: inline-block; transition: all 0.3s ease;"
onmouseover="this.style.backgroundColor='#45a049'; this.style.transform='translateY(-2px)'"
onmouseout="this.style.backgroundColor='#4CAF50'; this.style.transform='translateY(0)'">
 ${translations[currentLanguage].listenToCompleteQuran}
</a>
<div class="progress-bar"></div>
`;
} else if (station.name[currentLanguage] === "Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ ØµØ¯ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ" || station.name.en === "Sheikh Muhammad Siddiq Al-Minshawi") {
// Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ Ù…Ø¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
card.innerHTML = `
 ${favoriteBtn}
<img src="${station.img}" alt="${station.name[currentLanguage]}" loading="lazy" class="lazy-image" />
<h2>${station.name[currentLanguage]}</h2>
<button onclick="playRadio('${station.url}', '${station.name[currentLanguage]}', this)">${translations[currentLanguage].playButton}</button>
<button class="stop-btn" onclick="stopRadio()">${translations[currentLanguage].stopButton}</button>
<a href="${station.mushafUrl}"
style="background-color: #4CAF50; color: white; border: none; padding: 8px 14px;
border-radius: 10px; font-size: 0.9em; cursor: pointer; margin: 5px;
text-decoration: none; display: inline-block; transition: all 0.3s ease;"
onmouseover="this.style.backgroundColor='#45a049'; this.style.transform='translateY(-2px)'"
onmouseout="this.style.backgroundColor='#4CAF50'; this.style.transform='translateY(0)'">
 ${translations[currentLanguage].mushafAlMinshawi}
</a>
<a href="${station.ruwayaUrl}"
style="background-color: #4CAF50; color: white; border: none; padding: 8px 14px;
border-radius: 10px; font-size: 0.9em; cursor: pointer; margin: 5px;
text-decoration: none; display: inline-block; transition: all 0.3s ease;"
onmouseover="this.style.backgroundColor='#45a049'; this.style.transform='translateY(-2px)'"
onmouseout="this.style.backgroundColor='#4CAF50'; this.style.transform='translateY(0)'">
 ${translations[currentLanguage].ruwayaAlMinshawi}
</a>
<div class="progress-bar"></div>
`;
} else {
// Regular station card
card.innerHTML = `
 ${favoriteBtn}
<img src="${station.img}" alt="${station.name[currentLanguage]}" loading="lazy" class="lazy-image" />
<h2>${station.name[currentLanguage]}</h2>
<button onclick="playRadio('${station.url}', '${station.name[currentLanguage]}', this)">${translations[currentLanguage].playButton}</button>
<button class="stop-btn" onclick="stopRadio()">${translations[currentLanguage].stopButton}</button>
<div class="progress-bar"></div>
`;
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ± Ø¨Ø´ÙƒÙ„ ÙƒØ³ÙˆÙ„
const img = card.querySelector('img');
if (img) {
img.addEventListener('load', function() {
this.classList.add('loaded');
});
}

return card;
}

// Enable play buttons
function enablePlaySuraButton(selectElement) {
const playSuraBtn = selectElement.nextElementSibling;
if (selectElement.value) {
playSuraBtn.disabled = false;
} else {
playSuraBtn.disabled = true;
}
}

function enablePlayMushafButton(selectElement) {
const playMushafBtn = selectElement.nextElementSibling;
if (selectElement.value) {
playMushafBtn.disabled = false;
} else {
playMushafBtn.disabled = true;
}
}

function enablePlayRuqyahButton(selectElement) {
const playRuqyhBtn = selectElement.nextElementSibling;
if (selectElement.value) {
playRuqyhBtn.disabled = false;
} else {
playRuqyhBtn.disabled = true;
}
}

// Play functions
function playAzkar(selectElement) {
const selectedOption = selectElement.options[selectElement.selectedIndex];
const url = selectedOption.value;
const mainStationName = selectElement.closest('.card').querySelector('h2').textContent;
const recordingName = selectedOption.textContent;

if (url) {
playRadio(url, `${mainStationName} - ${recordingName}`, selectElement);
selectElement.value = url;
} else {
stopRadio();
}
}

function playRuqyah(selectElement) {
const selectedOption = selectElement.options[selectElement.selectedIndex];
const url = selectedOption.value;
const mainStationName = selectElement.closest('.card').querySelector('h2').textContent;
const recordingName = selectedOption.textContent;

if (url) {
playRadio(url, `${mainStationName} - ${recordingName}`, selectElement);
selectElement.value = url;
} else {
stopRadio();
}
}

function playQuranSura(selectElement) {
const selectedOption = selectElement.options[selectElement.selectedIndex];
const url = selectedOption.value;
const mainStationName = selectElement.closest('.card').querySelector('h2').textContent;
const suraName = selectedOption.textContent;

if (url) {
playRadio(url, `${mainStationName} - ${suraName}`, selectElement);
selectElement.value = url;
} else {
stopRadio();
}
}

function playMushafSura(selectElement) {
const selectedOption = selectElement.options[selectElement.selectedIndex];
const url = selectedOption.value;
const mainStationName = selectElement.closest('.card').querySelector('h2').textContent;
const suraName = selectedOption.textContent;

if (url) {
playRadio(url, `${mainStationName} - ${suraName}`, selectElement);
selectElement.value = url;
} else {
stopRadio();
}
}

// Main play radio function
function playRadio(url, stationName, elementToActivate) {
// Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ
player.pause();
player.src = "";

playingIndicator.style.display = 'none';
bufferingLoader.style.display = 'inline-block';

document.querySelectorAll('.card').forEach(card => card.classList.remove('active'));

const currentCard = elementToActivate.closest('.card');
currentCard.classList.add('active');

nowPlayingSpan.textContent = stationName;

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø¹Ø§Ù…
const globalPlayerContainer = document.getElementById('globalAudioPlayerContainer');
const globalPlayerStationName = document.getElementById('globalPlayerStationName');

globalPlayer.src = url;
globalPlayer.volume = volumeSlider.value / 100;
globalPlayerContainer.style.display = 'block';
globalPlayerStationName.textContent = stationName;

let foundIndex = -1;

foundIndex = allStations.findIndex(station => {
if (station.type === 'azkar') {
return station.recordings.some(rec => rec.url === url);
} else if (station.type === 'ruqyah') {
return station.recordings.some(rec => rec.url === url);
} else if (station.type === 'quran_sura_list') {
return station.url === url || station.suras.some(sura => sura.url === url);
} else if (station.type === 'mushaf_mualim') {
return station.url === url || station.suras.some(sura => sura.url === url);
} else {
return station.url === url;
}
});

currentStationIndex = foundIndex;
updatePlaylistButtons();

// Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø¹Ø§Ù…
globalPlayer.addEventListener('waiting', onBufferingStart);
globalPlayer.addEventListener('playing', onBufferingEnd);
globalPlayer.addEventListener('canplay', onBufferingEnd);
globalPlayer.addEventListener('play', () => {
playStartTime = Date.now();
startTimeCounter();
});
globalPlayer.addEventListener('pause', () => {
playingIndicator.style.display = 'none';
});
globalPlayer.addEventListener('ended', () => {
stopRadio();
});

globalPlayer.play().then(() => {
playStartTime = Date.now();
startTimeCounter();
}).catch(error => {
console.error('Playback error:', error);
nowPlayingSpan.textContent = `${translations[currentLanguage].playbackError} ${stationName}`;
bufferingLoader.style.display = 'none';
currentCard.classList.remove('active');
globalPlayerContainer.style.display = 'none';
});
}

// Buffering handlers
function onBufferingStart() {
playingIndicator.style.display = 'none';
bufferingLoader.style.display = 'inline-block';
}

function onBufferingEnd() {
bufferingLoader.style.display = 'none';
playingIndicator.style.display = 'block';
}

// Stop radio
function stopRadio() {
const globalPlayerContainer = document.getElementById('globalAudioPlayerContainer');

globalPlayer.pause();
globalPlayer.src = "";
globalPlayerContainer.style.display = 'none';

player.pause();
player.src = "";
nowPlayingSpan.textContent = translations[currentLanguage].initialStationText;
playingIndicator.style.display = 'none';
bufferingLoader.style.display = 'none';

document.querySelectorAll('.card').forEach(card => card.classList.remove('active'));

currentStationIndex = -1;
updatePlaylistButtons();
stopTimeCounter();
}

// Toggle global player
function toggleGlobalPlayer() {
const globalPlayerContainer = document.getElementById('globalAudioPlayerContainer');
const globalPlayer = document.getElementById('globalAudioPlayer');

globalPlayerContainer.style.display = 'none';
globalPlayer.pause();
globalPlayer.src = "";

// Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
nowPlayingSpan.textContent = translations[currentLanguage].initialStationText;
playingIndicator.style.display = 'none';
bufferingLoader.style.display = 'none';

document.querySelectorAll('.card').forEach(card => card.classList.remove('active'));

currentStationIndex = -1;
updatePlaylistButtons();
stopTimeCounter();
}

// Sleep timer
function toggleSleepTimer() {
const sleepTimerSelect = document.getElementById('sleepTimerSelect');
const sleepTimerBtn = document.getElementById('sleepTimerBtn');
const minutes = parseInt(sleepTimerSelect.value);

if (minutes === 0) {
if (sleepTimer) {
clearTimeout(sleepTimer);
sleepTimer = null;
sleepTimerBtn.textContent = translations[currentLanguage].sleepTimerText;
sleepTimerBtn.classList.remove('active');
}
} else {
if (sleepTimer) {
clearTimeout(sleepTimer);
}

sleepTimerBtn.textContent = translations[currentLanguage].sleepTimerStopText;
sleepTimerBtn.classList.add('active');

sleepTimer = setTimeout(() => {
stopRadio();
sleepTimerBtn.textContent = translations[currentLanguage].sleepTimerText;
sleepTimerBtn.classList.remove('active');
sleepTimer = null;
sleepTimerSelect.value = '0';
}, minutes * 60 * 1000);
}
}

// Playlist navigation
function previousStation() {
if (currentStationIndex > 0) {
let targetIndex = currentStationIndex - 1;
while (targetIndex >= 0 && (allStations[targetIndex].type === 'azkar' || allStations[targetIndex].type === 'ruqyah' || allStations[targetIndex].type === 'quran_sura_list' || allStations[targetIndex].type === 'mushaf_mualim')) {
if ((allStations[targetIndex].type === 'quran_sura_list' || allStations[targetIndex].type === 'mushaf_mualim') && allStations[targetIndex].url === globalPlayer.src) {
break;
}
targetIndex--;
}
if (targetIndex >= 0) {
const prevStation = allStations[targetIndex];
const cards = document.querySelectorAll('.card');
const targetCard = Array.from(cards).find(card =>
card.querySelector('h2').textContent === prevStation.name[currentLanguage]
);
if (targetCard) {
const playButton = targetCard.querySelector('button:not(.stop-btn)');
if(playButton) playButton.click();
}
}
}
updatePlaylistButtons();
}

function nextStation() {
if (currentStationIndex < allStations.length - 1) {
let targetIndex = currentStationIndex + 1;
while (targetIndex < allStations.length && (allStations[targetIndex].type === 'azkar' || allStations[targetIndex].type === 'ruqyah' || allStations[targetIndex].type === 'quran_sura_list' || allStations[targetIndex].type === 'mushaf_mualim')) {
if ((allStations[targetIndex].type === 'quran_sura_list' || allStations[targetIndex].type === 'mushaf_mualim') && allStations[targetIndex].url === globalPlayer.src) {
break;
}
targetIndex++;
}
if (targetIndex < allStations.length) {
const nextStation = allStations[targetIndex];
const cards = document.querySelectorAll('.card');
const targetCard = Array.from(cards).find(card =>
card.querySelector('h2').textContent === nextStation.name[currentLanguage]
);
if (targetCard) {
const playButton = targetCard.querySelector('button:not(.stop-btn)');
if(playButton) playButton.click();
}
}
}
updatePlaylistButtons();
}

function updatePlaylistButtons() {
if (currentStationIndex === -1) {
prevBtn.disabled = true;
nextBtn.disabled = true;
return;
}

const currentStation = allStations[currentStationIndex];

let isSubItemPlaying = false;
if (currentStation.type === 'azkar' && currentStation.recordings.some(rec => rec.url === globalPlayer.src)) {
isSubItemPlaying = true;
} else if (currentStation.type === 'ruqyah' && currentStation.recordings.some(rec => rec.url === globalPlayer.src)) {
isSubItemPlaying = true;
} else if ((currentStation.type === 'quran_sura_list' || currentStation.type === 'mushaf_mualim') &&
((currentStation.suras && currentStation.suras.some(sura => sura.url === globalPlayer.src)) ||
(currentStation.url === globalPlayer.src))) {
isSubItemPlaying = true;
}

if (isSubItemPlaying) {
prevBtn.disabled = true;
nextBtn.disabled = true;
return;
}

let hasPrevious = false;
for (let i = currentStationIndex - 1; i >= 0; i--) {
if (allStations[i].type !== 'azkar' && allStations[i].type !== 'ruqyah' && allStations[i].type !== 'quran_sura_list' && allStations[i].type !== 'mushaf_mualim') {
hasPrevious = true;
break;
} else if ((allStations[i].type === 'quran_sura_list' || allStations[i].type === 'mushaf_mualim') && allStations[i].url === globalPlayer.src) {
hasPrevious = true;
break;
}
}

let hasNext = false;
for (let i = currentStationIndex + 1; i < allStations.length; i++) {
if (allStations[i].type !== 'azkar' && allStations[i].type !== 'ruqyah' && allStations[i].type !== 'quran_sura_list' && allStations[i].type !== 'mushaf_mualim') {
hasNext = true;
break;
} else if ((allStations[i].type === 'quran_sura_list' || allStations[i].type === 'mushaf_mualim') && allStations[i].url === globalPlayer.src) {
hasNext = true;
break;
}
}

prevBtn.disabled = !hasPrevious;
nextBtn.disabled = !hasNext;
}

// Time counter
function startTimeCounter() {
clearInterval(timeInterval);
timeInterval = setInterval(() => {
if (playStartTime) {
updateTimeDisplay();
}
}, 1000);
}

function updateTimeDisplay() {
if (playStartTime) {
const elapsed = Math.floor((Date.now() - playStartTime) / 1000);
const minutes = Math.floor(elapsed / 60);
const seconds = elapsed % 60;
timeDisplay.textContent = `${translations[currentLanguage].timePlaying} ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
}
}

function stopTimeCounter() {
if (timeInterval) {
clearInterval(timeInterval);
timeInterval = null;
}
timeDisplay.textContent = '';
playStartTime = null;
}

function updateNowPlayingText() {
if (globalPlayer.src) {
let currentPlayingName = translations[currentLanguage].initialStationText;
const currentPlayingUrl = globalPlayer.src;

const foundStation = allStations.find(station => {
if (station.type === 'azkar') {
const matchingRecording = station.recordings.find(rec => rec.url === currentPlayingUrl);
if (matchingRecording) {
currentPlayingName = `${station.name[currentLanguage]} - ${matchingRecording.name[currentLanguage]}`;
return true;
}
} else if (station.type === 'ruqyah') {
const matchingRecording = station.recordings.find(rec => rec.url === currentPlayingUrl);
if (matchingRecording) {
currentPlayingName = `${station.name[currentLanguage]} - ${matchingRecording.name[currentLanguage]}`;
return true;
}
} else if (station.type === 'quran_sura_list' || station.type === 'mushaf_mualim') {
if (station.url === currentPlayingUrl) {
currentPlayingName = station.name[currentLanguage];
return true;
}
const matchingSura = station.suras.find(sura => sura.url === currentPlayingUrl);
if (matchingSura) {
currentPlayingName = `${station.name[currentLanguage]} - ${matchingSura.name[currentLanguage]}`;
return true;
}
} else if (station.url === currentPlayingUrl) {
currentPlayingName = station.name[currentLanguage];
return true;
}
return false;
});
nowPlayingSpan.textContent = currentPlayingName;
playingIndicator.style.display = globalPlayer.paused ? 'none' : 'block';
} else {
nowPlayingSpan.textContent = translations[currentLanguage].initialStationText;
playingIndicator.style.display = 'none';
}
}

// Prayer times functions
async function getUserLocation() {
return new Promise((resolve, reject) => {
if (navigator.geolocation) {
navigator.geolocation.getCurrentPosition(
position => {
resolve({
latitude: position.coords.latitude,
longitude: position.coords.longitude
});
},
error => {
console.error('Location error:', error);
resolve({
latitude: 30.0444,
longitude: 31.2357
});
}
);
} else {
resolve({
latitude: 30.0444,
longitude: 31.2357
});
}
});
}

async function fetchPrayerTimes() {
try {
document.getElementById('locationInfo').textContent = translations[currentLanguage].locationInfoLoading;
const location = await getUserLocation();
const timestamp = Math.floor(Date.now() / 1000);

const response = await fetch(
`https://api.aladhan.com/v1/timings/${timestamp}?latitude=${location.latitude}&longitude=${location.longitude}&method=5&adjustment=0`
);

if (!response.ok) {
throw new Error('Failed to fetch prayer times');
}

const data = await response.json();
prayerTimes = data.data;

updatePrayerTimesDisplay();
updateLocationInfo(prayerTimes.meta.timezone);
startNextPrayerCountdown();

// Schedule prayer notifications
schedulePrayerNotifications();

} catch (error) {
console.error('Error fetching prayer times:', error);
document.getElementById('locationInfo').textContent = translations[currentLanguage].locationInfoError;
document.getElementById('fajrTime').textContent = '--:--';
document.getElementById('sunriseTime').textContent = '--:--';
document.getElementById('dhuhrTime').textContent = '--:--';
document.getElementById('asrTime').textContent = '--:--';
document.getElementById('maghribTime').textContent = '--:--';
document.getElementById('ishaTime').textContent = '--:--';
if (nextPrayerInterval) {
clearInterval(nextPrayerInterval);
nextPrayerInterval = null;
}
document.getElementById('nextPrayerText').textContent = translations[currentLanguage].nextPrayerText;
document.getElementById('nextPrayerCountdown').textContent = '--:--:--';
prayerTimes = {};
}
}

function updatePrayerTimesDisplay() {
if (!prayerTimes || !prayerTimes.timings) {
return;
}
document.getElementById('fajrTime').textContent = formatTime(prayerTimes.timings.Fajr);
document.getElementById('sunriseTime').textContent = formatTime(prayerTimes.timings.Sunrise);
document.getElementById('dhuhrTime').textContent = formatTime(prayerTimes.timings.Dhuhr);
document.getElementById('asrTime').textContent = formatTime(prayerTimes.timings.Asr);
document.getElementById('maghribTime').textContent = formatTime(prayerTimes.timings.Maghrib);
document.getElementById('ishaTime').textContent = formatTime(prayerTimes.timings.Isha);
}

function formatTime(timeString) {
const [hours, minutes] = timeString.split(':');
const date = new Date();
date.setHours(parseInt(hours), parseInt(minutes), 0, 0);

const locale = currentLanguage === 'ar' ? 'ar-EG' : 'en-US';
const localTime = date.toLocaleTimeString(locale, {
hour: '2-digit',
minute: '2-digit',
hour12: true
});

return localTime;
}

function updateLocationInfo(timezone) {
document.getElementById('locationInfo').textContent = `${translations[currentLanguage].locationInfoTimezone} ${timezone}`;
}

function getNextPrayer() {
if (!prayerTimes || !prayerTimes.timings) {
return null;
}

const now = new Date();
const currentTimeInMinutes = now.getHours() * 60 + now.getMinutes();

const prayers = [
{ name: translations[currentLanguage].fajr, time: prayerTimes.timings.Fajr, elementId: 'fajrTime' },
{ name: translations[currentLanguage].sunrise, time: prayerTimes.timings.Sunrise, elementId: 'sunriseTime' },
{ name: translations[currentLanguage].dhuhr, time: prayerTimes.timings.Dhuhr, elementId: 'dhuhrTime' },
{ name: translations[currentLanguage].asr, time: prayerTimes.timings.Asr, elementId: 'asrTime' },
{ name: translations[currentLanguage].maghrib, time: prayerTimes.timings.Maghrib, elementId: 'maghribTime' },
{ name: translations[currentLanguage].isha, time: prayerTimes.timings.Isha, elementId: 'ishaTime' }
];

for (let prayer of prayers) {
const [hours, minutes] = prayer.time.split(':');
const prayerTimeInMinutes = parseInt(hours) * 60 + parseInt(minutes);

if (prayerTimeInMinutes > currentTimeInMinutes) {
return { ...prayer, timeInMinutes: prayerTimeInMinutes };
}
}

const [fajrHours, fajrMinutes] = prayers[0].time.split(':');
return {
...prayers[0],
timeInMinutes: parseInt(fajrHours) * 60 + parseInt(fajrMinutes) + 24 * 60
};
}

function startNextPrayerCountdown() {
if (!prayerTimes || !prayerTimes.timings) {
document.getElementById('nextPrayerText').textContent = translations[currentLanguage].noPrayerData;
document.getElementById('nextPrayerCountdown').textContent = '--:--:--';
return;
}

if (nextPrayerInterval) {
clearInterval(nextPrayerInterval);
}

nextPrayerInterval = setInterval(() => {
const nextPrayer = getNextPrayer();
if (!nextPrayer) {
document.getElementById('nextPrayerText').textContent = translations[currentLanguage].noPrayerData;
document.getElementById('nextPrayerCountdown').textContent = '--:--:--';
return;
}

const now = new Date();
const currentTimeInMinutes = now.getHours() * 60 + now.getMinutes();
const currentSeconds = now.getSeconds();

let timeDiffMinutes = nextPrayer.timeInMinutes - currentTimeInMinutes;

if (timeDiffMinutes <= 0) {
timeDiffMinutes += 24 * 60;
}

const totalSecondsRemaining = (timeDiffMinutes * 60) - currentSeconds;

const hours = Math.floor(totalSecondsRemaining / 3600);
const minutes = Math.floor((totalSecondsRemaining % 3600) / 60);
const seconds = totalSecondsRemaining % 60;

document.getElementById('nextPrayerText').textContent = `${translations[currentLanguage].nextPrayerText} ${nextPrayer.name}`;
document.getElementById('nextPrayerCountdown').textContent =
`${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

document.querySelectorAll('.prayer-time-item').forEach(item => {
item.classList.remove('next-prayer');
});

const nextPrayerElement = document.getElementById(nextPrayer.elementId);
if (nextPrayerElement) {
nextPrayerElement.closest('.prayer-time-item').classList.add('next-prayer');
}

if (totalSecondsRemaining <= 0) {
fetchPrayerTimes();
}

}, 1000);
}

// Notification functions
function requestNotificationPermission() {
if ('Notification' in window) {
Notification.requestPermission().then(permission => {
if (permission === 'granted') {
notificationPermissionGranted = true;
localStorage.setItem('notificationPermission', 'granted');
}
});
}
}

function enableNotifications() {
requestNotificationPermission();
dismissNotificationBanner();
}

function dismissNotificationBanner() {
document.getElementById('notificationBanner').style.display = 'none';
localStorage.setItem('notificationBannerDismissed', 'true');
}

function schedulePrayerNotifications() {
if (!notificationPermissionGranted || !prayerTimes || !prayerTimes.timings) {
return;
}

const prayers = [
{ name: translations[currentLanguage].fajr, time: prayerTimes.timings.Fajr },
{ name: translations[currentLanguage].dhuhr, time: prayerTimes.timings.Dhuhr },
{ name: translations[currentLanguage].asr, time: prayerTimes.timings.Asr },
{ name: translations[currentLanguage].maghrib, time: prayerTimes.timings.Maghrib },
{ name: translations[currentLanguage].isha, time: prayerTimes.timings.Isha }
];

const now = new Date();

prayers.forEach(prayer => {
const [hours, minutes] = prayer.time.split(':');
const prayerTime = new Date();
prayerTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);

// Schedule notification 10 minutes before prayer
const notificationTime = new Date(prayerTime.getTime() - 10 * 60 * 1000);

if (notificationTime > now) {
const timeUntilNotification = notificationTime.getTime() - now.getTime();

setTimeout(() => {
sendPrayerNotification(prayer.name);
}, timeUntilNotification);
}
});
}

function sendPrayerNotification(prayerName) {
if (notificationPermissionGranted && 'Notification' in window) {
new Notification('Ø­Ø§Ù† ÙˆÙ‚Øª Ø§Ù„ØµÙ„Ø§Ø©', {
body: `Ø¨Ø¹Ø¯ 10 Ø¯Ù‚Ø§Ø¦Ù‚ ÙŠØ­ÙŠÙ† ÙˆÙ‚Øª ØµÙ„Ø§Ø© ${prayerName}`,
icon: 'https://7nen.do.am/_ph/6/676236720.jpg',
badge: 'https://7nen.do.am/_ph/6/676236720.jpg'
});
}
}

// Report broken link
function reportBrokenLink() {
const phoneNumber = '+201092116092';
const message = translations[currentLanguage].whatsappMessage;
const whatsappUrl = `https://wa.me/${phoneNumber.replace('+', '')}?text=${encodeURIComponent(message)}`;

window.open(whatsappUrl, '_blank');

return false;
}

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
if (e.code === 'Space') {
e.preventDefault();
if (globalPlayer.src && !globalPlayer.paused) {
stopRadio();
} else if (currentStationIndex >= 0) {
const currentStation = allStations[currentStationIndex];
if (currentStation.type === 'azkar' || currentStation.type === 'ruqyah' || currentStation.type === 'quran_sura_list' || currentStation.type === 'mushaf_mualim') {
return;
}
const cards = document.querySelectorAll('.card');
const targetCard = Array.from(cards).find(card =>
card.querySelector('h2').textContent === currentStation.name[currentLanguage]
);
if (targetCard) {
const playButton = targetCard.querySelector('button:not(.stop-btn)');
if(playButton) playButton.click();
}
}
} else if (e.code === 'ArrowLeft') {
previousStation();
} else if (e.code === 'ArrowRight') {
nextStation();
}
});

// Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù‡Ø¬Ø±ÙŠ Ø§Ù„Ù…Ø­Ø¯Ø«Ø©
function updateHijriDate() {
// Ø§Ø³ØªØ®Ø¯Ø§Ù… Intl.DateTimeFormat Ù…Ø¹ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ Ø§Ù„ØµØ­ÙŠØ­
const today = new Date();
const hijriDate = new Intl.DateTimeFormat('ar-SA-u-ca-islamic', {
weekday: 'long',
year: 'numeric',
month: 'long',
day: 'numeric'
}).format(today);

document.getElementById('hijriDate').textContent = hijriDate;
}

// Filter stations function
function filterStations() {
const searchTerm = searchInput.value.toLowerCase();
const cards = document.querySelectorAll('.card');

cards.forEach(card => {
const stationName = card.querySelector('h2').textContent.toLowerCase();
if (stationName.includes(searchTerm)) {
card.classList.remove('hidden');
} else {
card.classList.add('hidden');
}
});
}

// Toggle favorite function
function toggleFavorite(nameAr, nameEn, img, url) {
const favoriteIndex = favorites.findIndex(fav => fav.name === nameAr || fav.name === nameEn);

if (favoriteIndex === -1) {
// Add to favorites
favorites.push({
name: currentLanguage === 'ar' ? nameAr : nameEn,
nameAr: nameAr,
nameEn: nameEn,
img: img,
url: url
});
} else {
// Remove from favorites
favorites.splice(favoriteIndex, 1);
}

// Save to localStorage
localStorage.setItem('radioFavorites', JSON.stringify(favorites));

// Update UI
initializeStations();
updateFavoritesSection();
}

// Update favorites section
function updateFavoritesSection() {
if (favorites.length === 0) {
favoritesSection.classList.remove('active');
return;
}

favoritesSection.classList.add('active');
favoritesContainer.innerHTML = '';

favorites.forEach(favorite => {
const card = document.createElement('div');
card.className = 'card';

card.innerHTML = `
<button class="favorite-btn active" onclick="toggleFavorite('${favorite.nameAr}', '${favorite.nameEn}', '${favorite.img}', '${favorite.url}')">â™¡</button>
<img src="${favorite.img}" alt="${favorite.name}" loading="lazy" class="lazy-image" />
<h2>${favorite.name}</h2>
<button onclick="playRadio('${favorite.url}', '${favorite.name}', this)">${translations[currentLanguage].playButton}</button>
<button class="stop-btn" onclick="stopRadio()">${translations[currentLanguage].stopButton}</button>
<div class="progress-bar"></div>
`;

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ± Ø¨Ø´ÙƒÙ„ ÙƒØ³ÙˆÙ„
const img = card.querySelector('img');
if (img) {
img.addEventListener('load', function() {
this.classList.add('loaded');
});
}

favoritesContainer.appendChild(card);
});
}

// Clear favorites function
function clearFavorites() {
if (confirm(currentLanguage === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙØ¶Ù„Ø§ØªØŸ' : 'Are you sure you want to clear all favorites?')) {
favorites = [];
localStorage.setItem('radioFavorites', JSON.stringify(favorites));
updateFavoritesSection();
initializeStations();
}
}

// Volume control
volumeSlider.addEventListener('input', function() {
if (globalPlayer.src) {
globalPlayer.volume = this.value / 100;
}
});

// Initialize app
document.addEventListener('DOMContentLoaded', () => {
// Check notification permission
if ('Notification' in window) {
const savedPermission = localStorage.getItem('notificationPermission');
if (savedPermission === 'granted') {
notificationPermissionGranted = true;
} else if (Notification.permission === 'default' && !localStorage.getItem('notificationBannerDismissed')) {
document.getElementById('notificationBanner').style.display = 'flex';
}
}

setLanguage('ar');
initializeStations();
updatePlaylistButtons();
fetchPrayerTimes();

// ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù‡Ø¬Ø±ÙŠ
updateHijriDate();

// ØªØ­Ø¯ÙŠØ« ÙŠÙˆÙ…ÙŠ (Ø¹Ù†Ø¯ Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„)
setInterval(() => {
const now = new Date();
if (now.getHours() === 0 && now.getMinutes() === 0) {
updateHijriDate();
}
}, 60000); // ØªØ­Ù‚Ù‚ ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
});
</script>
<script data-goatcounter="https://waleedd.goatcounter.com/count"
async src="//gc.zgo.at/count.js"></script>
</body>
</html>
