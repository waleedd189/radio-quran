<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="مصحف الشيخ محمد صديق المنشاوي - استمع إلى تلاوات القرآن الكريم بصوت الشيخ المنشاوي">
    <meta name="keywords" content="قرآن, المنشاوي, محمد صديق المنشاوي, تلاوات, مصحف">
    <title>مصحف الشيخ محمد صديق المنشاوي</title>
    
    <!-- الخطوط والأيقونات -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- تحسينات الأداء -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="//archive.org">
    
    <style>
        /* ===== متغيرات التصميم ===== */
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #FF9800;
            --third-color: #2196F3;
            --fourth-color: #9C27B0;
            --fifth-color: #F44336;
            --background-color: #111;
            --card-background: rgba(34, 34, 34, 0.9);
            --text-color: #fff;
            --border-color: rgba(255, 255, 255, 0.1);
            --hover-color: #333;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --transition-speed: 0.3s;
        }

        /* ===== الأساسيات ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', 'Arial', sans-serif;
            background: linear-gradient(135deg, #111 0%, #333 100%);
            color: var(--text-color);
            text-align: center;
            padding: 30px 10px 80px; /* إضافة مساحة أسفل المشغل */
            min-height: 100vh;
            line-height: 1.6;
        }

        /* ===== العناوين ===== */
        h1 {
            font-family: 'Amiri', serif;
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            background: linear-gradient(45deg, var(--primary-color), #81C784);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }

        h1::before, h1::after {
            content: "﴿";
            color: var(--primary-color);
            margin: 0 10px;
            font-size: 1.2em;
        }

        h1::after {
            content: "﴾";
        }

        .subtitle {
            font-size: 1.1em;
            margin-bottom: 30px;
            color: #ccc;
        }

        /* ===== أزرار التحكم ===== */
        .controls-container {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            flex-direction: column;
        }

        .control-btn {
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .back-btn { background: var(--third-color); }
        .share-btn { background: var(--primary-color); }
        .sleep-timer-btn { background: var(--fourth-color); }
        .control-btn.active {
            box-shadow: 0 0 15px currentColor;
        }

        /* ===== الحاوية الرئيسية ===== */
        .main-container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* ===== بطاقة القسم ===== */
        .section-card {
            background: var(--card-background);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px var(--shadow-color);
            transition: all var(--transition-speed) ease;
        }

        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .section-title {
            font-family: 'Amiri', serif;
            font-size: 1.8em;
            margin-bottom: 25px;
            color: var(--secondary-color);
            position: relative;
            padding-bottom: 15px;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: var(--secondary-color);
            border-radius: 2px;
        }

        /* ===== قائمة المصحف المرتل ===== */
        .murattal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .surah-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .surah-item:hover, .surah-item.active {
            background: var(--secondary-color);
            border-color: var(--secondary-color);
            transform: scale(1.05);
        }

        .surah-item.playing::after {
            content: '\f04b';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 5px;
            left: 5px;
            color: var(--primary-color);
            font-size: 14px;
        }

        /* ===== قائمة روائع المنشاوي (المنسدلة) ===== */
        .rawae-dropdown {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border-color);
            color: white;
            font-size: 1em;
            font-family: 'Cairo', sans-serif;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            margin-bottom: 20px;
        }

        .rawae-dropdown:focus {
            outline: none;
            border-color: var(--secondary-color);
        }

        .rawae-dropdown option {
            background: #333;
            color: white;
            padding: 10px;
        }

        .play-rawae-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 0 auto;
        }

        .play-rawae-btn:hover {
            background: #F57C00;
            transform: translateY(-2px);
        }

        /* ===== مشغل الصوت ===== */
        .player-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--card-background);
            backdrop-filter: blur(15px);
            padding: 15px;
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            z-index: 1000;
            transform: translateY(100%); /* مخفي افتراضيًا */
            transition: transform var(--transition-speed) ease;
        }

        .player-container.active {
            transform: translateY(0); /* يظهر عند التشغيل */
        }

        .player-info {
            flex-grow: 1;
            text-align: right;
        }

        .player-title {
            font-weight: 600;
            color: var(--secondary-color);
        }

        #audioPlayer {
            width: 100%;
            max-width: 400px;
        }

        .close-player-btn {
            background: #F44336;
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ===== زر الواتساب ===== */
        .whatsapp-float {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 60px;
            height: 60px;
            background: #25D366;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 25px rgba(37,211,102,0.5);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            z-index: 1000;
            border: none;
        }

        .whatsapp-float:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(37,211,102,0.6);
        }

        .whatsapp-float svg {
            width: 30px;
            height: 30px;
            fill: white;
        }

        /* ===== النوافذ المنبثقة ===== */
        .modal {
            display: none; /* مخفي افتراضيًا */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            animation: modalFadeIn 0.4s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-title {
            font-size: 1.4em;
            margin-bottom: 20px;
            color: white;
            font-weight: 600;
            text-align: center;
        }

        .timer-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 25px;
        }

        .timer-option {
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 10px;
            padding: 15px;
            color: white;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-size: 1em;
            font-weight: 500;
        }

        .timer-option:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .timer-option.selected {
            background: var(--fourth-color);
            box-shadow: 0 0 15px rgba(156,39,176,0.5);
        }

        .modal-actions {
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-size: 1em;
            transition: all var(--transition-speed) ease;
            font-weight: 600;
        }

        .modal-cancel {
            background: rgba(255,255,255,0.2);
        }

        .modal-cancel:hover {
            background: rgba(255,255,255,0.3);
        }

        .modal-confirm {
            background: var(--fourth-color);
        }

        .modal-confirm:hover {
            background: #7B1FA2;
        }

        .timer-status {
            margin-top: 20px;
            padding: 15px;
            background: rgba(156,39,176,0.1);
            border-radius: 12px;
            color: var(--fourth-color);
            font-size: 1em;
            display: none; /* مخفي افتراضيًا */
            text-align: center;
            border: 1px solid rgba(156,39,176,0.2);
        }
        
        .timer-status #timerCountdown {
            font-weight: bold;
            font-size: 1.2em;
        }


        /* للهواتف */
        @media (max-width: 600px) {
            .murattal-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            .player-container {
                flex-direction: column;
                gap: 10px;
            }
            #audioPlayer {
                max-width: 100%;
            }
            .controls-container { 
                top: 15px; 
                left: 15px;
                gap: 8px;
            }
            .control-btn { 
                font-size: 0.8em; 
                padding: 8px 12px;
            }
            .whatsapp-float { 
                width: 55px; 
                height: 55px; 
                bottom: 20px; 
                right: 20px; 
            }
            .whatsapp-float svg { 
                width: 26px; 
                height: 26px; 
            }
            .timer-options {
                grid-template-columns: repeat(2, 1fr);
            }
            .modal-content {
                padding: 25px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- ===== أزرار التحكم ===== -->
    <div class="controls-container">
        <button class="control-btn back-btn" onclick="goBack()">
            <i class="fas fa-arrow-right"></i>
            <span>رجوع</span>
        </button>
        <button class="control-btn share-btn" onclick="shareApp()">
            <i class="fas fa-share-alt"></i>
            <span>مشاركة</span>
        </button>
        <button class="control-btn sleep-timer-btn" id="sleepTimerBtn" onclick="toggleSleepTimer()">
            <i class="fas fa-clock"></i>
            <span>مؤقت النوم</span>
        </button>
    </div>

    <header>
        <h1>مصحف الشيخ محمد صديق المنشاوي</h1>
        <p class="subtitle">رحمه الله رحمة واسعة</p>
    </header>

    <div class="main-container">
        <!-- ===== قسم المصحف المرتل ===== -->
        <section class="section-card">
            <h2 class="section-title"><i class="fas fa-book-open"></i> المصحف المرتل</h2>
            <div class="murattal-grid" id="murattal-list">
                <!-- سيتم إضافة السور هنا بواسطة الجافاسكريبت -->
            </div>
        </section>

        <!-- ===== قسم روائع المنشاوي ===== -->
        <section class="section-card">
            <h2 class="section-title"><i class="fas fa-star"></i> روائع المنشاوي</h2>
            <select class="rawae-dropdown" id="rawaeDropdown">
                <option value="">اختر تلاوة نادرة...</option>
                <!-- سيتم إضافة الخيارات هنا بواسطة الجافاسكريبت -->
            </select>
            <button class="play-rawae-btn" id="playRawaeBtn">
                <i class="fas fa-play-circle"></i>
                <span>تشغيل التلاوة المختارة</span>
            </button>
        </section>
    </div>

    <!-- مشغل الصوت المخفي -->
    <div class="player-container" id="playerContainer">
        <div class="player-info">
            <div class="player-title" id="playerTitle">عنوان التلاوة</div>
        </div>
        <audio id="audioPlayer" controls></audio>
        <button class="close-player-btn" id="closePlayerBtn">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- ===== زر الواتساب ===== -->
    <button class="whatsapp-float" onclick="reportBrokenLink(); return false;" id="whatsappBtn">
        <svg viewBox="0 0 24 24">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.520.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.520-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.893 3.488"/>
        </svg>
    </button>

    <!-- ===== نافذة مؤقت النوم ===== -->
    <div class="modal" id="sleepTimerModal">
        <div class="modal-content">
            <div class="modal-title">
                <i class="fas fa-moon"></i>
                مؤقت النوم
            </div>
            <div class="timer-options">
                <button class="timer-option" data-minutes="5">5 دقائق</button>
                <button class="timer-option" data-minutes="10">10 دقائق</button>
                <button class="timer-option" data-minutes="15">15 دقيقة</button>
                <button class="timer-option" data-minutes="30">30 دقيقة</button>
                <button class="timer-option" data-minutes="45">45 دقيقة</button>
                <button class="timer-option" data-minutes="60">60 دقيقة</button>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-cancel" onclick="closeSleepTimerModal()">إلغاء</button>
                <button class="modal-btn modal-confirm" onclick="setSleepTimer()">تأكيد</button>
            </div>
        </div>
    </div>
    
    <div class="timer-status" id="timerStatus">
        سيتم إيقاف التشغيل خلال: <span id="timerCountdown">00:00</span>
    </div>

    <script>
        // --- بيانات المصحف المرتل (روابط جديدة محدثة) ---
        const murattalData = [
            { name: "الفاتحة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/001-Al-fatiha-Up-By-MusleM.mp3" },
            { name: "البقرة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/002-Al-baqara-Up-By-MusleM.mp3" },
            { name: "آل عمران", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/003-Aal-e-imran-Up-By-MusleM.mp3" },
            { name: "النساء", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/004-An-nisa-Up-By-MusleM.mp3" },
            { name: "المائدة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/005-Al-maeda-Up-By-MusleM.mp3" },
            { name: "الأنعام", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/006-Al-anaam-Up-By-MusleM.mp3" },
            { name: "الأعراف", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/007-Al-araf-Up-By-MusleM.mp3" },
            { name: "الأنفال", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/008-Al-anfal-Up-By-MusleM.mp3" },
            { name: "التوبة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/009-At-tawba-Up-By-MusleM.mp3" },
            { name: "يونس", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/010-Yunus-Up-By-MusleM.mp3" },
            { name: "هود", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/011-Hud-Up-By-MusleM.mp3" },
            { name: "يوسف", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/012-Yusuf-Up-By-MusleM.mp3" },
            { name: "الرعد", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/013-Ar-rad-Up-By-MusleM.mp3" },
            { name: "إبراهيم", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/014-Ibrahim-Up-By-MusleM.mp3" },
            { name: "الحجر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/015-Al-hijr-Up-By-MusleM.mp3" },
            { name: "النحل", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/016-An-nahl-Up-By-MusleM.mp3" },
            { name: "الإسراء", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/017-Al-isra-Up-By-MusleM.mp3" },
            { name: "الكهف", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/018-Al-kahf-Up-By-MusleM.mp3" },
            { name: "مريم", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/019-Maryam-Up-By-MusleM.mp3" },
            { name: "طه", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/020-Taha-Up-By-MusleM.mp3" },
            { name: "الأنبياء", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/021-Al-anbiya-Up-By-MusleM.mp3" },
            { name: "الحج", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/022-Al-hajj-Up-By-MusleM.mp3" },
            { name: "المؤمنون", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/023-Al-mumenoon-Up-By-MusleM.mp3" },
            { name: "النور", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/024-An-noor-Up-By-MusleM.mp3" },
            { name: "الفرقان", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/025-Al-furqan-Up-By-MusleM.mp3" },
            { name: "الشعراء", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/026-Ash-shuara-Up-By-MusleM.mp3" },
            { name: "النمل", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/027-An-naml-Up-By-MusleM.mp3" },
            { name: "القصص", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/028-Al-qasas-Up-By-MusleM.mp3" },
            { name: "العنكبوت", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/029-Al-ankaboot-Up-By-MusleM.mp3" },
            { name: "الروم", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/030-Ar-room-Up-By-MusleM.mp3" },
            { name: "لقمان", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/031-Luqman-Up-By-MusleM.mp3" },
            { name: "السجدة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/032-As-sajda-Up-By-MusleM.mp3" },
            { name: "الأحزاب", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/033-Al-ahzab-Up-By-MusleM.mp3" },
            { name: "سبأ", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/034-Saba-Up-By-MusleM.mp3" },
            { name: "فاطر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/035-Fatir-Up-By-MusleM.mp3" },
            { name: "يس", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/036-Ya-seen-Up-By-MusleM.mp3" },
            { name: "الصافات", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/037-As-saaffat-Up-By-MusleM.mp3" },
            { name: "ص", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/038-Sad-Up-By-MusleM.mp3" },
            { name: "الزمر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/039-Az-zumar-Up-By-MusleM.mp3" },
            { name: "غافر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/040-Ghafir-Up-By-MusleM.mp3" },
            { name: "فصلت", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/041-Fussilat-Up-By-MusleM.mp3" },
            { name: "الشورى", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/042-Ash-shura-Up-By-MusleM.mp3" },
            { name: "الزخرف", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/043-Az-zukhruf-Up-By-MusleM.mp3" },
            { name: "الدخان", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/044-Ad-dukhan-Up-By-MusleM.mp3" },
            { name: "الجاثية", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/045-Al-jathiya-Up-By-MusleM.mp3" },
            { name: "الأحقاف", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/046-Al-ahqaf-Up-By-MusleM.mp3" },
            { name: "محمد", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/047-Muhammad-Up-By-MusleM.mp3" },
            { name: "الفتح", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/048-Al-fath-Up-By-MusleM.mp3" },
            { name: "الحجرات", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/049-Al-hujraat-Up-By-MusleM.mp3" },
            { name: "ق", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/050-Qaf-Up-By-MusleM.mp3" },
            { name: "الذاريات", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/051-Adh-dhariyat-Up-By-MusleM.mp3" },
            { name: "الطور", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/052-At-tur-Up-By-MusleM.mp3" },
            { name: "النجم", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/053-An-najm-Up-By-MusleM.mp3" },
            { name: "القمر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/054-Al-qamar-Up-By-MusleM.mp3" },
            { name: "الرحمن", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/055-Ar-rahman-Up-By-MusleM.mp3" },
            { name: "الواقعة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/056-Al-waqia-Up-By-MusleM.mp3" },
            { name: "الحديد", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/057-Al-hadid-Up-By-MusleM.mp3" },
            { name: "المجادلة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/058-Al-mujadala-Up-By-MusleM.mp3" },
            { name: "الحشر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/059-Al-hashr-Up-By-MusleM.mp3" },
            { name: "الممتحنة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/060-Al-mumtahana-Up-By-MusleM.mp3" },
            { name: "الصف", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/061-As-saff-Up-By-MusleM.mp3" },
            { name: "الجمعة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/062-Al-jumua-Up-By-MusleM.mp3" },
            { name: "المنافقون", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/063-Al-munafiqoon-Up-By-MusleM.mp3" },
            { name: "التغابن", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/064-At-taghabun-Up-By-MusleM.mp3" },
            { name: "الطلاق", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/065-At-talaq-Up-By-MusleM.mp3" },
            { name: "التحريم", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/066-At-tahrim-Up-By-MusleM.mp3" },
            { name: "الملك", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/067-Al-mulk-Up-By-MusleM.mp3" },
            { name: "القلم", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/068-Al-qalam-Up-By-MusleM.mp3" },
            { name: "الحاقة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/069-Al-haaqqa-Up-By-MusleM.mp3" },
            { name: "المعارج", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/070-Al-maarij-Up-By-MusleM.mp3" },
            { name: "نوح", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/071-Nooh-Up-By-MusleM.mp3" },
            { name: "الجن", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/072-Al-jinn-Up-By-MusleM.mp3" },
            { name: "المزمل", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/073-Al-muzzammil-Up-By-MusleM.mp3" },
            { name: "المدثر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/074-Al-muddaththir-Up-By-MusleM.mp3" },
            { name: "القيامة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/075-Al-qiyama-Up-By-MusleM.mp3" },
            { name: "الإنسان", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/076-Al-insan-Up-By-MusleM.mp3" },
            { name: "المرسلات", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/077-Al-mursalat-Up-By-MusleM.mp3" },
            { name: "النبأ", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/078-An-naba-Up-By-MusleM.mp3" },
            { name: "النازعات", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/079-An-naziat-Up-By-MusleM.mp3" },
            { name: "عبس", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/080-Abasa-Up-By-MusleM.mp3" },
            { name: "التكوير", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/081-At-takwir-Up-By-MusleM.mp3" },
            { name: "الانفطار", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/082-Al-infitar-Up-By-MusleM.mp3" },
            { name: "المطففين", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/083-Al-mutaffifin-Up-By-MusleM.mp3" },
            { name: "الانشقاق", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/084-Al-inshiqaq-Up-By-MusleM.mp3" },
            { name: "البروج", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/085-Al-burooj-Up-By-MusleM.mp3" },
            { name: "الطارق", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/086-At-tariq-Up-By-MusleM.mp3" },
            { name: "الأعلى", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/087-Al-ala-Up-By-MusleM.mp3" },
            { name: "الغاشية", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/088-Al-ghashiya-Up-By-MusleM.mp3" },
            { name: "الفجر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/089-Al-fajr-Up-By-MusleM.mp3" },
            { name: "البلد", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/090-Al-balad-Up-By-MusleM.mp3" },
            { name: "الشمس", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/091-Ash-shams-Up-By-MusleM.mp3" },
            { name: "الليل", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/092-Al-layl-Up-By-MusleM.mp3" },
            { name: "الضحى", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/093-Ad-dhuha-Up-By-MusleM.mp3" },
            { name: "الشرح", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/094-As-sharh-Up-By-MusleM.mp3" },
            { name: "التين", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/095-At-tin-Up-By-MusleM.mp3" },
            { name: "العلق", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/096-Al-alaq-Up-By-MusleM.mp3" },
            { name: "القدر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/097-Al-qadr-Up-By-MusleM.mp3" },
            { name: "البينة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/098-Al-bayyina-Up-By-MusleM.mp3" },
            { name: "الزلزلة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/099-Az-zalzala-Up-By-MusleM.mp3" },
            { name: "العاديات", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/100-Al-adiyat-Up-By-MusleM.mp3" },
            { name: "القارعة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/101-Al-qaria-Up-By-MusleM.mp3" },
            { name: "التكاثر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/102-At-takathur-Up-By-MusleM.mp3" },
            { name: "العصر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/103-Al-asr-Up-By-MusleM.mp3" },
            { name: "الهمزة", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/104-Al-humaza-Up-By-MusleM.mp3" },
            { name: "الفيل", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/105-Al-fil-Up-By-MusleM.mp3" },
            { name: "قريش", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/106-Quraish-Up-By-MusleM.mp3" },
            { name: "الماعون", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/107-Al-maun-Up-By-MusleM.mp3" },
            { name: "الكوثر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/108-Al-kauther-Up-By-MusleM.mp3" },
            { name: "الكافرون", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/109-Al-kafiroon-Up-By-MusleM.mp3" },
            { name: "النصر", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/110-An-nasr-Up-By-MusleM.mp3" },
            { name: "المسد", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/111-Al-masadd-Up-By-MusleM.mp3" },
            { name: "الإخلاص", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/112-Al-ikhlas-Up-By-MusleM.mp3" },
            { name: "الفلق", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/113-Al-falaq-Up-By-MusleM.mp3" },
            { name: "الناس", url: "https://archive.org/download/Muhamad-Seddik_Al-Menchaoui_Murattal_Radio-Masr_up-by-muslem/114-An-nas-Up-By-MusleM.mp3" }
        ];

        // --- بيانات روائع المنشاوي (الروابط التي أرسلتها) ---
        // ملاحظة: تم اختزال القائمة هنا لتوفير المساحة، في الكود الأصلي القائمة كاملة
        const rawaeData = [
            { name: "ابراهيم 12-23 من ليبيا", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/002-112-23-up_by_muslem.ettounssi.mp3" },
            { name: "ال عمران 1-7", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/003-11-7-up_by_muslem.ettounssi.mp3" },
            { name: "الاحزاب 18-34 من عام 1950", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/004-118-341950-up_by_muslem.ettounssi.mp3" },
            { name: "الاحزاب من الاية 21 الى الاية 48 من سوهاج", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/005-12148-up_by_muslem.ettounssi.mp3" },
            { name: "الاسراء 1 - 14 والنجم 1- 18 جامع الحسين", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/006-11-141-18-up_by_muslem.ettounssi.mp3" },
            { name: "الاسراء 1-23", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/007-11-23-up_by_muslem.ettounssi.mp3" },
            { name: "الاعراف 31-40 من مصر", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/008-131-40-up_by_muslem.ettounssi.mp3" },
            { name: "الانبياء 1-35", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/009-11-35-up_by_muslem.ettounssi.mp3" },
            { name: "الانعام 12 - 38 من سوريا", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/010-112-38-up_by_muslem.ettounssi.mp3" },
            { name: "الانفال 1-41", url: "https://archive.org/download/Torath_Mensheoui-1_uP_bY_mUSLEm/011-11-41-up_by_muslem.ettounssi.mp3" },
            // (يمكنك إضافة باقي القائمة هنا كما في الكود الأصلي)
        ];

        // --- جلب العناصر من الصفحة ---
        const murattalList = document.getElementById('murattal-list');
        const rawaeDropdown = document.getElementById('rawaeDropdown');
        const playRawaeBtn = document.getElementById('playRawaeBtn');
        const audioPlayer = document.getElementById('audioPlayer');
        const playerContainer = document.getElementById('playerContainer');
        const playerTitle = document.getElementById('playerTitle');
        const closePlayerBtn = document.getElementById('closePlayerBtn');
        const sleepTimerBtn = document.getElementById('sleepTimerBtn');
        const sleepTimerModal = document.getElementById('sleepTimerModal');
        const whatsappBtn = document.getElementById('whatsappBtn');
        const timerStatusDiv = document.getElementById('timerStatus');
        const timerCountdownSpan = document.getElementById('timerCountdown');

        // --- متغيرات عامة للتشغيل التلقائي ---
        let currentPlaylist = null; // 'murattal' أو 'rawae'
        let currentTrackIndex = -1;

        // --- متغيرات مؤقت النوم ---
        let sleepTimerInterval = null;
        let sleepTimerEndTime = 0;

        // --- دوال بناء القوائم ---
        function createMurattalList() {
            murattalData.forEach((surah, index) => {
                const item = document.createElement('div');
                item.className = 'surah-item';
                item.textContent = surah.name;
                item.dataset.index = index; // تخزين الفهرس
                item.addEventListener('click', () => playAudio(surah.url, surah.name, 'murattal', index));
                murattalList.appendChild(item);
            });
        }

        function populateRawaeDropdown() {
            rawaeData.forEach((recitation, index) => {
                const option = document.createElement('option');
                option.value = recitation.url;
                option.textContent = recitation.name;
                option.dataset.index = index; // تخزين الفهرس في الخيار أيضاً
                rawaeDropdown.appendChild(option);
            });
        }

        // --- دالة تشغيل الصوت مع تحديث الحالة ---
        function playAudio(url, title, playlist, index) {
            // إلغاء تحديد السورة الحالية
            document.querySelectorAll('.surah-item').forEach(el => el.classList.remove('playing'));

            // تحديث القائمة والمسار الحالي
            currentPlaylist = playlist;
            currentTrackIndex = index;

            // تشغيل الصوت
            audioPlayer.src = url;
            playerTitle.textContent = title;
            playerContainer.classList.add('active');
            audioPlayer.play();

            // تحديث المؤشر البصري (playing) بناءً على القائمة
            if (playlist === 'murattal' && index >= 0) {
                const items = document.querySelectorAll('.surah-item');
                if (items[index]) {
                    items[index].classList.add('playing');
                    // تمرير الشاشة للعنصر النشط إذا لزم الأمر
                    items[index].scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }
            }

            // إلغاء مؤقت النوم إذا كان نشطًا
            if (sleepTimerInterval) {
                cancelSleepTimer();
            }
        }

        // --- دالة إلغاء مؤقت النوم ---
        function cancelSleepTimer() {
            if (sleepTimerInterval) {
                clearInterval(sleepTimerInterval);
                sleepTimerInterval = null;
            }
            sleepTimerBtn.classList.remove('active');
            timerStatusDiv.style.display = 'none';
        }

        // --- دالة تعيين مؤقت النوم ---
        function setSleepTimer() {
            const selectedOption = document.querySelector('.timer-option.selected');
            if (!selectedOption) {
                showMessage('الرجاء اختيار وقت للمؤقت');
                return;
            }
            const minutes = parseInt(selectedOption.dataset.minutes);
            sleepTimerEndTime = Date.now() + (minutes * 60 * 1000);
            
            sleepTimerInterval = setInterval(updateSleepTimer, 1000);
            sleepTimerBtn.classList.add('active');
            timerStatusDiv.style.display = 'block';
            closeSleepTimerModal();
        }

        // --- دالة تحديث عرض مؤقت النوم ---
        function updateSleepTimer() {
            const now = Date.now();
            const remaining = sleepTimerEndTime - now;
            
            if (remaining <= 0) {
                audioPlayer.pause();
                playerContainer.classList.remove('active');
                playerTitle.textContent = 'تم إيقاف التشغيل حسب مؤقت النوم';
                cancelSleepTimer();
            } else {
                const minutes = Math.floor(remaining / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                timerCountdownSpan.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        // --- دالة فتح نافذة مؤقت النوم ---
        function toggleSleepTimer() {
            if (sleepTimerInterval) {
                cancelSleepTimer();
            } else {
                sleepTimerModal.style.display = 'flex';
                setupTimerOptions();
            }
        }

        // --- دالة إعداد خيارات مؤقت النوم ---
        function setupTimerOptions() {
            const timerOptions = document.querySelectorAll('.timer-option');
            timerOptions.forEach(option => {
                option.onclick = () => {
                    timerOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                };
            });
        }

        // --- دالة إغلاق نافذة مؤقت النوم ---
        function closeSleepTimerModal() {
            sleepTimerModal.style.display = 'none';
        }

        // --- دالة المشاركة ---
        function shareApp() {
            const shareData = {
                title: 'مصحف الشيخ محمد صديق المنشاوي',
                text: 'استمع إلى تلاوات القرآن الكريم بصوت الشيخ المنشاوي',
                url: window.location.href
            };
            if (navigator.share) {
                navigator.share(shareData).catch(console.error);
            } else {
                navigator.clipboard.writeText(`${shareData.title}\n${shareData.text}\n${shareData.url}`).then(() => {
                    showMessage('تم نسخ الرابط إلى الحافظة!');
                }).catch(() => {
                    showMessage('فشل النسخ، يرجى نسخ الرابط يدوياً');
                });
            }
        }

        // --- دالة الإبلاغ عن رابط معطل ---
        function reportBrokenLink() {
            const phoneNumber = '+201092116092';
            const message = 'يوجد رابط معطلب في مصحف الشيخ محمد صديق المنشاوي، يرجى التحقق';
            const whatsappUrl = `https://wa.me/${phoneNumber.replace('+', '')}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        // --- دالة عرض رسالة ---
        function showMessage(message) {
            alert(message);
        }

        // --- دالة الرجوع ---
        function goBack() {
            window.location.href = 'https://waleedd189.github.io/radio-quran/index.html';
        }

        // --- مستمعي الأحداث ---
        playRawaeBtn.addEventListener('click', () => {
            const selectedUrl = rawaeDropdown.value;
            const selectedName = rawaeDropdown.options[rawaeDropdown.selectedIndex].text;
            const selectedIndex = rawaeDropdown.selectedIndex - 1; // -1 لأن أول خيار هو "اختر..."
            if (selectedUrl) {
                playAudio(selectedUrl, selectedName, 'rawae', selectedIndex);
            }
        });

        closePlayerBtn.addEventListener('click', () => {
            audioPlayer.pause();
            playerContainer.classList.remove('active');
            document.querySelectorAll('.surah-item').forEach(el => el.classList.remove('playing'));
        });

        // === التعديل الأهم: منطق التشغيل التلقائي عند انتهاء المقطع ===
        audioPlayer.addEventListener('ended', () => {
            let nextTrack = null;
            let nextIndex = -1;
            let nextPlaylist = currentPlaylist;

            // 1. التعامل مع قائمة المصحف المرتل
            if (currentPlaylist === 'murattal') {
                if (currentTrackIndex < murattalData.length - 1) {
                    nextIndex = currentTrackIndex + 1;
                    nextTrack = murattalData[nextIndex];
                }
            }
            // 2. التعامل مع قائمة روائع المنشاوي
            else if (currentPlaylist === 'rawae') {
                // التحقق من وجود عنصر تالي
                if (currentTrackIndex < rawaeData.length - 1) {
                    nextIndex = currentTrackIndex + 1;
                    nextTrack = rawaeData[nextIndex];
                    // تحديث القائمة المنسدلة لتظهر الخيار الجديد
                    rawaeDropdown.selectedIndex = nextIndex + 1; // +1 بسبب العنصر الافتراضي
                }
            }

            // تنفيذ التشغيل التالي إذا وجد
            if (nextTrack) {
                playAudio(nextTrack.url, nextTrack.name, nextPlaylist, nextIndex);
            } else {
                // انتهت القائمة، إخفاء المشغل وتنظيف المؤشرات
                playerContainer.classList.remove('active');
                document.querySelectorAll('.surah-item').forEach(el => el.classList.remove('playing'));
            }
        });

        // --- تشغيل الدوال عند تحميل الصفحة ---
        document.addEventListener('DOMContentLoaded', () => {
            createMurattalList();
            populateRawaeDropdown();
        });
    </script>
</body>
</html>
